<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>DSARAY - DSA1101: Everything You Need</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">DSARAY</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./index.html" aria-current="page"> 
<span class="menu-text">Home</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul class="collapse">
  <li><a href="#getting-started" id="toc-getting-started" class="nav-link active" data-scroll-target="#getting-started">Getting Started</a>
  <ul class="collapse">
  <li><a href="#working-directory" id="toc-working-directory" class="nav-link" data-scroll-target="#working-directory">Working Directory</a></li>
  <li><a href="#reading-file" id="toc-reading-file" class="nav-link" data-scroll-target="#reading-file">Reading File</a></li>
  <li><a href="#common-plots" id="toc-common-plots" class="nav-link" data-scroll-target="#common-plots">Common Plots</a></li>
  <li><a href="#uselful-functions" id="toc-uselful-functions" class="nav-link" data-scroll-target="#uselful-functions">Uselful Functions</a></li>
  </ul></li>
  <li><a href="#interpreting-graphical-data" id="toc-interpreting-graphical-data" class="nav-link" data-scroll-target="#interpreting-graphical-data">Interpreting Graphical Data</a>
  <ul class="collapse">
  <li><a href="#interpreting-scatterplots" id="toc-interpreting-scatterplots" class="nav-link" data-scroll-target="#interpreting-scatterplots">Interpreting Scatterplots</a></li>
  <li><a href="#interpreting-histograms" id="toc-interpreting-histograms" class="nav-link" data-scroll-target="#interpreting-histograms">Interpreting Histograms</a></li>
  <li><a href="#interpreting-boxplots" id="toc-interpreting-boxplots" class="nav-link" data-scroll-target="#interpreting-boxplots">Interpreting Boxplots</a></li>
  <li><a href="#interpreting-q-q-plot" id="toc-interpreting-q-q-plot" class="nav-link" data-scroll-target="#interpreting-q-q-plot">Interpreting Q-Q Plot</a></li>
  </ul></li>
  <li><a href="#machine-learning-model" id="toc-machine-learning-model" class="nav-link" data-scroll-target="#machine-learning-model">Machine Learning Model</a>
  <ul class="collapse">
  <li><a href="#linear-regression-model" id="toc-linear-regression-model" class="nav-link" data-scroll-target="#linear-regression-model">Linear Regression Model</a></li>
  <li><a href="#k-nearest-neighbor-knn-model" id="toc-k-nearest-neighbor-knn-model" class="nav-link" data-scroll-target="#k-nearest-neighbor-knn-model">K-Nearest Neighbor (KNN) Model</a></li>
  <li><a href="#decision-tree-model" id="toc-decision-tree-model" class="nav-link" data-scroll-target="#decision-tree-model">Decision Tree Model</a></li>
  <li><a href="#confusion-matrix" id="toc-confusion-matrix" class="nav-link" data-scroll-target="#confusion-matrix">Confusion Matrix</a></li>
  </ul></li>
  <li><a href="#tutorial-qna" id="toc-tutorial-qna" class="nav-link" data-scroll-target="#tutorial-qna">Tutorial QnA</a>
  <ul class="collapse">
  <li><a href="#tutorial-1-introduction-to-r" id="toc-tutorial-1-introduction-to-r" class="nav-link" data-scroll-target="#tutorial-1-introduction-to-r">Tutorial 1 (Introduction to R)</a></li>
  <li><a href="#tutorial-2-basic-prob-and-stats" id="toc-tutorial-2-basic-prob-and-stats" class="nav-link" data-scroll-target="#tutorial-2-basic-prob-and-stats">Tutorial 2 (Basic Prob and Stats)</a></li>
  <li><a href="#tutorial-3-linear-regression-1" id="toc-tutorial-3-linear-regression-1" class="nav-link" data-scroll-target="#tutorial-3-linear-regression-1">Tutorial 3 (Linear Regression 1)</a></li>
  <li><a href="#tutorial-4-linear-regression-2" id="toc-tutorial-4-linear-regression-2" class="nav-link" data-scroll-target="#tutorial-4-linear-regression-2">Tutorial 4 (Linear Regression 2)</a></li>
  <li><a href="#tutorial-5-linreg-knn" id="toc-tutorial-5-linreg-knn" class="nav-link" data-scroll-target="#tutorial-5-linreg-knn">Tutorial 5 (Linreg &amp; KNN)</a></li>
  <li><a href="#tutorial-6-knn-decision-tree" id="toc-tutorial-6-knn-decision-tree" class="nav-link" data-scroll-target="#tutorial-6-knn-decision-tree">Tutorial 6 (KNN &amp; Decision Tree)</a></li>
  </ul></li>
  <li><a href="#past-year-papers" id="toc-past-year-papers" class="nav-link" data-scroll-target="#past-year-papers">Past Year Papers</a>
  <ul class="collapse">
  <li><a href="#y2223-s2" id="toc-y2223-s2" class="nav-link" data-scroll-target="#y2223-s2">Y(22/23) S2</a></li>
  <li><a href="#y2324-s1" id="toc-y2324-s1" class="nav-link" data-scroll-target="#y2324-s1">Y(23/24) S1</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">DSA1101: Everything You Need</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Hi! I’m Ray! Welcome to your ultimate DSA1101 survival guide! 🎉 Whether you’re new to data science or leveling up for midterms, this helpsheet blog has bite-sized tips, easy code, and all the cheat codes you need. 🚀 From data wrangling to machine learning, I’ve got you covered. Ready to dive in? Let’s go! 😎</p>
<section id="getting-started" class="level1">
<h1>Getting Started</h1>
<section id="working-directory" class="level2">
<h2 class="anchored" data-anchor-id="working-directory">Working Directory</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># setwd("/Users/rayana/Documents/DSA1101/")</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># getwd()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="reading-file" class="level2">
<h2 class="anchored" data-anchor-id="reading-file">Reading File</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"crab.csv"</span>, <span class="at">header =</span> <span class="cn">FALSE</span>, <span class="at">sep =</span> <span class="st">""</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"crab.csv"</span>, <span class="at">header =</span> <span class="cn">TRUE</span>, <span class="at">sep =</span> <span class="st">","</span>) </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Reading a tab-separated file</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.delim</span>(<span class="st">"crab.csv"</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"crab.csv"</span>, <span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="common-plots" class="level2">
<h2 class="anchored" data-anchor-id="common-plots">Common Plots</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pie.chart &lt;- pie(x, labels, radius, main, col, clockwise)</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># bar.chart &lt;- barplot(H, xlab, ylab, main, names.arg, col)</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># box.chart &lt;- boxplot(x, data, notch, varwidth, names, main)</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># histogram &lt;- hist(v, main, xlab, xlim, ylim, breaks, col, border)</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># linegraph &lt;- plot(v, type, col, xlab, ylab)</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># scatterplot &lt;- plot(x, y, xlab, ylab, xlim, ylim, axes)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="uselful-functions" class="level2">
<h2 class="anchored" data-anchor-id="uselful-functions">Uselful Functions</h2>
<p>Here are some functions that will make your life so much easier—but let’s be real, you probably forget how to use them half the time! 😅</p>
<section id="function-ifelse" class="level3">
<h3 class="anchored" data-anchor-id="function-ifelse">Function: ifelse()</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(x <span class="sc">%%</span> <span class="dv">2</span> <span class="sc">==</span> <span class="dv">0</span>, <span class="st">"even"</span>, <span class="st">"odd"</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "odd"  "even" "odd"  "even" "odd"  "even" "odd"  "even" "odd"  "even"</code></pre>
</div>
</div>
</section>
<section id="function-which" class="level3">
<h3 class="anchored" data-anchor-id="function-which">Function: which()</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>), </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="at">y =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>rows <span class="ot">&lt;-</span> <span class="fu">which</span>(df<span class="sc">$</span>x <span class="sc">&gt;</span> <span class="dv">3</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>rows</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4 5</code></pre>
</div>
</div>
</section>
<section id="function-append" class="level3">
<h3 class="anchored" data-anchor-id="function-append">Function: append()</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>vec <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>combined_vec <span class="ot">&lt;-</span> <span class="fu">append</span>(vec, <span class="dv">3</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>combined_vec</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 3</code></pre>
</div>
</div>
<hr>
</section>
</section>
</section>
<section id="interpreting-graphical-data" class="level1">
<h1>Interpreting Graphical Data</h1>
<p>Some questions will require us to give comments regarding the plotted data, and this is how</p>
<section id="interpreting-scatterplots" class="level2">
<h2 class="anchored" data-anchor-id="interpreting-scatterplots">Interpreting Scatterplots</h2>
<ol type="1">
<li><p>Is there any relationship? Is it strong?</p></li>
<li><p>If there is, is it positive or negative?</p></li>
<li><p>Relationship is linear or non-linear?</p></li>
<li><p>Special observations?</p></li>
<li><p>Is the variability of the response stable when x changes?</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"house_selling_prices_FL.csv"</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(data<span class="sc">$</span>price <span class="sc">~</span> data<span class="sc">$</span>size, <span class="at">pch =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Comments:</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. There is a clear relationship.</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. It is a positive association.</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. It seems linear.</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Variability of price is quite stable as size changes.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="two-categorical-scatterplots" class="level3">
<h3 class="anchored" data-anchor-id="two-categorical-scatterplots">Two Categorical Scatterplots</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>fev <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"FEV.csv"</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>female <span class="ot">=</span> fev<span class="sc">$</span>FEV[<span class="fu">which</span>(fev<span class="sc">$</span>Sex<span class="sc">==</span><span class="dv">0</span>)]</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternative: fev$FEV[fev$Sex==0]</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>male <span class="ot">=</span> fev<span class="sc">$</span>FEV[<span class="fu">which</span>(fev<span class="sc">$</span>Sex<span class="sc">==</span><span class="dv">1</span>)] </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternative: fev$FEV[fev$Sex==1]</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fev<span class="sc">$</span>height, fev<span class="sc">$</span>FEV, <span class="at">type =</span> <span class="st">"n"</span>)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(female <span class="sc">~</span> fev<span class="sc">$</span>height[<span class="fu">which</span>(fev<span class="sc">$</span>Sex<span class="sc">==</span><span class="dv">0</span>)], </span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="at">col =</span> <span class="st">"red"</span>, <span class="at">pch =</span> <span class="dv">20</span>)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(male <span class="sc">~</span> fev<span class="sc">$</span>height[<span class="fu">which</span>(fev<span class="sc">$</span>Sex<span class="sc">==</span><span class="dv">1</span>)], </span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="at">col =</span> <span class="st">"darkblue"</span>, <span class="at">pch =</span> <span class="dv">20</span>)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="fl">1.2</span>, <span class="dv">5</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Female"</span>, <span class="st">"Male"</span>), </span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>,<span class="st">"darkblue"</span>), <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">20</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Comments:</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Computed correlation is quite high.</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co"># It is clear from the plot that there is a strong </span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># positive linear association between FEV and height. </span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># The range of FEV and height for males appears larger than for females. </span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="co"># The variability of FEV at lower heights seems slightly </span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co"># less than the variability of FEV at greater heights.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="interpreting-histograms" class="level2">
<h2 class="anchored" data-anchor-id="interpreting-histograms">Interpreting Histograms</h2>
<ol type="1">
<li><p>Range</p></li>
<li><p>Bimodal/Unimodal</p></li>
<li><p>Symmetric/Skewed</p></li>
<li><p>Data has Gaps/is Clustered</p></li>
<li><p>Suspected outliers</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>hdb <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"hdbresale_reg.csv"</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(hdb<span class="sc">$</span>resale_price)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Comments:</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co"># range: 200k to ~1 mil</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"># unimodal</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># clearly right skewed</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co"># suspected outliers</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>fev <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"FEV.csv"</span>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(fev<span class="sc">$</span>FEV)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Comments:</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co"># range: 0.5 to 6</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co"># unimodal</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># slightly right skewed</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co"># may have outliers</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="creating-separates-histograms" class="level3">
<h3 class="anchored" data-anchor-id="creating-separates-histograms">Creating Separates Histograms</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>fev <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"FEV.csv"</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>female <span class="ot">=</span> fev<span class="sc">$</span>FEV[<span class="fu">which</span>(fev<span class="sc">$</span>Sex<span class="sc">==</span><span class="dv">0</span>)]</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternative: fev$FEV[fev$Sex==0]</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>male <span class="ot">=</span> fev<span class="sc">$</span>FEV[<span class="fu">which</span>(fev<span class="sc">$</span>Sex<span class="sc">==</span><span class="dv">1</span>)] </span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternative: fev$FEV[fev$Sex==1]</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>opar <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)) </span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(female, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">freq=</span> <span class="cn">FALSE</span>, </span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="at">main =</span> <span class="st">"Histogram of Female FEV"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.52</span>))</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(male, <span class="at">col =</span> <span class="dv">4</span>, <span class="at">freq=</span> <span class="cn">FALSE</span>, </span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="at">main =</span> <span class="st">"Histogram of Male FEV"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.52</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remember to use par(mfrow=c(1,1)) to reset the diagram layout!</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Comments:</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Both histogram are unimodal but have different shapes. </span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co"># It is almost symmetrical for females, but quite </span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="co"># right-skewed for males.</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Median FEV for females is much lower than males,</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 2.49 compared to 2.605.</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Variability for males is higher than females.</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="co"># The respective IQR are 1.54 and 1.05.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="interpreting-boxplots" class="level2">
<h2 class="anchored" data-anchor-id="interpreting-boxplots">Interpreting Boxplots</h2>
<ol type="1">
<li><p>How many outliers</p></li>
<li><p>Median</p></li>
<li><p>Distribution</p></li>
<li><p>Any visible pattern? (Optional)</p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>hbd <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"hdbresale_reg.csv"</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>bp <span class="ot">&lt;-</span> <span class="fu">boxplot</span>(hdb<span class="sc">$</span>resale_price)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>outliers <span class="ot">&lt;-</span> bp<span class="sc">$</span>out</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(outliers)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 680000 728000 680000 707000 640000 659500</code></pre>
</div>
</div>
</section>
<section id="interpreting-q-q-plot" class="level2">
<h2 class="anchored" data-anchor-id="interpreting-q-q-plot">Interpreting Q-Q Plot</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>fev <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"FEV.csv"</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(fev<span class="sc">$</span>FEV, <span class="at">pch =</span> <span class="dv">20</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(fev<span class="sc">$</span>FEV, <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Comments:</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Left tail sample quantiles are larger than expected,</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co"># hence left tail shorter than normal. </span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Right tail sample quantiles larger than expected, hence # right tail longer than normal.</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Combined with the histogram of FEV, it is clear that the</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="co"># sample of FEV is not normally distributed and quite </span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="co"># right skewed.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<hr>
</section>
</section>
<section id="machine-learning-model" class="level1">
<h1>Machine Learning Model</h1>
<p>We’ve covered 3 machine learning models that are up for grabs in the midterm: linear regression, k-nearest neighbors, and decision trees.</p>
<section id="linear-regression-model" class="level2">
<h2 class="anchored" data-anchor-id="linear-regression-model">Linear Regression Model</h2>
<p>There are assumptions have to be fulfilled before using linear model:</p>
<ol type="1">
<li><p>Quantitative response (check through str() function)</p>
<p>Remember to <code>as.factor()</code> categorical features</p></li>
<li><p>Symmetric (check through histogram and/or qqplot)</p></li>
<li><p>Variability of y is stable when x changes (check through scatterplot)</p></li>
</ol>
<p>If data is found to be asymmetric, can do transformation: log(Y), sqrt(Y), 1/Y</p>
<table class="caption-top table">
<colgroup>
<col style="width: 27%">
<col style="width: 37%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th>Transformation</th>
<th>Restriction</th>
<th>Reverse Transformation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>new_Y &lt;- log(Y)</td>
<td>Y can’t be 0 nor negative</td>
<td>pred &lt;- exp(pred)</td>
</tr>
<tr class="even">
<td>new_Y &lt;- sqrt(Y)</td>
<td>Y can’t be negative</td>
<td>pred &lt;- pred**2</td>
</tr>
<tr class="odd">
<td>new_Y &lt;- 1/Y</td>
<td>Y can’t be 0</td>
<td>pred &lt;- 1/pred</td>
</tr>
</tbody>
</table>
<p>To evaluate goodness of fit, we consider F-test and <span class="math inline">\(R^2\)</span>. When comparing models however, use adjusted <span class="math inline">\(R^2\)</span></p>
<p><img src="images/clipboard-1113485621.png" class="img-fluid"></p>
</section>
<section id="k-nearest-neighbor-knn-model" class="level2">
<h2 class="anchored" data-anchor-id="k-nearest-neighbor-knn-model">K-Nearest Neighbor (KNN) Model</h2>
<p>There are some important steps when doing KNN:</p>
<ol type="1">
<li>Importing the required library
<ul>
<li><code>library(class)</code></li>
</ul></li>
<li>Standardizing NUMERIC input features.
<ul>
<li>Very important, especially when they are in different magnitudes.</li>
<li>Use <code>scale()</code> Function</li>
</ul></li>
<li>Randomly split original data to train and test set.
<ul>
<li>Usually 80% train and 20% split.</li>
<li>Use <code>shuffle()</code> function</li>
<li>Remember to <code>set.seed()</code></li>
</ul></li>
</ol>
<p>To evaluate goodness of fit, N-fold cross validation is usually do to. It’s a fair way to evaluate most of classifier models. Confusion matrix is also used to check accuracy, precision, etc.</p>
<p><em>Bayes decision boundary</em> (the gold standard decision boundary) is also often used to check the goodness of fit, especially in choosing the right K.</p>
<ul>
<li><p>Small K (more flexibility): When K is small, like K = 1, the KNN model is more flexible, fitting the data closely and capturing non-linear patterns. This allows it to adapt better to local variations in the data, which is important for non-linear decision boundaries. However, small KKK values can also make the model more sensitive to noise and prone to overfitting.</p></li>
<li><p>Large K (More Smoothing): A large K smooths out the decision boundary because the prediction is averaged over more neighbors. This can be useful for linear or simple decision boundaries, but in the case of highly non-linear boundaries, a large K would result in underfitting, where the model oversimplifies the decision boundary and fails to capture the complex patterns.</p></li>
</ul>
<p><img src="images/clipboard-2254413627.png" class="img-fluid"></p>
</section>
<section id="decision-tree-model" class="level2">
<h2 class="anchored" data-anchor-id="decision-tree-model">Decision Tree Model</h2>
<p>There are some important steps when doing Decision Tree:</p>
<ol type="1">
<li>importing the required library
<ul>
<li><code>library(rpart)</code> : minsplit, maxdepth, cp</li>
<li><code>library(rpart.plot)</code> : varlen, faclen</li>
</ul></li>
<li>Understanding the fitted tree. It’s crucial to know the how and why of the fitted tree to avoid bias</li>
</ol>
<p>To evaluate goodness of fit, N-fold cross validation can do. But most of the times confusion matrix is used.</p>
</section>
<section id="confusion-matrix" class="level2">
<h2 class="anchored" data-anchor-id="confusion-matrix">Confusion Matrix</h2>
<p>Not a ML model, but a way to evaluate most of classifiers</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://images.prismic.io/encord/edfa849b-03fb-43d2-aba5-1f53a8884e6f_image5.png?auto=compress,format" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<p>Some other formulas:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://miro.medium.com/v2/resize:fit:1400/1*gN97G0W-ochkB5z3lUtPBQ.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></p>
</figure>
</div>
<hr>
</section>
</section>
<section id="tutorial-qna" class="level1">
<h1>Tutorial QnA</h1>
<p>Welcome to the <strong><em>tutorial zone</em></strong>—aka the place where I’ve had my biggest lightbulb moments! 💡✨ This is where the real learning happens, and I’m spilling all the tea on what I’ve solved and learned so far. Tutorials can be tough, but they’re also where everything <em>finally</em> clicks. Let’s make it fun and get things done! 😎</p>
<section id="tutorial-1-introduction-to-r" class="level2">
<h2 class="anchored" data-anchor-id="tutorial-1-introduction-to-r">Tutorial 1 (Introduction to R)</h2>
<section id="offsite-questions" class="level4">
<h4 class="anchored" data-anchor-id="offsite-questions">Offsite Questions</h4>
<p>General idea of this problem: You have just graduated from NUS and just started your first job. You plan to buy a flat on your own which has price = $1,200,000 (1.2 million dollars). You need to save money for several years before you can afford to make the down payment which is 25% of the flat’s price.</p>
<ul>
<li>Call the amount that you have saved thus far: <strong>saved</strong>. You start the very first month with a savings of $10,000 that your parents gave you.</li>
<li>Call your monthly salary as <strong>salary</strong> which is paid at the end of every month. Each month, you are going to dedicate 40% of your salary to save for the down payment.</li>
<li>Assume that you invest your savings wisely, with a monthly average return of 2%. That means: at the end of each month, you receive an additional of <strong>saved</strong> ×0.02 funds where <strong>saved</strong> is the amount you have from end of previous month to put into your savings.</li>
<li>At the end of each month, your savings will be increased by the return on your investment, plus 40% of your monthly salary.</li>
</ul>
<p>Note: In your code for the questions below, you MUST use the names as given in bold above.</p>
<ol type="1">
<li><p>Write the code to calculate how many months it will take you to save up enough money for the down payment for two persons of of different salary: (i) <strong>salary</strong> = $7,000; and (ii) <strong>salary</strong> = $10,000.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Solution 1.i</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>cost <span class="ot">&lt;-</span> <span class="dv">1200000</span> <span class="sc">*</span> <span class="fl">0.25</span> </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>salary <span class="ot">&lt;-</span> <span class="dv">7000</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>saved <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>month <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span>(saved <span class="sc">&lt;</span> cost){</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>month <span class="ot">&lt;-</span> month <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>saved <span class="ot">&lt;-</span> saved <span class="sc">+</span> <span class="fl">0.4</span> <span class="sc">*</span> salary <span class="sc">+</span> <span class="fl">0.02</span> <span class="sc">*</span> saved }</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(month) <span class="co"># 55</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 55</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Solution 2.i</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>cost <span class="ot">&lt;-</span> <span class="dv">1200000</span> <span class="sc">*</span> <span class="fl">0.25</span> </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>salary <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>saved <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>month <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span>(saved <span class="sc">&lt;</span> cost){</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>month <span class="ot">&lt;-</span> month <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>saved <span class="ot">&lt;-</span> saved <span class="sc">+</span> <span class="fl">0.4</span> <span class="sc">*</span> salary <span class="sc">+</span> <span class="fl">0.02</span> <span class="sc">*</span> saved }</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(month) <span class="co"># 44</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 44</code></pre>
</div>
</div></li>
<li><p>In question above, we unrealistically assumed that the salary doesn’t change over the years. However, now we consider that the salary will be raised every 4 months by a rate named rate, this variable should be in decimal form (i.e.&nbsp;0.03 for 3%). The new salary will be applied for the month after every batch of 4 months.</p>
<p>With this further assumption, write the code to calculate how many months it will take a person to save up enough money for the down payment if that person has (i) (<strong>salary</strong> = $7,000 and <strong>rate</strong> = 0.02); (ii) (<strong>salary</strong> = $10,000 and <strong>rate</strong> = 0.01).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Solution 2.i</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>cost <span class="ot">&lt;-</span> <span class="dv">1200000</span> <span class="sc">*</span> <span class="fl">0.25</span> </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>salary <span class="ot">&lt;-</span> <span class="dv">7000</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>saved <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>month <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>rate <span class="ot">&lt;-</span> <span class="fl">0.02</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (saved <span class="sc">&lt;</span> cost) {</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>  month <span class="ot">&lt;-</span> month <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>  saved <span class="ot">&lt;-</span> saved <span class="sc">+</span> <span class="fl">0.4</span> <span class="sc">*</span> salary <span class="sc">+</span> <span class="fl">0.02</span> <span class="sc">*</span> saved</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (month <span class="sc">%%</span> <span class="dv">4</span> <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>    salary <span class="ot">&lt;-</span>  salary <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> rate)</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(month) <span class="co">#52</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 52</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Solution 2.ii</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>cost <span class="ot">&lt;-</span> <span class="dv">1200000</span> <span class="sc">*</span> <span class="fl">0.25</span> </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>salary <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>saved <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>month <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>rate <span class="ot">&lt;-</span> <span class="fl">0.01</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (saved <span class="sc">&lt;</span> cost) {</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  month <span class="ot">&lt;-</span> month <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>  saved <span class="ot">&lt;-</span> saved <span class="sc">+</span> <span class="fl">0.4</span> <span class="sc">*</span> salary <span class="sc">+</span> <span class="fl">0.02</span> <span class="sc">*</span> saved</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (month <span class="sc">%%</span> <span class="dv">4</span> <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>    salary <span class="ot">&lt;-</span>  salary <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> rate)</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(month) <span class="co">#43</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 43</code></pre>
</div>
</div></li>
</ol>
</section>
<section id="onsite-questions" class="level4">
<h4 class="anchored" data-anchor-id="onsite-questions">Onsite Questions</h4>
<ol type="1">
<li><p>A sequence is generated using the following recursive relation</p>
<p><span class="math inline">\(x_n\)</span> = <span class="math inline">\(2x_{n-1}\)</span> <span class="math inline">\(-\)</span> <span class="math inline">\(x_{n-2}\)</span> <span class="math inline">\(+\)</span> <span class="math inline">\(5\)</span>, <span class="math inline">\(\text{ for } n \geq 3\)</span></p>
<p>with <span class="math inline">\(x_1\)</span> = 0 and <span class="math inline">\(x_2\)</span> = 1.</p>
<p>(a) Use for loop in R to find the 30th term of the series.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">30</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">30</span>) {</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  x[i] <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>x[i<span class="dv">-1</span>] <span class="sc">-</span> x[i<span class="dv">-2</span>] <span class="sc">+</span> <span class="dv">5</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">30</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2059</code></pre>
</div>
</div>
<p><br>
</p>
<ol start="2" type="a">
<li>Find the smallest value of n such that <span class="math inline">\(x_n\)</span> ≥ 1,000</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">10</span>) </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (x[i<span class="dv">-1</span>] <span class="sc">&lt;=</span> <span class="dv">1000</span>) {</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  x[i] <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> x[i<span class="dv">-1</span>] <span class="sc">-</span> x[i<span class="dv">-2</span>] <span class="sc">+</span> <span class="dv">5</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  i <span class="ot">&lt;-</span> i <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1071</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(x <span class="sc">==</span> <span class="fu">max</span>(x))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 22</code></pre>
</div>
</div></li>
<li><p>Consider another sequence which is generated using the following recursive relation</p>
<p><span class="math inline">\(y_1 = 2800 + 1.02\times y_0, \text{ with } y_0 = 1000\)</span> and</p>
<p><span class="math inline">\(y_n = 2800 + 1.02\times y_{n-1}, \text{ for } n \geq 2\)</span></p>
<p>find the smallest value of <span class="math inline">\(n\)</span> such as <span class="math inline">\(y_n\)</span> <span class="math inline">\(\geq\)</span> <span class="math inline">\(300,000\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">numeric</span>()  <span class="co"># Initialize an empty numeric vector</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>y[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">2800</span> <span class="sc">+</span> <span class="fl">1.02</span> <span class="sc">*</span> <span class="dv">10000</span>  <span class="co"># y_1</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (y[n<span class="dv">-1</span>] <span class="sc">&lt;</span> <span class="dv">300000</span>) {</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>  y[n] <span class="ot">&lt;-</span> <span class="dv">2800</span> <span class="sc">+</span> <span class="fl">1.02</span> <span class="sc">*</span> y[n<span class="dv">-1</span>]</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> n <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 305759.6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(y <span class="sc">==</span> <span class="fu">max</span>(y))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 55</code></pre>
</div>
</div></li>
</ol>
</section>
</section>
<section id="tutorial-2-basic-prob-and-stats" class="level2">
<h2 class="anchored" data-anchor-id="tutorial-2-basic-prob-and-stats">Tutorial 2 (Basic Prob and Stats)</h2>
<section id="offsite-questions-1" class="level4">
<h4 class="anchored" data-anchor-id="offsite-questions-1">Offsite Questions</h4>
<p>Forced Expiratory Volume (FEV) is an index of pulmonary function that measures the volume of air expelled after 1 second of constant effort. The dataset <code>FEV.csv</code> contains measurements for 654 children aged 3 to 19 years of age. The purpose of the data collection was to study how FEV is affected by certain other variables. The variables that we shall work with are</p>
<p><strong>Age</strong>: Age in years.<br>
<strong>FEV</strong>: FEV measurement.<br>
<strong>Hgt</strong>: Height in inches.<br>
<strong>height</strong>: Height in meters<br>
<strong>Sex</strong>: 0 = female, 1 = male.<br>
<strong>Smoking status</strong>: 0 = current non-smoker, 1 = current smoker.</p>
<p>(a) What is the response variable in this study?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># FEV is the response variable in this study</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(b) Create a histogram of FEV and comment on it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>fev <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"FEV.csv"</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(fev<span class="sc">$</span>FEV)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Comments:</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="co"># range: 0.5 to 6</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="co"># unimodal</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="co"># slightly right skewed</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="co"># may have outliers</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(c) Create a boxplot of FEV and identify how many outliers there are. Investigate your data and comment on these outliers.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>bp <span class="ot">&lt;-</span> <span class="fu">boxplot</span>(fev<span class="sc">$</span>FEV)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>outliers <span class="ot">&lt;-</span> bp<span class="sc">$</span>out</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(outliers)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># There are 9 outliers</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>index <span class="ot">&lt;-</span> <span class="fu">which</span>(fev<span class="sc">$</span>FEV <span class="sc">%in%</span> outliers)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>fev[index,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       ID Age  FEV Hgt Sex Smoke height
321  2142  14 4.84  72   1     0   1.83
452 33041  12 5.22  70   1     0   1.78
464 37241  13 4.88  73   1     0   1.85
517 49541  13 5.08  74   1     0   1.88
609  6144  19 5.10  72   1     0   1.83
624 25941  15 5.79  69   1     0   1.75
632 37441  17 5.63  73   1     0   1.85
648 71141  17 5.64  70   1     0   1.78
649 71142  16 4.87  72   1     1   1.83</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Comments:</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. All outliers are male</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Most (8/9) are</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="co"># non-smokers</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. They are rather</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="co"># tall</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(d) Generally, is the sample of FEV normally distributed?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(fev<span class="sc">$</span>FEV, <span class="at">pch =</span> <span class="dv">20</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(fev<span class="sc">$</span>FEV, <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Comments:</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Left tail sample quantiles are larger than expected,</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="co"># hence left tail shorter than normal. </span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Right tail sample quantiles larger than expected, hence # right tail longer than normal.</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Combined with the histogram of FEV, it is clear that the</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="co"># sample of FEV is not normally distributed and quite </span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a><span class="co"># right skewed.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(e) Create separate histograms for male and female FEV, then obtain separate numerical summaries for males and female FEV. Comment on what you observe.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First, obtain the male and female FEV values separately</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="co"># to plot onto two different histograms.</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>female <span class="ot">=</span> fev<span class="sc">$</span>FEV[<span class="fu">which</span>(fev<span class="sc">$</span>Sex<span class="sc">==</span><span class="dv">0</span>)]</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternative: fev$FEV[fev$Sex==0]</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>male <span class="ot">=</span> fev<span class="sc">$</span>FEV[<span class="fu">which</span>(fev<span class="sc">$</span>Sex<span class="sc">==</span><span class="dv">1</span>)] </span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternative: fev$FEV[fev$Sex==1]</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Now plot the two histograms side-by-side</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>opar <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)) </span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(female, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">freq=</span> <span class="cn">FALSE</span>, </span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a><span class="at">main =</span> <span class="st">"Histogram of Female FEV"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.52</span>))</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(male, <span class="at">col =</span> <span class="dv">4</span>, <span class="at">freq=</span> <span class="cn">FALSE</span>, </span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a><span class="at">main =</span> <span class="st">"Histogram of Male FEV"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.52</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remember to use par(mfrow=c(1,1))  to reset the diagram layout!</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="co"># obtaining separate numerical summaries for male and female</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="fu">IQR</span>(female) <span class="co"># 1.04</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.04</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(female) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.790   1.950   2.490   2.452   2.990   3.840 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(female) <span class="co"># 0.4169424</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4169424</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">IQR</span>(male) <span class="co"># 1.5275</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.5275</code></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(male)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.800   2.007   2.605   2.813   3.535   5.790 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(male) <span class="co"># 1.006866</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.006866</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Comments:</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Both histogram are unimodal but have different shapes. </span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="co"># It is almost symmetrical for females, but quite right-skewed for males.</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Median FEV for females is much lower than males, 2.49 compared to 2.605.</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Variability for males is higher than females.</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a><span class="co"># The respective IQR are 1.54 and 1.05.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(f) Create a scatterplot with height (in metres) on the x-axis and FEV on the y-axis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fev<span class="sc">$</span>height, fev<span class="sc">$</span>FEV)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(female <span class="sc">~</span> fev<span class="sc">$</span>height[<span class="fu">which</span>(fev<span class="sc">$</span>Sex<span class="sc">==</span><span class="dv">0</span>)], </span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="at">col =</span> <span class="st">"red"</span>, <span class="at">pch =</span> <span class="dv">20</span>)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(male <span class="sc">~</span> fev<span class="sc">$</span>height[<span class="fu">which</span>(fev<span class="sc">$</span>Sex<span class="sc">==</span><span class="dv">1</span>)], </span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a><span class="at">col =</span> <span class="st">"darkblue"</span>, <span class="at">pch =</span> <span class="dv">20</span>)</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="fl">1.2</span>, <span class="dv">5</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Female"</span>, <span class="st">"Male"</span>), </span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a><span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>,<span class="st">"darkblue"</span>), <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">20</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>(g) Compute the correlation between FEV and height and comment on your results.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(fev<span class="sc">$</span>FEV, fev<span class="sc">$</span>height) <span class="co"># 0.8675619</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8675619</code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Computed correlation is quite high.</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="co"># It is clear from the plot that there is a strong </span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="co"># positive linear association between FEV and height. </span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a><span class="co"># The range of FEV and height for males appears larger than for females. </span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a><span class="co"># The variability of FEV at lower heights seems slightly </span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a><span class="co"># less than the variability of FEV at greater heights.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="onsite-questions-1" class="level4">
<h4 class="anchored" data-anchor-id="onsite-questions-1">Onsite Questions</h4>
<p>COMING SOON</p>
</section>
</section>
<section id="tutorial-3-linear-regression-1" class="level2">
<h2 class="anchored" data-anchor-id="tutorial-3-linear-regression-1">Tutorial 3 (Linear Regression 1)</h2>
<section id="offsite-questions-2" class="level4">
<h4 class="anchored" data-anchor-id="offsite-questions-2">Offsite Questions</h4>
<p>Consider the question given in Tutorial 1.</p>
<p>(a) For the first question in Tutorial 1, use the code to define a function, called F1, where the argument of F1 is salary. Run function F1 for the two cases mentioned.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>cost <span class="ot">&lt;-</span> <span class="dv">1200000</span> <span class="sc">*</span> <span class="fl">0.25</span> </span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>F1 <span class="ot">&lt;-</span> <span class="cf">function</span>(salary) {</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  saved <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>  month <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span>(saved <span class="sc">&lt;</span> cost) {</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>    month <span class="ot">&lt;-</span> month <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>    saved <span class="ot">&lt;-</span> saved <span class="sc">+</span> <span class="fl">0.4</span> <span class="sc">*</span> salary <span class="sc">+</span> <span class="fl">0.02</span> <span class="sc">*</span> saved</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(month)</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(b) For the second question in Tutorial 1, use the code to define a function, called F2, where F2 has two arguments: salary and rate. Run function F2 for the two cases mentioned to obtain the results.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>F2 <span class="ot">&lt;-</span> <span class="cf">function</span>(salary, <span class="at">price =</span> <span class="dv">1200000</span>, <span class="at">rate =</span> <span class="fl">0.01</span>, <span class="at">portion_save =</span> <span class="fl">0.4</span>) {</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">=</span> <span class="fl">0.02</span> <span class="co"># monthly rate return from investment</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  saved <span class="ot">&lt;-</span> <span class="dv">10000</span> <span class="co"># savings given by parents initially</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  month <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>  cost <span class="ot">=</span> <span class="fl">0.25</span><span class="sc">*</span>price</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span>(saved <span class="sc">&lt;</span> cost) {</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>    month <span class="ot">=</span> month <span class="sc">+</span><span class="dv">1</span></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>    saved <span class="ot">=</span> saved <span class="sc">+</span> portion_save <span class="sc">*</span> salary <span class="sc">+</span> saved <span class="sc">*</span> r</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (month <span class="sc">%%</span> <span class="dv">4</span> <span class="sc">==</span><span class="dv">0</span>) {</span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>      salary <span class="ot">=</span> salary<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>rate)</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(month)</span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="onsite-questions-2" class="level4">
<h4 class="anchored" data-anchor-id="onsite-questions-2">Onsite Questions</h4>
<p>COMING SOON</p>
</section>
</section>
<section id="tutorial-4-linear-regression-2" class="level2">
<h2 class="anchored" data-anchor-id="tutorial-4-linear-regression-2">Tutorial 4 (Linear Regression 2)</h2>
<section id="offsite-questions-3" class="level4">
<h4 class="anchored" data-anchor-id="offsite-questions-3">Offsite Questions</h4>
<p>Consider data set given in the file <code>hdbresale_reg.csv</code> on Canvas, which has the information of 6055 HDB resale flats in Singapore. We would want to form a linear model that helps to predict the resale price of HDB flats, based on the floor area in square meters and the type of the flats.</p>
<p>(a) Consider the resale price, plot a histogram of it and give your comments. Is it suitable to fit a<br>
linear model for this response variable? Explain.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"hdbresale_reg.csv"</span>)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   6055 obs. of  11 variables:
 $ X                  : int  580 581 582 583 584 585 586 587 588 589 ...
 $ month              : chr  "2012-03" "2012-03" "2012-03" "2012-03" ...
 $ town               : chr  "CENTRAL AREA" "CENTRAL AREA" "CENTRAL AREA" "CENTRAL AREA" ...
 $ flat_type          : chr  "3 ROOM" "3 ROOM" "3 ROOM" "3 ROOM" ...
 $ block              : chr  "640" "640" "668" "5" ...
 $ street_name        : chr  "ROWELL RD" "ROWELL RD" "CHANDER RD" "TG PAGAR PLAZA" ...
 $ storey_range       : chr  "01 TO 05" "06 TO 10" "01 TO 05" "11 TO 15" ...
 $ floor_area_sqm     : num  74 74 73 59 68 75 68 77 82 105 ...
 $ flat_model         : chr  "Model A" "Model A" "Model A" "Improved" ...
 $ lease_commence_date: int  1984 1984 1984 1977 1979 2003 1980 1974 1978 2002 ...
 $ resale_price       : num  380000 388000 400000 460000 488000 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(data<span class="sc">$</span>resale_price)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Comments: </span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Right-skewed histogram</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Hence, resale price is NOT suitable to be the response </span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="co"># as assumption of linear model (symmetric) is violated.</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a><span class="co"># For a right skewed variable, it is suggested to try </span></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a><span class="co"># transforming the response by taking its logarithm.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(b) Consider the resale price, plot a histogram of log_e of it and give your comments. Is it more<br>
suitable to fit a linear model for this response variable than the original resale price?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">log</span>(data<span class="sc">$</span>resale_price))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Comments: </span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="co"># The histogram of the log of the resale price </span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="co"># is more symmetric, hence it is more suitable than </span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a><span class="co"># the original resale price as a response for our linear model.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(c) Derive a scatter plot of the log_e of the resale price against the floor area in square meters. Give your comments.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># creates a new column for the log(price)</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>log.price <span class="ot">=</span> <span class="fu">log</span>(data<span class="sc">$</span>resale_price) </span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(data<span class="sc">$</span>log.price <span class="sc">~</span> data<span class="sc">$</span>floor_area_sqm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Comments:</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="co"># There seems to be a strong, positive, linear relationship</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="co"># between log(price) and floor area.</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a><span class="co"># The variability of the log(price) seems fairly stable </span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a><span class="co"># when the floor area changes.***</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(d) Fit a linear model where the log of the resale price be the response. Write down the fitted equation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   6055 obs. of  12 variables:
 $ X                  : int  580 581 582 583 584 585 586 587 588 589 ...
 $ month              : chr  "2012-03" "2012-03" "2012-03" "2012-03" ...
 $ town               : chr  "CENTRAL AREA" "CENTRAL AREA" "CENTRAL AREA" "CENTRAL AREA" ...
 $ flat_type          : chr  "3 ROOM" "3 ROOM" "3 ROOM" "3 ROOM" ...
 $ block              : chr  "640" "640" "668" "5" ...
 $ street_name        : chr  "ROWELL RD" "ROWELL RD" "CHANDER RD" "TG PAGAR PLAZA" ...
 $ storey_range       : chr  "01 TO 05" "06 TO 10" "01 TO 05" "11 TO 15" ...
 $ floor_area_sqm     : num  74 74 73 59 68 75 68 77 82 105 ...
 $ flat_model         : chr  "Model A" "Model A" "Model A" "Improved" ...
 $ lease_commence_date: int  1984 1984 1984 1977 1979 2003 1980 1974 1978 2002 ...
 $ resale_price       : num  380000 388000 400000 460000 488000 ...
 $ log.price          : num  12.8 12.9 12.9 13 13.1 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(data<span class="sc">$</span>flat_type)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "3 ROOM"    "4 ROOM"    "5 ROOM"    "EXECUTIVE" "2 ROOM"   </code></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>M <span class="ot">=</span> <span class="fu">lm</span>(log.price <span class="sc">~</span> floor_area_sqm <span class="sc">+</span> flat_type, <span class="at">data =</span> data)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log.price ~ floor_area_sqm + flat_type, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.28208 -0.07054 -0.01515  0.04323  0.79797 

Coefficients:
                    Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)        1.235e+01  1.891e-02 653.013  &lt; 2e-16 ***
floor_area_sqm     3.712e-03  1.817e-04  20.429  &lt; 2e-16 ***
flat_type3 ROOM    1.190e-01  1.714e-02   6.944  4.2e-12 ***
flat_type4 ROOM    2.093e-01  1.869e-02  11.196  &lt; 2e-16 ***
flat_type5 ROOM    2.762e-01  2.099e-02  13.160  &lt; 2e-16 ***
flat_typeEXECUTIVE 4.302e-01  2.527e-02  17.023  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1156 on 6049 degrees of freedom
Multiple R-squared:  0.7116,    Adjusted R-squared:  0.7114 
F-statistic:  2986 on 5 and 6049 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fitted_log(price) = </span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 12.35 + </span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.003712 * floor_area_sqm +</span></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.119 ∗ I(flat type = 3 ROOM) +</span></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.2093 ∗ I(flat type = 4 ROOM) +</span></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.2762 ∗ I(flat type = 5 ROOM) +</span></span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.4302 ∗ I(flat type = Executive)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(e) Report the coefficient of the floor area in square meters and interpret it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The coefficient of it is 0.003712. </span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Meaning when comparing two flats of the same type, </span></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="co"># then an increase of 1 square meter will increase </span></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a><span class="co"># the predicted log(price) by 0.003712.</span></span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Equivalently, the price will </span></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a><span class="co"># increase by e^0.003712 = 1.003719 TIMES.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(f) Predict the resale price of a 4-room HDB flat that is of 100 square meters.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>new <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">floor_area_sqm =</span> <span class="dv">100</span>, </span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">flat_type =</span> <span class="st">"4 ROOM"</span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>predicted_log.price <span class="ot">=</span> <span class="fu">predict</span>(M, new)</span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>predicted_price <span class="ot">=</span> <span class="fu">exp</span>(predicted_log.price)</span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(predicted_price) <span class="co"># 412807.6</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1 
412807.6 </code></pre>
</div>
</div>
<p>(g) Report <span class="math inline">\(R^2\)</span> of the model and interpret it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7116378</code></pre>
</div>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The R_squared value is 0.712. </span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="co"># That means model M can explain 71.2% </span></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="co"># of the variability of the response in the sample.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="onsite-questions-3" class="level4">
<h4 class="anchored" data-anchor-id="onsite-questions-3">Onsite Questions</h4>
<p>A dataset on house selling price was randomly collected, <code>house_selling_prices_FL.csv</code>. It’s our interest to model how <span class="math inline">\(y\)</span> = selling price (dollar) is dependent on <span class="math inline">\(x\)</span> = the size of the house (square feet). A simple linear regression model (<span class="math inline">\(y\)</span> regress on <span class="math inline">\(x\)</span>) was fitted, called Model 1.</p>
<p>The given data has another variable, NW, which specifies if a house is in the part of the town considered<br>
less desirable (NW = 0).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>house <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"house_selling_prices_FL.csv"</span>)</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(house)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 100   9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>house<span class="sc">$</span>NW <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(house<span class="sc">$</span>NW)</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(house)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   100 obs. of  9 variables:
 $ House   : int  1 2 3 4 5 6 7 8 9 10 ...
 $ Taxes   : int  1360 1050 1010 830 2150 1230 150 1470 1850 320 ...
 $ Bedrooms: int  3 1 3 3 3 3 2 3 3 3 ...
 $ Baths   : num  2 1 1.5 2 2 2 2 2 2 2 ...
 $ Quadrant: chr  "NW" "NW" "NW" "SW" ...
 $ NW      : Factor w/ 2 levels "0","1": 2 2 2 1 2 2 2 2 2 2 ...
 $ price   : int  145000 68000 115000 69000 163000 69900 50000 137000 121300 70000 ...
 $ size    : int  1240 370 1130 1120 1710 1010 860 1420 1270 1160 ...
 $ lot     : int  18000 25000 25000 17000 14000 8000 15300 18000 16000 8000 ...</code></pre>
</div>
</div>
<p>(a) Derive the correlation between <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(house<span class="sc">$</span>size, house<span class="sc">$</span>price)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7612621</code></pre>
</div>
</div>
<p>(b) Derive a scatter plot of <span class="math inline">\(y\)</span> against <span class="math inline">\(x\)</span>. Give your comments on the association of y and x.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(house<span class="sc">$</span>price <span class="sc">~</span> house<span class="sc">$</span>size, <span class="at">pch =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Comments:</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="co"># There is a clear (obvious) association shown.</span></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a><span class="co"># The association is positive.</span></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a><span class="co"># The association is quite linear.</span></span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a><span class="co"># The variability of y (the price) is quite stable when x (the size) changes.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(c) Derive <span class="math inline">\(R^2\)</span> of Model 1. Verify that <span class="math inline">\(\sqrt{R^2}\)</span> = <span class="math inline">\(|cor(y, x)|\)</span>. In which situation we can have <span class="math inline">\(\sqrt{R^2}\)</span> = <span class="math inline">\(cor(y, x)\)</span>?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>M1 <span class="ot">=</span> <span class="fu">lm</span>(price <span class="sc">~</span> size, <span class="at">data =</span> house)</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M1)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.57952</code></pre>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(<span class="fu">summary</span>(M1)<span class="sc">$</span>r.squared ) <span class="co"># same as cor(price, size) # 0.7612621</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7612621</code></pre>
</div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># From the code above, we can see that </span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="co"># √R^2 = |cor(y, x)|: R^2 = 0.5795, hence, √0.5795 = 0.761 = |cor(y, x)|.</span></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a><span class="co"># When cor(y, x) &gt; 0 then in a simple model y ∼ x, we always have √R2 = cor(y, x)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(d) Form a model (called Model 2) which has two regressors (x and NW). Report the coefficient of variable NW in Model 2. Interpret it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>M2 <span class="ot">=</span> <span class="fu">lm</span>(price <span class="sc">~</span> size <span class="sc">+</span> NW, <span class="at">data =</span> house)</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = price ~ size + NW, data = house)

Residuals:
   Min     1Q Median     3Q    Max 
-83207 -22968    215  14135 109149 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -15257.514  11908.297  -1.281 0.203160    
size            77.985      6.209  12.560  &lt; 2e-16 ***
NW1          30569.087   7948.742   3.846 0.000215 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 34390 on 97 degrees of freedom
Multiple R-squared:  0.6352,    Adjusted R-squared:  0.6276 
F-statistic: 84.43 on 2 and 97 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The fitted equation of Model 2:</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="co"># y_pred = −15257.5 + 77.99x + 30569.1 × I(NW = 1).</span></span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a><span class="co"># The estimated coefficient of NW in Model 2 is 30569.1</span></span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a><span class="co"># This value means: for two houses of the same size (fix x), </span></span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a><span class="co"># the house in the more desirable part (NW = 1) is </span></span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a><span class="co"># $30569.1 more than the one in the less desirable part (NW = 0)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(e) Estimate and report the price of a house where its size is 4000 square feet and is located at the more<br>
desirable part of the town.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(M2, <span class="at">newdata=</span><span class="fu">data.frame</span>(<span class="at">size=</span><span class="dv">4000</span>, <span class="at">NW =</span> <span class="st">"1"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1 
327252.1 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The mean price of a house with size x = 4000 and NW = 1 is $327252.1.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="tutorial-5-linreg-knn" class="level2">
<h2 class="anchored" data-anchor-id="tutorial-5-linreg-knn">Tutorial 5 (Linreg &amp; KNN)</h2>
<section id="offsite-questions-4" class="level4">
<h4 class="anchored" data-anchor-id="offsite-questions-4">Offsite Questions</h4>
<ol type="1">
<li><p>(MLR) Consider the horseshoe female crab data given in the csv file <code>crab.csv</code>. We would want to form a model for the weight of the female crabs (kg), which depends on its width (cm) and its spine condition (1 = both good, 2 = one worn or broken, 3 = both worn or broken).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"crab.csv"</span>)</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  color spine width satell weight
1     3     3  28.3      8   3.05
2     4     3  22.5      0   1.55
3     2     1  26.0      9   2.30
4     4     3  24.8      0   2.10
5     4     3  26.0      4   2.60
6     3     3  23.8      0   2.10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   173 obs. of  5 variables:
 $ color : int  3 4 2 4 4 3 2 4 3 4 ...
 $ spine : int  3 3 1 3 3 3 1 2 1 3 ...
 $ width : num  28.3 22.5 26 24.8 26 23.8 26.5 24.7 23.7 25.6 ...
 $ satell: int  8 0 9 0 4 0 0 0 0 0 ...
 $ weight: num  3.05 1.55 2.3 2.1 2.6 2.1 2.35 1.9 1.95 2.15 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>spine <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(data<span class="sc">$</span>spine)</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 1 = both good</span></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 2 = one worn or broken</span></span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 3 = both worn or broken</span></span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   173 obs. of  5 variables:
 $ color : int  3 4 2 4 4 3 2 4 3 4 ...
 $ spine : Factor w/ 3 levels "1","2","3": 3 3 1 3 3 3 1 2 1 3 ...
 $ width : num  28.3 22.5 26 24.8 26 23.8 26.5 24.7 23.7 25.6 ...
 $ satell: int  8 0 9 0 4 0 0 0 0 0 ...
 $ weight: num  3.05 1.55 2.3 2.1 2.6 2.1 2.35 1.9 1.95 2.15 ...</code></pre>
</div>
</div>
<p>(a) Produce a scatter plot of variable weight against width for different condition of spine.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(data)</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(weight <span class="sc">~</span> width, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">main =</span> <span class="st">"weight vs width for each spine class"</span>,</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"width"</span>, <span class="at">ylab =</span> <span class="st">"weight"</span>)</span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(weight[spine <span class="sc">==</span> <span class="st">"1"</span>] <span class="sc">~</span> width[spine <span class="sc">==</span><span class="st">"1"</span>], <span class="at">pch =</span> <span class="dv">15</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(weight[spine <span class="sc">==</span> <span class="st">"2"</span>] <span class="sc">~</span> width[spine <span class="sc">==</span><span class="st">"2"</span>], <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(weight[spine <span class="sc">==</span> <span class="st">"3"</span>] <span class="sc">~</span> width[spine <span class="sc">==</span><span class="st">"3"</span>], <span class="at">pch =</span> <span class="dv">17</span>, <span class="at">col =</span> <span class="st">"green"</span>)</span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="dv">22</span>,<span class="dv">5</span>,</span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Spine = 1"</span>, <span class="st">"Spine = 2"</span>, <span class="st">"Spine = 3"</span>),</span>
<span id="cb119-9"><a href="#cb119-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span><span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"green"</span>), </span>
<span id="cb119-10"><a href="#cb119-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">15</span>,<span class="dv">16</span>,<span class="dv">17</span>)</span>
<span id="cb119-11"><a href="#cb119-11" aria-hidden="true" tabindex="-1"></a>       )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>(b) Fit a linear regression model for weight which has two explanatories, width and spine.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight <span class="sc">~</span> width <span class="sc">+</span> spine, <span class="at">data =</span> data)</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = weight ~ width + spine, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.23016 -0.10828  0.01016  0.13356  0.96350 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -3.92955    0.27506 -14.286   &lt;2e-16 ***
width        0.24376    0.01002  24.335   &lt;2e-16 ***
spine2       0.05544    0.08475   0.654    0.514    
spine3      -0.06969    0.05065  -1.376    0.171    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2656 on 169 degrees of freedom
Multiple R-squared:  0.7918,    Adjusted R-squared:  0.7881 
F-statistic: 214.2 on 3 and 169 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>(c) Is the fitted model significant?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the model f statistic showing p value is less than 2.2 x 10^-16.</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Since this is far below 0.05, the model can be considered significant</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(d) Derive <span class="math inline">\(R^2\)</span> and adjusted <span class="math inline">\(R^2\)</span> of the fitted model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7917598</code></pre>
</div>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.7917598</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)<span class="sc">$</span>adj.r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7880632</code></pre>
</div>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.7880632</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(e) Write down the fitted model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = weight ~ width + spine, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.23016 -0.10828  0.01016  0.13356  0.96350 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -3.92955    0.27506 -14.286   &lt;2e-16 ***
width        0.24376    0.01002  24.335   &lt;2e-16 ***
spine2       0.05544    0.08475   0.654    0.514    
spine3      -0.06969    0.05065  -1.376    0.171    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2656 on 169 degrees of freedom
Multiple R-squared:  0.7918,    Adjusted R-squared:  0.7881 
F-statistic: 214.2 on 3 and 169 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="co"># weight = -3.92955 + 0.24376*width + 0.05544*I(spine=2) - 0.06969*I(spine=3)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(f) Two female crabs of the same width, and the difference of their weight if one has spines are of good condition and another one with broken spines.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># weight = -3.92955 + 0.24376*width + 0.05544*I(spine=2) - 0.06969*I(spine=3)</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="co"># weight1 = -3.92955 + 0.24376*width + 0.05544*0 - 0.06969*0</span></span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a><span class="co"># weight2 = -3.92955 + 0.24376*width + 0.05544*0 - 0.06969*1</span></span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>weight.dif <span class="ot">&lt;-</span> (<span class="fl">0.05544</span><span class="sc">*</span><span class="dv">0</span> <span class="sc">-</span> <span class="fl">0.06969</span><span class="sc">*</span><span class="dv">0</span>) <span class="sc">-</span> (<span class="fl">0.05544</span><span class="sc">*</span><span class="dv">0</span> <span class="sc">-</span> <span class="fl">0.06969</span><span class="sc">*</span><span class="dv">1</span>)</span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a>weight.dif</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.06969</code></pre>
</div>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co"># When they have the same width, then on average the one that has spines</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a><span class="co"># of good condition is heavier than the one with broken spines by 0.06969 kg.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(g) Predict the weight of a female crab that has width of 27 cm and has both spines worn or broken.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">width =</span> <span class="dv">27</span>, <span class="at">spine =</span> <span class="st">"3"</span>)</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(model, <span class="at">newdata =</span> newdata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1 
2.582352 </code></pre>
</div>
</div></li>
<li><p>Measures of classier performance</p>
<p>Suppose we have developed a K-nearest neighbors classier for predicting diabetes status. The following table shows the actual response <span class="math inline">\(Y\)</span> (1 = yes, 0 =n o) and fitted value <span class="math inline">\(\hat Y\)</span> using the classier for 10 test data points. A test data point is predicted to be <span class="math inline">\(\hat G\)</span>= 1 if <span class="math inline">\(\hat Y\)</span> &gt; δ, for a specied threshold value δ (Recall that we use δ = 0.5 in class, also known as the majority rule).</p>
<p><img src="images/clipboard-794303694.png" class="img-fluid" width="254"></p>
<ol type="a">
<li><p>We define: <span class="math inline">\(TPR = \frac {TP}{TP +FN}\)</span>, <span class="math inline">\(FPR = \frac {FP}{FP +TN}\)</span>; For each of the thresholds δ = 0.3, 0.6 and 0.8, derive <span class="math inline">\(TPR\)</span> and <span class="math inline">\(FPR\)</span> in making predictions with the K-nearest neighbors classier for the 10 test data points. Plot <span class="math inline">\(TPR\)</span> against <span class="math inline">\(FPR\)</span> for the three thresholds.</p>
<p><img src="images/clipboard-2786262008.png" class="img-fluid" width="364"></p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>ycap <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.9</span>,<span class="fl">0.5</span>,<span class="fl">0.7</span>,<span class="fl">0.4</span>,<span class="fl">0.5</span>,<span class="fl">0.2</span>,<span class="fl">0.7</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>)</span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>tpr.all <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">0</span>)</span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a>fpr.all <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">0</span>)</span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-6"><a href="#cb136-6" aria-hidden="true" tabindex="-1"></a>delta.list <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.3</span>,<span class="fl">0.6</span>,<span class="fl">0.8</span>)</span>
<span id="cb136-7"><a href="#cb136-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (delta <span class="cf">in</span> delta.list) {</span>
<span id="cb136-8"><a href="#cb136-8" aria-hidden="true" tabindex="-1"></a>  pred <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(ycap <span class="sc">&gt;=</span> delta, <span class="dv">1</span> ,<span class="dv">0</span>)</span>
<span id="cb136-9"><a href="#cb136-9" aria-hidden="true" tabindex="-1"></a>  confusion.matrix <span class="ot">&lt;-</span> <span class="fu">table</span>(y, pred)</span>
<span id="cb136-10"><a href="#cb136-10" aria-hidden="true" tabindex="-1"></a>  tpr <span class="ot">&lt;-</span> confusion.matrix[<span class="dv">2</span>,<span class="dv">2</span>]<span class="sc">/</span><span class="fu">sum</span>(confusion.matrix[<span class="dv">2</span>,])</span>
<span id="cb136-11"><a href="#cb136-11" aria-hidden="true" tabindex="-1"></a>  fpr <span class="ot">&lt;-</span> confusion.matrix[<span class="dv">1</span>,<span class="dv">2</span>]<span class="sc">/</span><span class="fu">sum</span>(confusion.matrix[<span class="dv">1</span>,])</span>
<span id="cb136-12"><a href="#cb136-12" aria-hidden="true" tabindex="-1"></a>  tpr.all <span class="ot">&lt;-</span> <span class="fu">append</span>(tpr.all, tpr)</span>
<span id="cb136-13"><a href="#cb136-13" aria-hidden="true" tabindex="-1"></a>  fpr.all <span class="ot">&lt;-</span> <span class="fu">append</span>(fpr.all, fpr)</span>
<span id="cb136-14"><a href="#cb136-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb136-15"><a href="#cb136-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-16"><a href="#cb136-16" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tpr.all <span class="sc">~</span> fpr.all, <span class="at">type =</span> <span class="st">"n"</span>, <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb136-17"><a href="#cb136-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb136-18"><a href="#cb136-18" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb136-19"><a href="#cb136-19" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(tpr.all[<span class="dv">1</span>] <span class="sc">~</span> fpr.all[<span class="dv">1</span>], <span class="at">pch =</span> <span class="dv">15</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb136-20"><a href="#cb136-20" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(tpr.all[<span class="dv">2</span>] <span class="sc">~</span> fpr.all[<span class="dv">2</span>], <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb136-21"><a href="#cb136-21" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(tpr.all[<span class="dv">3</span>] <span class="sc">~</span> fpr.all[<span class="dv">3</span>], <span class="at">pch =</span> <span class="dv">17</span>, <span class="at">col =</span> <span class="st">"green"</span>)</span>
<span id="cb136-22"><a href="#cb136-22" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="fl">0.7</span>,<span class="fl">0.4</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">"sigma = 0.3"</span>, <span class="st">"sigma = 0.6"</span>, <span class="st">"sigma = 0.8"</span>),</span>
<span id="cb136-23"><a href="#cb136-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span><span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"green"</span>), <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">15</span>,<span class="dv">16</span>,<span class="dv">17</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>(b) Can we add the two points (0,0) and (1,1) to the plot of <span class="math inline">\(TPR\)</span> against <span class="math inline">\(FPR\)</span> in part (a). Explain why or why not.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co"># If σ &gt; 0.9 then all test points have predicted ˆG = 0 (predicted as negative), </span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="co"># so TPR = FPR = 0.</span></span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a><span class="co"># If σ &lt; 0.1, then all test points have predicted ˆG = 1 (predicted as positive),</span></span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a><span class="co"># so TPR = FPR = 1.</span></span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Since there exist σ within the range from 0 to 1 for the two points to happen, </span></span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a><span class="co"># these two points can be added to the plot.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
<li><p>The CSV file <code>Caravan.csv</code> contains data on 5822 real customer records on caravan insurance purchase. This data set is owned and supplied by the Dutch data mining company, Sentient Machine Research, and is based on real world business data. Each record consists of 86 variables, containing socio-demographic data (variables 1-43) and product ownership (variables 44-86). Variable 86 (<code>Purchase</code>) indicates whether the customer purchased a caravan insurance policy. For this business, assume that the overall error rate (equivalently, the accuracy) is not of interest. Instead, the company wants to use the classier to predict who are the potential customers likely to purchase insurance. Then the metric precision will be important, since it relates the proportion of Individuals who will actually purchase the insurance, among the group of individuals who are predicted to purchase insurance.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>cara <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Caravan data.csv"</span>)</span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(cara, <span class="at">n =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  X MOSTYPE MAANTHUI MGEMOMV MGEMLEEF MOSHOOFD MGODRK MGODPR MGODOV MGODGE
1 1      33        1       3        2        8      0      5      1      3
2 2      37        1       2        2        8      1      4      1      4
  MRELGE MRELSA MRELOV MFALLEEN MFGEKIND MFWEKIND MOPLHOOG MOPLMIDD MOPLLAAG
1      7      0      2        1        2        6        1        2        7
2      6      2      2        0        4        5        0        5        4
  MBERHOOG MBERZELF MBERBOER MBERMIDD MBERARBG MBERARBO MSKA MSKB1 MSKB2 MSKC
1        1        0        1        2        5        2    1     1     2    6
2        0        0        0        5        0        4    0     2     3    5
  MSKD MHHUUR MHKOOP MAUT1 MAUT2 MAUT0 MZFONDS MZPART MINKM30 MINK3045 MINK4575
1    1      1      8     8     0     1       8      1       0        4        5
2    0      2      7     7     1     2       6      3       2        0        5
  MINK7512 MINK123M MINKGEM MKOOPKLA PWAPART PWABEDR PWALAND PPERSAUT PBESAUT
1        0        0       4        3       0       0       0        6       0
2        2        0       5        4       2       0       0        0       0
  PMOTSCO PVRAAUT PAANHANG PTRACTOR PWERKT PBROM PLEVEN PPERSONG PGEZONG
1       0       0        0        0      0     0      0        0       0
2       0       0        0        0      0     0      0        0       0
  PWAOREG PBRAND PZEILPL PPLEZIER PFIETS PINBOED PBYSTAND AWAPART AWABEDR
1       0      5       0        0      0       0        0       0       0
2       0      2       0        0      0       0        0       2       0
  AWALAND APERSAUT ABESAUT AMOTSCO AVRAAUT AAANHANG ATRACTOR AWERKT ABROM
1       0        1       0       0       0        0        0      0     0
2       0        0       0       0       0        0        0      0     0
  ALEVEN APERSONG AGEZONG AWAOREG ABRAND AZEILPL APLEZIER AFIETS AINBOED
1      0        0       0       0      1       0        0      0       0
2      0        0       0       0      1       0        0      0       0
  ABYSTAND Purchase
1        0       No
2        0       No</code></pre>
</div>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(cara)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   5822 obs. of  87 variables:
 $ X       : int  1 2 3 4 5 6 7 8 9 10 ...
 $ MOSTYPE : int  33 37 37 9 40 23 39 33 33 11 ...
 $ MAANTHUI: int  1 1 1 1 1 1 2 1 1 2 ...
 $ MGEMOMV : int  3 2 2 3 4 2 3 2 2 3 ...
 $ MGEMLEEF: int  2 2 2 3 2 1 2 3 4 3 ...
 $ MOSHOOFD: int  8 8 8 3 10 5 9 8 8 3 ...
 $ MGODRK  : int  0 1 0 2 1 0 2 0 0 3 ...
 $ MGODPR  : int  5 4 4 3 4 5 2 7 1 5 ...
 $ MGODOV  : int  1 1 2 2 1 0 0 0 3 0 ...
 $ MGODGE  : int  3 4 4 4 4 5 5 2 6 2 ...
 $ MRELGE  : int  7 6 3 5 7 0 7 7 6 7 ...
 $ MRELSA  : int  0 2 2 2 1 6 2 2 0 0 ...
 $ MRELOV  : int  2 2 4 2 2 3 0 0 3 2 ...
 $ MFALLEEN: int  1 0 4 2 2 3 0 0 3 2 ...
 $ MFGEKIND: int  2 4 4 3 4 5 3 5 3 2 ...
 $ MFWEKIND: int  6 5 2 4 4 2 6 4 3 6 ...
 $ MOPLHOOG: int  1 0 0 3 5 0 0 0 0 0 ...
 $ MOPLMIDD: int  2 5 5 4 4 5 4 3 1 4 ...
 $ MOPLLAAG: int  7 4 4 2 0 4 5 6 8 5 ...
 $ MBERHOOG: int  1 0 0 4 0 2 0 2 1 2 ...
 $ MBERZELF: int  0 0 0 0 5 0 0 0 1 0 ...
 $ MBERBOER: int  1 0 0 0 4 0 0 0 0 0 ...
 $ MBERMIDD: int  2 5 7 3 0 4 4 2 1 3 ...
 $ MBERARBG: int  5 0 0 1 0 2 1 5 8 3 ...
 $ MBERARBO: int  2 4 2 2 0 2 5 2 1 3 ...
 $ MSKA    : int  1 0 0 3 9 2 0 2 1 1 ...
 $ MSKB1   : int  1 2 5 2 0 2 1 1 1 2 ...
 $ MSKB2   : int  2 3 0 1 0 2 4 2 0 1 ...
 $ MSKC    : int  6 5 4 4 0 4 5 5 8 4 ...
 $ MSKD    : int  1 0 0 0 0 2 0 2 1 2 ...
 $ MHHUUR  : int  1 2 7 5 4 9 6 0 9 0 ...
 $ MHKOOP  : int  8 7 2 4 5 0 3 9 0 9 ...
 $ MAUT1   : int  8 7 7 9 6 5 8 4 5 6 ...
 $ MAUT2   : int  0 1 0 0 2 3 0 4 2 1 ...
 $ MAUT0   : int  1 2 2 0 1 3 1 2 3 2 ...
 $ MZFONDS : int  8 6 9 7 5 9 9 6 7 6 ...
 $ MZPART  : int  1 3 0 2 4 0 0 3 2 3 ...
 $ MINKM30 : int  0 2 4 1 0 5 4 2 7 2 ...
 $ MINK3045: int  4 0 5 5 0 2 3 5 2 3 ...
 $ MINK4575: int  5 5 0 3 9 3 3 3 1 3 ...
 $ MINK7512: int  0 2 0 0 0 0 0 0 0 1 ...
 $ MINK123M: int  0 0 0 0 0 0 0 0 0 0 ...
 $ MINKGEM : int  4 5 3 4 6 3 3 3 2 4 ...
 $ MKOOPKLA: int  3 4 4 4 3 3 5 3 3 7 ...
 $ PWAPART : int  0 2 2 0 0 0 0 0 0 2 ...
 $ PWABEDR : int  0 0 0 0 0 0 0 0 0 0 ...
 $ PWALAND : int  0 0 0 0 0 0 0 0 0 0 ...
 $ PPERSAUT: int  6 0 6 6 0 6 6 0 5 0 ...
 $ PBESAUT : int  0 0 0 0 0 0 0 0 0 0 ...
 $ PMOTSCO : int  0 0 0 0 0 0 0 0 0 0 ...
 $ PVRAAUT : int  0 0 0 0 0 0 0 0 0 0 ...
 $ PAANHANG: int  0 0 0 0 0 0 0 0 0 0 ...
 $ PTRACTOR: int  0 0 0 0 0 0 0 0 0 0 ...
 $ PWERKT  : int  0 0 0 0 0 0 0 0 0 0 ...
 $ PBROM   : int  0 0 0 0 0 0 0 3 0 0 ...
 $ PLEVEN  : int  0 0 0 0 0 0 0 0 0 0 ...
 $ PPERSONG: int  0 0 0 0 0 0 0 0 0 0 ...
 $ PGEZONG : int  0 0 0 0 0 0 0 0 0 0 ...
 $ PWAOREG : int  0 0 0 0 0 0 0 0 0 0 ...
 $ PBRAND  : int  5 2 2 2 6 0 0 0 0 3 ...
 $ PZEILPL : int  0 0 0 0 0 0 0 0 0 0 ...
 $ PPLEZIER: int  0 0 0 0 0 0 0 0 0 0 ...
 $ PFIETS  : int  0 0 0 0 0 0 0 0 0 0 ...
 $ PINBOED : int  0 0 0 0 0 0 0 0 0 0 ...
 $ PBYSTAND: int  0 0 0 0 0 0 0 0 0 0 ...
 $ AWAPART : int  0 2 1 0 0 0 0 0 0 1 ...
 $ AWABEDR : int  0 0 0 0 0 0 0 0 0 0 ...
 $ AWALAND : int  0 0 0 0 0 0 0 0 0 0 ...
 $ APERSAUT: int  1 0 1 1 0 1 1 0 1 0 ...
 $ ABESAUT : int  0 0 0 0 0 0 0 0 0 0 ...
 $ AMOTSCO : int  0 0 0 0 0 0 0 0 0 0 ...
 $ AVRAAUT : int  0 0 0 0 0 0 0 0 0 0 ...
 $ AAANHANG: int  0 0 0 0 0 0 0 0 0 0 ...
 $ ATRACTOR: int  0 0 0 0 0 0 0 0 0 0 ...
 $ AWERKT  : int  0 0 0 0 0 0 0 0 0 0 ...
 $ ABROM   : int  0 0 0 0 0 0 0 1 0 0 ...
 $ ALEVEN  : int  0 0 0 0 0 0 0 0 0 0 ...
 $ APERSONG: int  0 0 0 0 0 0 0 0 0 0 ...
 $ AGEZONG : int  0 0 0 0 0 0 0 0 0 0 ...
 $ AWAOREG : int  0 0 0 0 0 0 0 0 0 0 ...
 $ ABRAND  : int  1 1 1 1 1 0 0 0 0 1 ...
 $ AZEILPL : int  0 0 0 0 0 0 0 0 0 0 ...
 $ APLEZIER: int  0 0 0 0 0 0 0 0 0 0 ...
 $ AFIETS  : int  0 0 0 0 0 0 0 0 0 0 ...
 $ AINBOED : int  0 0 0 0 0 0 0 0 0 0 ...
 $ ABYSTAND: int  0 0 0 0 0 0 0 0 0 0 ...
 $ Purchase: chr  "No" "No" "No" "No" ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(cara)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5822   87</code></pre>
</div>
</div>
<p>(a) Without any classier, if the company tries to sell insurance to a random selection of customers, what is the success rate?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(cara<span class="sc">$</span>Purchase)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  No  Yes 
5474  348 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>succesRate <span class="ot">&lt;-</span> <span class="fu">table</span>(cara<span class="sc">$</span>Purchase)[<span class="dv">2</span>]<span class="sc">/</span><span class="fu">sum</span>(<span class="fu">table</span>(cara<span class="sc">$</span>Purchase))</span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>succesRate</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Yes 
0.05977327 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="co"># data set shows almost 6% of people purchased insurance</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(b) Standardize the input features. <span class="math inline">\(Hint\)</span>: Use <code>scale()</code> command in R.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>cara <span class="ot">&lt;-</span> cara[,<span class="sc">-</span><span class="dv">1</span>] <span class="co">#throwing the first column since it provides no information</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>scaled.X <span class="ot">&lt;-</span> <span class="fu">scale</span>(cara[,<span class="sc">-</span><span class="dv">86</span>]) <span class="co">#throwing the response column</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(c) Randomly select 1000 observations to form the test data, and the remaining observations will be the training data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">99</span>)</span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">dim</span>(cara)[<span class="dv">1</span>] <span class="co">#train data number</span></span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a>shuffled.index <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>n), <span class="at">size =</span> <span class="dv">2000</span>)</span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a>X.train <span class="ot">&lt;-</span> scaled.X[<span class="sc">-</span>shuffled.index,]</span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a>X.test<span class="ot">&lt;-</span> scaled.X[shuffled.index,]</span>
<span id="cb150-6"><a href="#cb150-6" aria-hidden="true" tabindex="-1"></a>Y.train <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(cara<span class="sc">$</span>Purchase[<span class="sc">-</span>shuffled.index])</span>
<span id="cb150-7"><a href="#cb150-7" aria-hidden="true" tabindex="-1"></a>Y.test <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(cara<span class="sc">$</span>Purchase[shuffled.index])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(d) Use 1-nearest neighbor classier for the training data to predict if a customer will purchase insurance. Compute the precision of the classier.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(class)</span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">knn</span>(X.train, X.test, Y.train, <span class="at">k=</span><span class="dv">1</span>)</span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a>confusion.matrix <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, pred) </span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Precision = TP/TP+FP</span></span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> confusion.matrix[<span class="dv">2</span>,<span class="dv">2</span>]<span class="sc">/</span><span class="fu">sum</span>(confusion.matrix[,<span class="dv">2</span>])</span>
<span id="cb151-7"><a href="#cb151-7" aria-hidden="true" tabindex="-1"></a>confusion.matrix</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      pred
Y.test   No  Yes
   No  1761  121
   Yes  101   17</code></pre>
</div>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>precision</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1231884</code></pre>
</div>
</div>
<p>(e) Repeat question 3d, for k-nearest neighbor classier where k = 3,5,10. Which value of k gives the best precision?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>precision.all <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>k.list <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> k.list) {</span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>  pred <span class="ot">&lt;-</span> <span class="fu">knn</span>(X.train, X.test, Y.train, <span class="at">k =</span> k)</span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a>  confusion.matrix <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, pred) </span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Precision = TP/TP+FP</span></span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a>  precision <span class="ot">&lt;-</span> confusion.matrix[<span class="dv">2</span>,<span class="dv">2</span>]<span class="sc">/</span><span class="fu">sum</span>(confusion.matrix[,<span class="dv">2</span>])</span>
<span id="cb155-8"><a href="#cb155-8" aria-hidden="true" tabindex="-1"></a>  precision.all <span class="ot">&lt;-</span> <span class="fu">rbind</span>(precision.all, <span class="fu">data.frame</span>(k, precision))</span>
<span id="cb155-9"><a href="#cb155-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb155-10"><a href="#cb155-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-11"><a href="#cb155-11" aria-hidden="true" tabindex="-1"></a>precision.all</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   k precision
1  3 0.2285714
2  5 0.3571429
3 10 0.0000000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="co"># So far, k = 5 gives the best precision.</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a><span class="co"># However, one might use N -fold cross validation </span></span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a><span class="co"># to have the average precision for each k.</span></span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a><span class="co"># With that, the value of k that gives largest average precision is chosen.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
</ol>
</section>
<section id="onsite-questions-4" class="level4">
<h4 class="anchored" data-anchor-id="onsite-questions-4">Onsite Questions</h4>
<p>COMING SOON</p>
</section>
</section>
<section id="tutorial-6-knn-decision-tree" class="level2">
<h2 class="anchored" data-anchor-id="tutorial-6-knn-decision-tree">Tutorial 6 (KNN &amp; Decision Tree)</h2>
<section id="offsite-questions-5" class="level4">
<h4 class="anchored" data-anchor-id="offsite-questions-5">Offsite Questions</h4>
<ol type="1">
<li><p><em>(KNN and N -fold Cross Validation)</em></p>
<p>Loan managers often need to take into account an applicant’s demographic and socioeconomic proles in deciding whether to approve a loan to the applicant, to minimize losses due to defaults. In this exercise we will build and evaluate a classier based on the German Credit Data to predict whether an applicant is considered as having good or bad credit risk. The features or predictors include (1) loan duration (in months), (2) credit amount, (3) Installment rate in percentage of disposable income and (4) age in years.</p>
<p>(a) Read and explore the data from the file <code>German_credit.csv</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"German credit.csv"</span>)</span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Creditability Duration Amount Instalment Age
1             1       18   1049          4  21
2             1        9   2799          2  36
3             1       12    841          2  23
4             1       12   2122          3  39
5             1       12   2171          4  38
6             1       10   2241          1  48</code></pre>
</div>
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   1000 obs. of  5 variables:
 $ Creditability: int  1 1 1 1 1 1 1 1 1 1 ...
 $ Duration     : int  18 9 12 12 12 10 8 6 18 24 ...
 $ Amount       : int  1049 2799 841 2122 2171 2241 3398 1361 1098 3758 ...
 $ Instalment   : int  4 2 2 3 4 1 1 2 4 1 ...
 $ Age          : int  21 36 23 39 38 48 39 40 65 23 ...</code></pre>
</div>
</div>
<p>(b) Standardize the input features.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">scale</span>(data[<span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> data<span class="sc">$</span>Creditability</span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(X)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Duration     Amount  Instalment         Age
[1,] -0.2407368 -0.7872630  0.91801781 -1.28093214
[2,] -0.9870788 -0.1673006 -0.86974813  0.04034293
[3,] -0.7382981 -0.8609500 -0.86974813 -1.10476213
[4,] -0.7382981 -0.4071375  0.02413484  0.30459795
[5,] -0.7382981 -0.3897785  0.91801781  0.21651294
[6,] -0.9041519 -0.3649800 -1.76363111  1.09736299</code></pre>
</div>
</div>
<p>(c) Randomly select 800 customer records to form the training data, and the remaining 200 records will be the test data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">dim</span>(data)[<span class="dv">1</span>]</span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a>index <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="dv">800</span>)</span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-5"><a href="#cb164-5" aria-hidden="true" tabindex="-1"></a>training.X <span class="ot">&lt;-</span> X[index, ]</span>
<span id="cb164-6"><a href="#cb164-6" aria-hidden="true" tabindex="-1"></a>test.X <span class="ot">&lt;-</span> X[<span class="sc">-</span>index, ]</span>
<span id="cb164-7"><a href="#cb164-7" aria-hidden="true" tabindex="-1"></a>training.Y <span class="ot">&lt;-</span> Y[index]</span>
<span id="cb164-8"><a href="#cb164-8" aria-hidden="true" tabindex="-1"></a>test.Y <span class="ot">&lt;-</span> Y[<span class="sc">-</span>index]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(d) Use 1-nearest neighbor classier for the training data to predict if a loan applicant is credible for the 200 test points. Compute the accuracy of the classier.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(class)</span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">knn</span>(training.X, test.X, training.Y, <span class="at">k=</span><span class="dv">1</span>)</span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a>confusion.matrix <span class="ot">&lt;-</span> <span class="fu">table</span>(test.Y, pred)</span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a>confusion.matrix</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      pred
test.Y  0  1
     0 24 35
     1 47 94</code></pre>
</div>
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a>accuracy <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">diag</span>(confusion.matrix))<span class="sc">/</span><span class="fu">sum</span>(confusion.matrix)</span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>accuracy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.59</code></pre>
</div>
</div>
<p>(e) Use N -folds cross validation with N = 5 to find the average accuracy for the 1-nearest neighbor classifier.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(class)</span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"German credit.csv"</span>)</span>
<span id="cb169-5"><a href="#cb169-5" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">scale</span>(data[<span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb169-6"><a href="#cb169-6" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> data<span class="sc">$</span>Creditability</span>
<span id="cb169-7"><a href="#cb169-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-8"><a href="#cb169-8" aria-hidden="true" tabindex="-1"></a>n_folds <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb169-9"><a href="#cb169-9" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(Y)</span>
<span id="cb169-10"><a href="#cb169-10" aria-hidden="true" tabindex="-1"></a>folds_j <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n_folds, <span class="at">length.out =</span> n ))</span>
<span id="cb169-11"><a href="#cb169-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-12"><a href="#cb169-12" aria-hidden="true" tabindex="-1"></a>accuracy <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_folds)</span>
<span id="cb169-13"><a href="#cb169-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_folds) {</span>
<span id="cb169-14"><a href="#cb169-14" aria-hidden="true" tabindex="-1"></a>  test_j <span class="ot">&lt;-</span> <span class="fu">which</span>(folds_j <span class="sc">==</span> j) </span>
<span id="cb169-15"><a href="#cb169-15" aria-hidden="true" tabindex="-1"></a>  test.y <span class="ot">&lt;-</span> Y[test_j] </span>
<span id="cb169-16"><a href="#cb169-16" aria-hidden="true" tabindex="-1"></a>  train.X <span class="ot">&lt;-</span> X[<span class="sc">-</span>test_j, ]  </span>
<span id="cb169-17"><a href="#cb169-17" aria-hidden="true" tabindex="-1"></a>  test.X <span class="ot">&lt;-</span> X[test_j, ]  </span>
<span id="cb169-18"><a href="#cb169-18" aria-hidden="true" tabindex="-1"></a>  train.y <span class="ot">&lt;-</span> Y[<span class="sc">-</span>test_j] </span>
<span id="cb169-19"><a href="#cb169-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-20"><a href="#cb169-20" aria-hidden="true" tabindex="-1"></a>  knn.pred <span class="ot">&lt;-</span> <span class="fu">knn</span>(train.X, test.X, train.y, <span class="at">k =</span> <span class="dv">1</span>) </span>
<span id="cb169-21"><a href="#cb169-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-22"><a href="#cb169-22" aria-hidden="true" tabindex="-1"></a>  confusion.matrix <span class="ot">&lt;-</span> <span class="fu">table</span>(test.y, knn.pred)</span>
<span id="cb169-23"><a href="#cb169-23" aria-hidden="true" tabindex="-1"></a>  accuracy[j] <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">diag</span>(confusion.matrix))<span class="sc">/</span><span class="fu">sum</span>(confusion.matrix)</span>
<span id="cb169-24"><a href="#cb169-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb169-25"><a href="#cb169-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-26"><a href="#cb169-26" aria-hidden="true" tabindex="-1"></a>ave.accuracy <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">mean</span>(accuracy), <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb169-27"><a href="#cb169-27" aria-hidden="true" tabindex="-1"></a>ave.accuracy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.622</code></pre>
</div>
</div>
<p>(f) Repeat question 1e for K-nearest neighbor classifiers where K = 1, 2, …100.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="do">### FULL KNN WITH N-FOLDS VALIDATION</span></span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(class)</span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-5"><a href="#cb171-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"German credit.csv"</span>)</span>
<span id="cb171-6"><a href="#cb171-6" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">scale</span>(data[<span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb171-7"><a href="#cb171-7" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> data<span class="sc">$</span>Creditability</span>
<span id="cb171-8"><a href="#cb171-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-9"><a href="#cb171-9" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb171-10"><a href="#cb171-10" aria-hidden="true" tabindex="-1"></a>n_folds <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb171-11"><a href="#cb171-11" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(Y)</span>
<span id="cb171-12"><a href="#cb171-12" aria-hidden="true" tabindex="-1"></a>folds_j <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n_folds, <span class="at">length.out =</span> n ))</span>
<span id="cb171-13"><a href="#cb171-13" aria-hidden="true" tabindex="-1"></a>ave.accuracy <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(k))</span>
<span id="cb171-14"><a href="#cb171-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-15"><a href="#cb171-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb171-16"><a href="#cb171-16" aria-hidden="true" tabindex="-1"></a>  accuracy <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_folds)</span>
<span id="cb171-17"><a href="#cb171-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_folds) {</span>
<span id="cb171-18"><a href="#cb171-18" aria-hidden="true" tabindex="-1"></a>    test_j <span class="ot">&lt;-</span> <span class="fu">which</span>(folds_j <span class="sc">==</span> j) </span>
<span id="cb171-19"><a href="#cb171-19" aria-hidden="true" tabindex="-1"></a>    test.y <span class="ot">&lt;-</span> Y[test_j] </span>
<span id="cb171-20"><a href="#cb171-20" aria-hidden="true" tabindex="-1"></a>    train.X <span class="ot">&lt;-</span> X[<span class="sc">-</span>test_j, ]  </span>
<span id="cb171-21"><a href="#cb171-21" aria-hidden="true" tabindex="-1"></a>    test.X <span class="ot">&lt;-</span> X[test_j, ]  </span>
<span id="cb171-22"><a href="#cb171-22" aria-hidden="true" tabindex="-1"></a>    train.y <span class="ot">&lt;-</span> Y[<span class="sc">-</span>test_j] </span>
<span id="cb171-23"><a href="#cb171-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-24"><a href="#cb171-24" aria-hidden="true" tabindex="-1"></a>    knn.pred <span class="ot">&lt;-</span> <span class="fu">knn</span>(train.X, test.X, train.y, <span class="at">k =</span> i) </span>
<span id="cb171-25"><a href="#cb171-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-26"><a href="#cb171-26" aria-hidden="true" tabindex="-1"></a>    confusion.matrix<span class="ot">=</span><span class="fu">table</span>(test.y, knn.pred)</span>
<span id="cb171-27"><a href="#cb171-27" aria-hidden="true" tabindex="-1"></a>    accuracy[j] <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">diag</span>(confusion.matrix))<span class="sc">/</span><span class="fu">sum</span>(confusion.matrix)</span>
<span id="cb171-28"><a href="#cb171-28" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb171-29"><a href="#cb171-29" aria-hidden="true" tabindex="-1"></a>  ave.accuracy[i] <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">mean</span>(accuracy), <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb171-30"><a href="#cb171-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb171-31"><a href="#cb171-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-32"><a href="#cb171-32" aria-hidden="true" tabindex="-1"></a>ave.accuracy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] 0.622 0.597 0.661 0.674 0.684 0.671 0.676 0.686 0.686 0.691 0.702 0.699
 [13] 0.705 0.702 0.707 0.695 0.699 0.702 0.700 0.693 0.695 0.695 0.697 0.695
 [25] 0.699 0.697 0.696 0.700 0.693 0.688 0.697 0.692 0.697 0.698 0.697 0.692
 [37] 0.695 0.695 0.695 0.696 0.696 0.701 0.699 0.701 0.699 0.699 0.699 0.698
 [49] 0.699 0.696 0.698 0.699 0.699 0.696 0.695 0.699 0.696 0.697 0.696 0.698
 [61] 0.697 0.696 0.699 0.697 0.697 0.697 0.697 0.696 0.698 0.699 0.699 0.696
 [73] 0.698 0.697 0.698 0.696 0.698 0.698 0.698 0.699 0.699 0.698 0.698 0.700
 [85] 0.698 0.698 0.700 0.700 0.699 0.700 0.700 0.701 0.701 0.701 0.700 0.700
 [97] 0.699 0.698 0.699 0.699</code></pre>
</div>
</div>
<p>(g) Compare the 100 classifiers above, which few values of K give the best average accuracy?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glue)</span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a>index <span class="ot">=</span> <span class="fu">which</span>(ave.accuracy <span class="sc">==</span> <span class="fu">max</span>(ave.accuracy))</span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span>k, ave.accuracy)</span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> index, <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-62-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glue</span>(<span class="st">"most accurate k = {index} with average accuracy = {ave.accuracy[index]}"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>most accurate k = 15 with average accuracy = 0.707</code></pre>
</div>
</div></li>
<li><p><em>(Decision Trees)</em></p>
<p>Consider the famous Iris Flower Data set which was rst introduced in 1936 by the famous statistician Ronald Fisher. This data set consists of 50 observations from each of three species of Iris (Iris setosa, Iris virginica and Iris versicolor). Four features were measured from each observation: the length and the width of the sepals and petals (in cm).</p>
<p><img src="images/clipboard-1563154089.png" class="img-fluid"></p>
<p>(a) Use decision tree method to predict Iris species based on all four features.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a>iris <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Iris dataset.csv"</span>)</span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(iris)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  sepal.length sepal.width petal.length petal.width       class
1          5.1         3.5          1.4         0.2 Iris-setosa
2          4.9         3.0          1.4         0.2 Iris-setosa
3          4.7         3.2          1.3         0.2 Iris-setosa
4          4.6         3.1          1.5         0.2 Iris-setosa
5          5.0         3.6          1.4         0.2 Iris-setosa
6          5.4         3.9          1.7         0.4 Iris-setosa</code></pre>
</div>
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(iris)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   150 obs. of  5 variables:
 $ sepal.length: num  5.1 4.9 4.7 4.6 5 5.4 4.6 5 4.4 4.9 ...
 $ sepal.width : num  3.5 3 3.2 3.1 3.6 3.9 3.4 3.4 2.9 3.1 ...
 $ petal.length: num  1.4 1.4 1.3 1.5 1.4 1.7 1.4 1.5 1.4 1.5 ...
 $ petal.width : num  0.2 0.2 0.2 0.2 0.2 0.4 0.3 0.2 0.2 0.1 ...
 $ class       : chr  "Iris-setosa" "Iris-setosa" "Iris-setosa" "Iris-setosa" ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(iris)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 150   5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart)</span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">rpart</span>(class <span class="sc">~</span> sepal.length <span class="sc">+</span> sepal.width <span class="sc">+</span> petal.length <span class="sc">+</span> petal.width,</span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> iris,</span>
<span id="cb182-4"><a href="#cb182-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">method=</span><span class="st">"class"</span>,</span>
<span id="cb182-5"><a href="#cb182-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">parms=</span><span class="fu">list</span>(<span class="at">split=</span><span class="st">'information'</span>),</span>
<span id="cb182-6"><a href="#cb182-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">control =</span> <span class="fu">rpart.control</span>( <span class="at">minsplit =</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(b) Visualize the decision tree above, using the <code>rpart.plot</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart.plot)</span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rpart.plot</span>(fit, <span class="at">type=</span><span class="dv">4</span>, <span class="at">extra=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-64-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The fitted tree is given in the figure below.</span></span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a><span class="co"># If the measurement of petal length is less than 2.5 cm </span></span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true" tabindex="-1"></a><span class="co"># then the flower is of Iris-setosa</span></span>
<span id="cb184-4"><a href="#cb184-4" aria-hidden="true" tabindex="-1"></a><span class="co"># If the petal length is ≥ 2.5 cm with the petal width is ≥ 1.8 cm </span></span>
<span id="cb184-5"><a href="#cb184-5" aria-hidden="true" tabindex="-1"></a><span class="co"># then high chance (45/46) it will be an Iris-virginica.</span></span>
<span id="cb184-6"><a href="#cb184-6" aria-hidden="true" tabindex="-1"></a><span class="co"># If the petal length is ≥ 2.5 cm with the petal width is &lt; 1.8 cm</span></span>
<span id="cb184-7"><a href="#cb184-7" aria-hidden="true" tabindex="-1"></a><span class="co"># then we continue to check if the petal length is in the interval</span></span>
<span id="cb184-8"><a href="#cb184-8" aria-hidden="true" tabindex="-1"></a><span class="co"># [2.5, 5]. If yes, then high chance (47/48) it is Iris-versicolor.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(c) What are the more important features in the fitted tree above?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="co"># It seems the sepal length and sepal width </span></span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a><span class="co"># are not important in the classification while</span></span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a><span class="co"># the petal length and petal width are more important.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
</ol>
<hr>
</section>
</section>
</section>
<section id="past-year-papers" class="level1">
<h1>Past Year Papers</h1>
<section id="y2223-s2" class="level2">
<h2 class="anchored" data-anchor-id="y2223-s2">Y(22/23) S2</h2>
<section id="questions-1-50-points" class="level3">
<h3 class="anchored" data-anchor-id="questions-1-50-points">Questions 1 <em>(50 points)</em></h3>
<p>A study of nesting horseshoe crabs (J. Rrockmann, Ethology, 102: 1-21, 1996) collected data on 173 female horseshoe crabs. Explanatory variables included the female crab’s <code>color</code> (2,3,4 and 5 which increases when the darkness increases), spine condition, <code>weight</code> (kg), and carapace <code>width</code> (cm).</p>
<p>Variable <code>satell</code> indicates the number of male crab (called satellite) attached to the female crabs (for example, the first crab has 8 satellites attached to it). In this problem, we are interested in the possible factors like <code>color</code>, <code>weight</code> and <code>width</code> that may affect the number of satellites attach to a female crab.</p>
<p>Data are given in the file <code>data1.txt</code>.</p>
<p>Import the given data into <strong>R</strong> and keep all the variable names as original.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a>data<span class="ot">&lt;-</span><span class="fu">read.table</span>(<span class="st">'data1.txt'</span>, <span class="at">header=</span>T) </span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  color spine width satell weight
1     3     3  28.3      8   3.05
2     4     3  22.5      0   1.55
3     2     1  26.0      9   2.30
4     4     3  24.8      0   2.10
5     4     3  26.0      4   2.60
6     3     3  23.8      0   2.10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 173   5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "color"  "spine"  "width"  "satell" "weight"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from data (pos = 7):

    color, satell, spine, weight, width</code></pre>
</div>
</div>
<p><strong>Part I</strong>: Exploring the response variable - <code>satell</code></p>
<ol type="1">
<li><p>Create a histogram of this variable with a normal density curve overlaying. Give your comment about this plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(satell, <span class="at">probability =</span> <span class="cn">TRUE</span>, </span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Histogram of Satell with Normal Density Curve"</span>,</span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Number of Satellites"</span>, <span class="at">col =</span> <span class="st">"lightblue"</span>, <span class="at">border =</span> <span class="st">"black"</span>)</span>
<span id="cb194-4"><a href="#cb194-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5"><a href="#cb194-5" aria-hidden="true" tabindex="-1"></a>x_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(satell), <span class="fu">max</span>(satell), <span class="at">length =</span> <span class="dv">100</span>)</span>
<span id="cb194-6"><a href="#cb194-6" aria-hidden="true" tabindex="-1"></a>y_values <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(x_values, <span class="at">mean =</span> <span class="fu">mean</span>(satell), <span class="at">sd =</span> <span class="fu">sd</span>(satell))</span>
<span id="cb194-7"><a href="#cb194-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x_values, y_values, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-67-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Comments:</span></span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a><span class="co"># The histogram of the satell variable shows values ranging from 0 to 15, </span></span>
<span id="cb195-3"><a href="#cb195-3" aria-hidden="true" tabindex="-1"></a><span class="co"># with a single peak (unimodal) where most of the data is concentrated around 1. </span></span>
<span id="cb195-4"><a href="#cb195-4" aria-hidden="true" tabindex="-1"></a><span class="co"># The distribution is clearly right-skewed, no gap.</span></span>
<span id="cb195-5"><a href="#cb195-5" aria-hidden="true" tabindex="-1"></a><span class="co"># There are a few suspected outliers on the far right, with values around 15.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
<li><p>Create a box plot of this variable. Does it show any outliers? If yes, retrieve the full information (full row) of the crabs that are outliers in number of satellites. Copy the information and paste into R code file as comments.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(satell)</span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">boxplot</span>(satell)<span class="sc">$</span>out; out</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-68-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 14 15</code></pre>
</div>
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a>index <span class="ot">&lt;-</span> <span class="fu">which</span>(satell <span class="sc">%in%</span> out)</span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a>data[index,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   color spine width satell weight
15     3     1  26.0     14    2.3
56     3     3  28.3     15    3.0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="co"># There are two outliers, as following:</span></span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a><span class="co"># color spine width satell weight</span></span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 15     3     1  26.0     14    2.3</span></span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 56     3     3  28.3     15    3.0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
<li><p>Create a qq plot of this variable. Give your comment about this plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb201"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(satell,  <span class="at">pch =</span> <span class="dv">20</span>)</span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(satell, <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-69-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Comments:</span></span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Observed values on the left are clearly higher then the expected values,</span></span>
<span id="cb202-3"><a href="#cb202-3" aria-hidden="true" tabindex="-1"></a><span class="co"># meaning the data has shorter left tail.</span></span>
<span id="cb202-4"><a href="#cb202-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Hence, satell data is not normally distributed</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
</ol>
<p><strong>Part II</strong>: Variable color</p>
<ol start="4" type="1">
<li><p>Write the code to create a new categorical variable, <code>col</code>, which equals to light if the crab has color 2 or 3, and equals to dark if the crab has color 4 or 5.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>col <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(satell))</span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>col[<span class="fu">which</span>(color <span class="sc">&lt;=</span> <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="st">"light"</span></span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>col[<span class="fu">which</span>(color <span class="sc">&gt;</span> <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="st">"dark"</span></span>
<span id="cb203-4"><a href="#cb203-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-5"><a href="#cb203-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  color spine width satell weight   col
1     3     3  28.3      8   3.05 light
2     4     3  22.5      0   1.55  dark
3     2     1  26.0      9   2.30 light
4     4     3  24.8      0   2.10  dark
5     4     3  26.0      4   2.60  dark
6     3     3  23.8      0   2.10 light</code></pre>
</div>
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from data (pos = 3):

    color, satell, spine, weight, width</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from data (pos = 8):

    color, satell, spine, weight, width</code></pre>
</div>
</div></li>
<li><p>Create a frequency table for variable <code>col</code> created above. How many crabs are of light color and how many crabs are of dark color?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(col)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>col
 dark light 
   66   107 </code></pre>
</div>
</div></li>
<li><p>Plot a scatter plot of <code>weight</code> and <code>satell</code>, classified by <code>col</code>. Add a legend box for this plot. Give your comment about this plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(satell <span class="sc">~</span> weight, </span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">"n"</span>,</span>
<span id="cb210-3"><a href="#cb210-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Weight"</span>,</span>
<span id="cb210-4"><a href="#cb210-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"Satell"</span>, </span>
<span id="cb210-5"><a href="#cb210-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Crab Data"</span>)</span>
<span id="cb210-6"><a href="#cb210-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb210-7"><a href="#cb210-7" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(satell[col <span class="sc">==</span> <span class="st">"light"</span>] <span class="sc">~</span> weight[col <span class="sc">==</span> <span class="st">"light"</span>], <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb210-8"><a href="#cb210-8" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(satell[col <span class="sc">==</span> <span class="st">"dark"</span>] <span class="sc">~</span> weight[col <span class="sc">==</span> <span class="st">"dark"</span>], <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb210-9"><a href="#cb210-9" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="fl">4.5</span>, <span class="dv">15</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">"light"</span>, <span class="st">"dark"</span>),<span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>), <span class="at">pch =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-72-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Comments:</span></span>
<span id="cb211-2"><a href="#cb211-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Overall, weight and satell has (quiet weak) POSITIVE</span></span>
<span id="cb211-3"><a href="#cb211-3" aria-hidden="true" tabindex="-1"></a><span class="co"># and possibily LINEAR relationship.</span></span>
<span id="cb211-4"><a href="#cb211-4" aria-hidden="true" tabindex="-1"></a><span class="co"># For light color or for dark color, the relationship between satell and weight</span></span>
<span id="cb211-5"><a href="#cb211-5" aria-hidden="true" tabindex="-1"></a><span class="co"># are about similar, no clear difference</span></span>
<span id="cb211-6"><a href="#cb211-6" aria-hidden="true" tabindex="-1"></a><span class="co"># as weight changes, the variability of satell gets larger</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
</ol>
<p><strong>Part III</strong>: Modelling</p>
<ol start="7" type="1">
<li><p>Fit a linear regression model for <code>satell</code> using three features <code>color</code>, <code>weight</code> and <code>width</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>color <span class="ot">=</span> <span class="fu">as.factor</span>(data<span class="sc">$</span>color)</span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a>M <span class="ot">=</span> <span class="fu">lm</span>(satell <span class="sc">~</span> color <span class="sc">+</span> weight <span class="sc">+</span> width, <span class="at">data =</span> data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
<li><p>Report the value of <span class="math inline">\(R^2\)</span> of the model above. Give your comments on the goodness-of-fit of the model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = satell ~ color + weight + width, data = data)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.5238 -2.1270 -0.6765  1.5393 11.1459 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept) -1.85827    4.51379  -0.412    0.681  
color3      -0.61976    0.90368  -0.686    0.494  
color4      -1.23133    0.96969  -1.270    0.206  
color5      -1.17540    1.07476  -1.094    0.276  
weight       1.68797    0.84358   2.001    0.047 *
width        0.05576    0.23188   0.240    0.810  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.947 on 167 degrees of freedom
Multiple R-squared:  0.1492,    Adjusted R-squared:  0.1237 
F-statistic: 5.857 on 5 and 167 DF,  p-value: 5.168e-05</code></pre>
</div>
<div class="sourceCode cell-code" id="cb215"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Comments:</span></span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a><span class="co"># R^2 = 0.1492</span></span>
<span id="cb215-3"><a href="#cb215-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Though F-test for the significance of the overall  model: model is significant</span></span>
<span id="cb215-4"><a href="#cb215-4" aria-hidden="true" tabindex="-1"></a><span class="co"># However, R^2 is too low. It means model doesn't fit the data well.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
</ol>
</section>
<section id="questions-2-30-points" class="level3">
<h3 class="anchored" data-anchor-id="questions-2-30-points">Questions 2 <em>(30 points)</em></h3>
<p>A data set <code>data2.csv</code> contains cases from a study that was conducted between 1958 and 1970 at the University of Chicago’s Billings Hospital on the survival of patients who had undergone surgery for breast cancer.</p>
<p>A table of variable description is given below. <code>status</code> is the response in this study.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 18%">
<col style="width: 81%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Variable</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">age</td>
<td>age of patient at which they undergone surgery</td>
</tr>
<tr class="even">
<td style="text-align: left;">year</td>
<td>year in which patient was undergone surgery (1958 - 1969)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">node</td>
<td>number of lymph nodes that have cancer cells detected</td>
</tr>
<tr class="even">
<td style="text-align: left;">status</td>
<td><p>1 = the patient survived 5 years or longer (negative); and</p>
<p>2 = the patient died within 5 years (positive)</p></td>
</tr>
</tbody>
</table>
<p>For this problem, we will not consider the year when patient was undergone the surgery, <code>year</code>, as a feature for classification.</p>
<p>In R, use <code>set.seed(999)</code>.</p>
<p>We would:</p>
<ul>
<li><p>Use KNN algorithm where K can be any positive integers, from 1 up to 50, to form classifiers to predict the outcome.</p></li>
<li><p>For each classier, evaluate it’s performance by 3-fold cross validation.</p></li>
<li><p>Use type I error rate and type II error rate as the measures to evaluate each classifiers.</p></li>
<li><p>Select the best K.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">999</span>)</span>
<span id="cb216-2"><a href="#cb216-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb216-3"><a href="#cb216-3" aria-hidden="true" tabindex="-1"></a>hab <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'data2.csv'</span>)</span>
<span id="cb216-4"><a href="#cb216-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(hab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  age year node survival.status
1  30   64    1               1
2  30   62    3               1
3  30   65    0               1
4  31   59    2               1
5  31   65    4               1
6  33   58   10               1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(hab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 306   4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(hab)[<span class="dv">4</span>] <span class="ot">=</span> <span class="st">"status"</span></span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-3"><a href="#cb220-3" aria-hidden="true" tabindex="-1"></a>hab<span class="sc">$</span>status <span class="ot">=</span> <span class="fu">as.factor</span>(hab<span class="sc">$</span>status)</span>
<span id="cb220-4"><a href="#cb220-4" aria-hidden="true" tabindex="-1"></a>hab[, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>] <span class="ot">=</span> <span class="fu">lapply</span>(hab[ , <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>],scale) <span class="co"># SCALING THE FEATURES</span></span>
<span id="cb220-5"><a href="#cb220-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb220-6"><a href="#cb220-6" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(hab)</span>
<span id="cb220-7"><a href="#cb220-7" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(status)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>status
  1   2 
225  81 </code></pre>
</div>
</div></li>
</ul>
<ol type="1">
<li><p>Write the code for the purposes above. For each classier, the average of Type I error rates from 3-fold cross validation is saved in a vector, (named <code>ave.type1</code>); and the average of Type II error rates is saved in another vector (named <code>ave.type2</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(class)</span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-3"><a href="#cb222-3" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> hab[, <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)] <span class="co"># we do not use the 2nd column, year.</span></span>
<span id="cb222-4"><a href="#cb222-4" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> hab[, <span class="dv">4</span>] <span class="co"># response</span></span>
<span id="cb222-5"><a href="#cb222-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-6"><a href="#cb222-6" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(Y) <span class="co"># sample size</span></span>
<span id="cb222-7"><a href="#cb222-7" aria-hidden="true" tabindex="-1"></a>n_folds <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb222-8"><a href="#cb222-8" aria-hidden="true" tabindex="-1"></a>folds_j <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n_folds, <span class="at">length.out =</span> n ))</span>
<span id="cb222-9"><a href="#cb222-9" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(folds_j)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>folds_j
  1   2   3 
102 102 102 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a>K <span class="ot">=</span> <span class="dv">50</span></span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a>ave.type1 <span class="ot">=</span> <span class="fu">numeric</span>(K) <span class="co"># to store the accuracy for each k of KNN, k is from 1 to K = 50.</span></span>
<span id="cb224-3"><a href="#cb224-3" aria-hidden="true" tabindex="-1"></a>ave.type2 <span class="ot">=</span> <span class="fu">numeric</span>(K) <span class="co"># to store the precision for each k of KNN</span></span>
<span id="cb224-4"><a href="#cb224-4" aria-hidden="true" tabindex="-1"></a>type1<span class="ot">=</span><span class="fu">numeric</span>(n_folds)</span>
<span id="cb224-5"><a href="#cb224-5" aria-hidden="true" tabindex="-1"></a>type2<span class="ot">=</span><span class="fu">numeric</span>(n_folds)</span>
<span id="cb224-6"><a href="#cb224-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-7"><a href="#cb224-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>K) {</span>
<span id="cb224-8"><a href="#cb224-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_folds) {</span>
<span id="cb224-9"><a href="#cb224-9" aria-hidden="true" tabindex="-1"></a>    test_j <span class="ot">&lt;-</span> <span class="fu">which</span>(folds_j <span class="sc">==</span> j) <span class="co"># get the index of the points that will be in the test set</span></span>
<span id="cb224-10"><a href="#cb224-10" aria-hidden="true" tabindex="-1"></a>    test.y <span class="ot">=</span> Y[test_j] <span class="co"># response for the test points</span></span>
<span id="cb224-11"><a href="#cb224-11" aria-hidden="true" tabindex="-1"></a>    knn.pred <span class="ot">&lt;-</span> <span class="fu">knn</span>(<span class="at">train=</span>X[ <span class="sc">-</span>test_j, ], <span class="at">test=</span>X[test_j, ], <span class="at">cl=</span>Y[<span class="sc">-</span>test_j ], <span class="at">k=</span>i) </span>
<span id="cb224-12"><a href="#cb224-12" aria-hidden="true" tabindex="-1"></a>    confusion.matrix<span class="ot">=</span><span class="fu">table</span>(test.y, knn.pred) <span class="co"># 2 = positive and 1 = negative</span></span>
<span id="cb224-13"><a href="#cb224-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-14"><a href="#cb224-14" aria-hidden="true" tabindex="-1"></a>    type1[j] <span class="ot">=</span> confusion.matrix[<span class="dv">1</span>,<span class="dv">2</span>]<span class="sc">/</span><span class="fu">sum</span>(confusion.matrix[<span class="dv">1</span>,]) <span class="co"># row 1 means actual negative</span></span>
<span id="cb224-15"><a href="#cb224-15" aria-hidden="true" tabindex="-1"></a>    type2[j] <span class="ot">=</span> confusion.matrix[<span class="dv">2</span>,<span class="dv">1</span>]<span class="sc">/</span><span class="fu">sum</span>(confusion.matrix[<span class="dv">2</span>,]) <span class="co"># row 2 means actual positive</span></span>
<span id="cb224-16"><a href="#cb224-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb224-17"><a href="#cb224-17" aria-hidden="true" tabindex="-1"></a>        ave.type1[i] <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(type1), <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb224-18"><a href="#cb224-18" aria-hidden="true" tabindex="-1"></a>        ave.type2[i] <span class="ot">=</span> <span class="fu">round</span>(<span class="fu">mean</span>(type2), <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb224-19"><a href="#cb224-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb224-20"><a href="#cb224-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-21"><a href="#cb224-21" aria-hidden="true" tabindex="-1"></a>ave.type1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.164 0.142 0.098 0.102 0.111 0.089 0.085 0.093 0.089 0.085 0.084 0.093
[13] 0.085 0.080 0.085 0.080 0.080 0.080 0.080 0.063 0.067 0.067 0.067 0.071
[25] 0.071 0.080 0.071 0.067 0.067 0.071 0.058 0.049 0.049 0.044 0.044 0.049
[37] 0.040 0.035 0.035 0.031 0.035 0.036 0.031 0.027 0.027 0.022 0.022 0.022
[49] 0.022 0.022</code></pre>
</div>
<div class="sourceCode cell-code" id="cb226"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a>ave.type2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.634 0.630 0.707 0.654 0.640 0.655 0.652 0.688 0.713 0.727 0.690 0.715
[13] 0.678 0.691 0.678 0.700 0.715 0.739 0.690 0.715 0.691 0.703 0.703 0.727
[25] 0.703 0.728 0.764 0.764 0.753 0.776 0.752 0.753 0.779 0.790 0.814 0.789
[37] 0.801 0.835 0.837 0.826 0.850 0.850 0.862 0.863 0.889 0.887 0.887 0.899
[49] 0.899 0.912</code></pre>
</div>
</div></li>
<li><p>Report the length of vector <code>ave.type1</code> and the length of vector <code>ave.type2</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(ave.type1) <span class="co"># 50, same as K</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 50</code></pre>
</div>
<div class="sourceCode cell-code" id="cb230"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(ave.type2) <span class="co"># 50, same as K</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 50</code></pre>
</div>
</div></li>
<li><p>Write the code to produce a scatter plot where <code>ave.type1</code> is in X-axis and <code>ave.type2</code> is in Y-axis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb232"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ave.type1, ave.type2, <span class="at">pch =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-78-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div></li>
<li><p>For this study, we assume that type I error can be tolerated while type II error is not. Which value of K would you choose among the three smallest type II error rate, yet the type I error rate is not larger than 15%? Report the type I and type II error rate for that value of K.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb233"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(ave.type2)[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.630 0.634 0.640</code></pre>
</div>
<div class="sourceCode cell-code" id="cb235"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="co"># index of K that produced three smallest type 2 error</span></span>
<span id="cb235-2"><a href="#cb235-2" aria-hidden="true" tabindex="-1"></a>index <span class="ot">=</span> <span class="fu">which</span>(ave.type2 <span class="sc">%in%</span> <span class="fu">c</span>(<span class="fu">sort</span>(ave.type2)[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>])) </span>
<span id="cb235-3"><a href="#cb235-3" aria-hidden="true" tabindex="-1"></a>index</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1 2 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb237"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="co"># values of type 1 error for those K with 3 smallest type 2 error</span></span>
<span id="cb237-2"><a href="#cb237-2" aria-hidden="true" tabindex="-1"></a>ave.type1[index] </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.164 0.142 0.111</code></pre>
</div>
<div class="sourceCode cell-code" id="cb239"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="co"># among those values of K, we choose the one that gives types 1 error smaller than 15%</span></span>
<span id="cb239-2"><a href="#cb239-2" aria-hidden="true" tabindex="-1"></a><span class="co"># values of K could be chosen are: 2, 5</span></span>
<span id="cb239-3"><a href="#cb239-3" aria-hidden="true" tabindex="-1"></a><span class="co"># since K = 2 gives second smallest type 2 error = 63.4% with type 1 error = 14.2%,</span></span>
<span id="cb239-4"><a href="#cb239-4" aria-hidden="true" tabindex="-1"></a><span class="co"># and K = 5 gives third smalles type 2 error = 64% with type 1 error = 11.1%.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
</ol>
</section>
</section>
<section id="y2324-s1" class="level2">
<h2 class="anchored" data-anchor-id="y2324-s1">Y(23/24) S1</h2>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>