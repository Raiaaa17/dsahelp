<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>DSARAY - DSA1101 FINAL: Everything I Need</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">DSARAY</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./index.html" aria-current="page"> 
<span class="menu-text">Home</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="4">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#general-notes" id="toc-general-notes" class="nav-link active" data-scroll-target="#general-notes">General Notes</a>
  <ul class="collapse">
  <li><a href="#bayes-theorem" id="toc-bayes-theorem" class="nav-link" data-scroll-target="#bayes-theorem">Bayes Theorem</a></li>
  <li><a href="#odds-and-odds-ratio" id="toc-odds-and-odds-ratio" class="nav-link" data-scroll-target="#odds-and-odds-ratio">Odds and Odds Ratio</a></li>
  <li><a href="#confusion-matrix" id="toc-confusion-matrix" class="nav-link" data-scroll-target="#confusion-matrix">Confusion Matrix</a></li>
  <li><a href="#renaming-column-by-names-and-index" id="toc-renaming-column-by-names-and-index" class="nav-link" data-scroll-target="#renaming-column-by-names-and-index">Renaming Column by Names and Index</a></li>
  <li><a href="#models-characteristics" id="toc-models-characteristics" class="nav-link" data-scroll-target="#models-characteristics">Models Characteristics</a></li>
  </ul></li>
  <li><a href="#tutorial-questions" id="toc-tutorial-questions" class="nav-link" data-scroll-target="#tutorial-questions">Tutorial Questions</a>
  <ul class="collapse">
  <li><a href="#t1-introduction-to-r" id="toc-t1-introduction-to-r" class="nav-link" data-scroll-target="#t1-introduction-to-r">T1 (Introduction to R)</a>
  <ul class="collapse">
  <li><a href="#offsite-questions-functions" id="toc-offsite-questions-functions" class="nav-link" data-scroll-target="#offsite-questions-functions">Offsite Questions (Functions)</a></li>
  <li><a href="#onsite-questions-loops-which" id="toc-onsite-questions-loops-which" class="nav-link" data-scroll-target="#onsite-questions-loops-which">Onsite Questions (Loops &amp; Which)</a></li>
  </ul></li>
  <li><a href="#t2-basic-prob-and-stats" id="toc-t2-basic-prob-and-stats" class="nav-link" data-scroll-target="#t2-basic-prob-and-stats">T2 (Basic Prob and Stats)</a>
  <ul class="collapse">
  <li><a href="#offsite-questions-box-scatter-qq-hist" id="toc-offsite-questions-box-scatter-qq-hist" class="nav-link" data-scroll-target="#offsite-questions-box-scatter-qq-hist">Offsite Questions (Box, Scatter, QQ, Hist)</a></li>
  <li><a href="#onsite-questions-box" id="toc-onsite-questions-box" class="nav-link" data-scroll-target="#onsite-questions-box">Onsite Questions (Box)</a></li>
  </ul></li>
  <li><a href="#t3-linear-regression-1" id="toc-t3-linear-regression-1" class="nav-link" data-scroll-target="#t3-linear-regression-1">T3 (Linear Regression 1)</a>
  <ul class="collapse">
  <li><a href="#offsite-questions-functions-1" id="toc-offsite-questions-functions-1" class="nav-link" data-scroll-target="#offsite-questions-functions-1">Offsite Questions (Functions)</a></li>
  <li><a href="#onsite-questions-lm-mathematics" id="toc-onsite-questions-lm-mathematics" class="nav-link" data-scroll-target="#onsite-questions-lm-mathematics">Onsite Questions (LM Mathematics)</a></li>
  </ul></li>
  <li><a href="#t4-linear-regression-2" id="toc-t4-linear-regression-2" class="nav-link" data-scroll-target="#t4-linear-regression-2">T4 (Linear Regression 2)</a>
  <ul class="collapse">
  <li><a href="#offsite-questions-hist-linear-regression" id="toc-offsite-questions-hist-linear-regression" class="nav-link" data-scroll-target="#offsite-questions-hist-linear-regression">Offsite Questions (Hist, Linear Regression)</a></li>
  <li><a href="#onsite-questions-linear-regression" id="toc-onsite-questions-linear-regression" class="nav-link" data-scroll-target="#onsite-questions-linear-regression">Onsite Questions (Linear Regression)</a></li>
  </ul></li>
  <li><a href="#t5-k-nearest-neighbor" id="toc-t5-k-nearest-neighbor" class="nav-link" data-scroll-target="#t5-k-nearest-neighbor">T5 (K-Nearest Neighbor)</a>
  <ul class="collapse">
  <li><a href="#offsite-questions-multiple-scater-linear-regression" id="toc-offsite-questions-multiple-scater-linear-regression" class="nav-link" data-scroll-target="#offsite-questions-multiple-scater-linear-regression">Offsite Questions (Multiple Scater, Linear Regression)</a></li>
  <li><a href="#onsite-questions-knn-mathematics" id="toc-onsite-questions-knn-mathematics" class="nav-link" data-scroll-target="#onsite-questions-knn-mathematics">Onsite Questions (KNN Mathematics)</a></li>
  </ul></li>
  <li><a href="#t6-decision-trees" id="toc-t6-decision-trees" class="nav-link" data-scroll-target="#t6-decision-trees">T6 (Decision Trees)</a>
  <ul class="collapse">
  <li><a href="#offsite-questions-knn-tuning-n-fold-cv-decision-trees" id="toc-offsite-questions-knn-tuning-n-fold-cv-decision-trees" class="nav-link" data-scroll-target="#offsite-questions-knn-tuning-n-fold-cv-decision-trees">Offsite Questions (KNN Tuning, N-fold CV, Decision Trees)</a></li>
  </ul></li>
  <li><a href="#t7-decision-trees-2" id="toc-t7-decision-trees-2" class="nav-link" data-scroll-target="#t7-decision-trees-2">T7 (Decision Trees 2)</a>
  <ul class="collapse">
  <li><a href="#offsite-questions-decision-trees-n-fold-cv" id="toc-offsite-questions-decision-trees-n-fold-cv" class="nav-link" data-scroll-target="#offsite-questions-decision-trees-n-fold-cv">Offsite Questions (Decision Trees, N-fold CV)</a></li>
  <li><a href="#onsite-questions-decision-trees-tuning-n-fold-cv" id="toc-onsite-questions-decision-trees-tuning-n-fold-cv" class="nav-link" data-scroll-target="#onsite-questions-decision-trees-tuning-n-fold-cv">Onsite Questions (Decision Trees Tuning, N-fold CV)</a></li>
  </ul></li>
  <li><a href="#t8-naive-bayes" id="toc-t8-naive-bayes" class="nav-link" data-scroll-target="#t8-naive-bayes">T8 (Naive Bayes)</a>
  <ul class="collapse">
  <li><a href="#offsite-questions-naive-bayes-decision-trees-roc-auc" id="toc-offsite-questions-naive-bayes-decision-trees-roc-auc" class="nav-link" data-scroll-target="#offsite-questions-naive-bayes-decision-trees-roc-auc">Offsite Questions (Naive Bayes, Decision Trees, ROC, AUC)</a></li>
  <li><a href="#onsite-questions-naive-bayes-mathematics" id="toc-onsite-questions-naive-bayes-mathematics" class="nav-link" data-scroll-target="#onsite-questions-naive-bayes-mathematics">Onsite Questions (Naive Bayes Mathematics)</a></li>
  </ul></li>
  <li><a href="#t9-logistic-regression" id="toc-t9-logistic-regression" class="nav-link" data-scroll-target="#t9-logistic-regression">T9 (Logistic Regression)</a>
  <ul class="collapse">
  <li><a href="#offsite-questions-logistic-regression-roc-auc" id="toc-offsite-questions-logistic-regression-roc-auc" class="nav-link" data-scroll-target="#offsite-questions-logistic-regression-roc-auc">Offsite Questions (Logistic Regression, ROC, AUC)</a></li>
  <li><a href="#onsite-questions-logistic-regression-threshold" id="toc-onsite-questions-logistic-regression-threshold" class="nav-link" data-scroll-target="#onsite-questions-logistic-regression-threshold">Onsite Questions (Logistic Regression, Threshold)</a></li>
  </ul></li>
  <li><a href="#t10-k-means-clustering" id="toc-t10-k-means-clustering" class="nav-link" data-scroll-target="#t10-k-means-clustering">T10 (K-Means Clustering)</a>
  <ul class="collapse">
  <li><a href="#offsite-questions-k-means-mathematics" id="toc-offsite-questions-k-means-mathematics" class="nav-link" data-scroll-target="#offsite-questions-k-means-mathematics">Offsite Questions (K-Means Mathematics)</a></li>
  <li><a href="#onsite-questions-k-means-clustering" id="toc-onsite-questions-k-means-clustering" class="nav-link" data-scroll-target="#onsite-questions-k-means-clustering">Onsite Questions (K-Means Clustering)</a></li>
  </ul></li>
  <li><a href="#t11-association-rules" id="toc-t11-association-rules" class="nav-link" data-scroll-target="#t11-association-rules">T11 (Association Rules)</a>
  <ul class="collapse">
  <li><a href="#offsite-questions-association-rules-mathematics" id="toc-offsite-questions-association-rules-mathematics" class="nav-link" data-scroll-target="#offsite-questions-association-rules-mathematics">Offsite Questions (Association Rules Mathematics)</a></li>
  <li><a href="#qa" id="toc-qa" class="nav-link" data-scroll-target="#qa">Q&amp;A</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#midterm-practice" id="toc-midterm-practice" class="nav-link" data-scroll-target="#midterm-practice">Midterm Practice</a></li>
  <li><a href="#final-practice" id="toc-final-practice" class="nav-link" data-scroll-target="#final-practice">Final Practice</a>
  <ul class="collapse">
  <li><a href="#semester-2" id="toc-semester-2" class="nav-link" data-scroll-target="#semester-2">23/24 Semester 2</a></li>
  <li><a href="#semester-1" id="toc-semester-1" class="nav-link" data-scroll-target="#semester-1">23/24 Semester 1</a></li>
  <li><a href="#canvas-practice-final" id="toc-canvas-practice-final" class="nav-link" data-scroll-target="#canvas-practice-final">Canvas Practice Final</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">DSA1101 FINAL: Everything I Need</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Hi! I’m Ray! Welcome to your ultimate DSA1101 survival guide! 🎉 Whether you’re new to data science or leveling up for finals, this helpsheet blog has bite-sized tips, easy code, and all the cheat codes you need. 🚀 From data wrangling to machine learning, I’ve got you covered. Ready to dive in? Let’s go! 😎</p>
<section id="general-notes" class="level1">
<h1>General Notes</h1>
<section id="bayes-theorem" class="level3">
<h3 class="anchored" data-anchor-id="bayes-theorem">Bayes Theorem</h3>
<p>Suppose that 5% of all emails are spams. The phrase “you are a winner” occurs in 50% spam emails, and in 10% of non-spam emails.</p>
<p><img src="images/clipboard-2431012875.png" class="img-fluid"></p>
</section>
<section id="odds-and-odds-ratio" class="level3">
<h3 class="anchored" data-anchor-id="odds-and-odds-ratio">Odds and Odds Ratio</h3>
<ol type="1">
<li><p>Interpreting the Value of Odds Ratio:</p>
<ul>
<li>OR = 1: The odds of the event are the same in both groups; no association between the exposure and the outcome.</li>
<li>OR &gt; 1: The event is more likely to occur in Group 1 than in Group 2. A higher odds ratio indicates a stronger association.</li>
<li>OR &lt; 1: The event is less likely to occur in Group 1 than in Group 2, indicating a negative association or a protective effect.</li>
</ul></li>
<li><p>Practical Example: Suppose you are studying whether smoking (exposure) is associated with lung cancer (outcome):</p>
<ul>
<li>If the OR = 2.5, it means smokers are 2.5 times more likely to develop lung cancer than non-smokers.</li>
<li>If the OR = 0.5, it means smokers are half as likely (or have a 50% reduced odds) to develop lung cancer compared to non-smokers.</li>
</ul></li>
</ol>
<p>Example in Context:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Group</th>
<th>Outcome = Yes</th>
<th>Outcome = No</th>
<th>Odds</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Exposed</td>
<td>30</td>
<td>70</td>
<td>( 30/70 = 0.43 )</td>
</tr>
<tr class="even">
<td>Not Exposed</td>
<td>15</td>
<td>85</td>
<td>( 15/85 = 0.18 )</td>
</tr>
</tbody>
</table>
<p>Odds ratio:</p>
<p><span class="math inline">\(\text{OR} = \frac{0.43}{0.18} \approx 2.39\)</span></p>
<ul>
<li>Interpretation: The odds of the outcome (e.g., disease) are 2.39 times higher for the exposed group compared to the non-exposed group.</li>
</ul>
</section>
<section id="confusion-matrix" class="level3">
<h3 class="anchored" data-anchor-id="confusion-matrix">Confusion Matrix</h3>
<p><img src="images/clipboard-519856922.png" class="img-fluid"></p>
<p><img src="images/clipboard-220838721.png" class="img-fluid"></p>
</section>
<section id="renaming-column-by-names-and-index" class="level3">
<h3 class="anchored" data-anchor-id="renaming-column-by-names-and-index">Renaming Column by Names and Index</h3>
<p><code>names(data)[names(data) == "old_name"] &lt;- "new_name"</code></p>
<p><code>names(data)[1] &lt;- "new_name"</code></p>
</section>
<section id="models-characteristics" class="level3">
<h3 class="anchored" data-anchor-id="models-characteristics">Models Characteristics</h3>
<section id="k-nearest-neighbors-knn" class="level4">
<h4 class="anchored" data-anchor-id="k-nearest-neighbors-knn"><strong>K-Nearest Neighbors (KNN)</strong></h4>
<p><strong>Pros</strong></p>
<ul>
<li><strong>Non-parametric</strong>: Makes no assumptions about the underlying data distribution.</li>
<li><strong>Handles Nonlinear Boundaries</strong>: Works well for complex decision boundaries.</li>
</ul>
<p><strong>Cons</strong></p>
<ul>
<li><strong>Require Feature Scaling</strong>: Requires normalization or standardization of features to ensure fair distance calculations.</li>
<li><strong>Sensitive to Noise and Outliers</strong>: Outliers can significantly affect predictions.</li>
</ul>
</section>
<section id="decision-tree" class="level4">
<h4 class="anchored" data-anchor-id="decision-tree"><strong>Decision Tree</strong></h4>
<p><strong>Pros</strong></p>
<ul>
<li><strong>Interpretable and Visualizable</strong>: Easy to understand and explain; can visualize the tree structure.</li>
<li><strong>Handles Both Numerical and Categorical Data</strong>: Flexible in dealing with mixed data types.</li>
<li><strong>No Need for Feature Scaling</strong>: Works directly with raw data.</li>
<li><strong>Captures Nonlinear Relationships</strong>: Can model complex patterns in data.</li>
</ul>
<p><strong>Cons</strong></p>
<ul>
<li><strong>Prone to Overfitting</strong>: Without pruning or limiting depth, it can memorize the training data.</li>
<li><strong>Instability</strong>: A small change in data can lead to a completely different tree structure.</li>
<li><strong>Bias Towards Dominant Features</strong>: May prioritize features with more unique levels or high variance.</li>
</ul>
</section>
<section id="linear-regression" class="level4">
<h4 class="anchored" data-anchor-id="linear-regression"><strong>Linear Regression</strong></h4>
<p><strong>Pros</strong></p>
<ul>
<li><strong>Theoretical Insights</strong>: Provides coefficients that indicate feature importance and direction of influence.</li>
<li><strong>Good for Linearly Related Data</strong>: Performs well when the relationship between features and target is linear.</li>
</ul>
<p><strong>Cons</strong></p>
<ul>
<li><p><strong>Assumes Linearity and Symmetrical Data</strong>: Performs poorly if the relationship between features and the target is nonlinear.</p>
<p><img src="images/clipboard-789686564.png" class="img-fluid"></p></li>
<li><p><strong>Sensitive to Outliers</strong>: Outliers can heavily skew the model.</p></li>
<li><p><strong>Multicollinearity Issues</strong>: High correlation among features can lead to unreliable coefficients.</p></li>
<li><p><strong>Only Numerical Features</strong>: Requires categorical features to be encoded (turned into factor), which adds preprocessing complexity.</p></li>
</ul>
</section>
<section id="logistic-regression" class="level4">
<h4 class="anchored" data-anchor-id="logistic-regression"><strong>Logistic Regression</strong></h4>
<p><strong>Pros</strong></p>
<ul>
<li><strong>Simple and Interpretable</strong>: Easy to implement and interpret, especially for binary classification.</li>
<li><strong>Efficient</strong>: Works well with smaller datasets and linearly separable data.</li>
<li><strong>Probability Outputs</strong>: Provides probabilities, making it suitable for tasks requiring confidence scores.</li>
</ul>
<p><strong>Cons</strong></p>
<ul>
<li><strong>Assumes Linear Decision Boundary</strong>: Struggles with data that has nonlinear relationships unless transformed.</li>
<li><strong>Sensitive to Outliers</strong>: Outliers can distort predictions and coefficients.</li>
<li><strong>Feature Engineering Required</strong>: May need transformations or interaction terms for better performance.</li>
<li><strong>Only Numerical Features</strong>: Requires encoding (turning into factor) of categorical variables.</li>
</ul>
</section>
<section id="naive-bayes" class="level4">
<h4 class="anchored" data-anchor-id="naive-bayes"><strong>Naive Bayes</strong></h4>
<p><strong>Pros</strong></p>
<ul>
<li><strong>Simple and Interpretable</strong>: Based on straightforward probability calculations.</li>
<li><strong>Handles Missing Data</strong>: Some variants can handle missing values effectively.</li>
<li><strong>Good for Text Data</strong>: Performs well in applications like spam filtering and sentiment analysis.</li>
</ul>
<p><strong>Cons</strong></p>
<ul>
<li><strong>Assumes Feature Independence</strong>: Relies on the strong (and often unrealistic) assumption that features are independent.</li>
<li><strong>Sensitive to Correlated Features</strong>: Correlated features can degrade performance significantly.</li>
<li><strong>Limited Decision Boundaries</strong>: Cannot model complex relationships between features and the target.</li>
<li><strong>Class Imbalance Issues</strong>: May perform poorly with imbalanced datasets without proper adjustments.</li>
</ul>
<p><strong>Comparison Table</strong></p>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 36%">
<col style="width: 38%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Model</strong></th>
<th><strong>Pros</strong></th>
<th><strong>Cons</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>KNN</strong></td>
<td>Non-parametric, simple, models nonlinear data</td>
<td>Sensitive to scaling, computationally expensive</td>
</tr>
<tr class="even">
<td><strong>Decision Tree</strong></td>
<td>Interpretable, nonlinear, handles mixed data</td>
<td>Prone to overfitting, instability</td>
</tr>
<tr class="odd">
<td><strong>Linear Regression</strong></td>
<td>Simple, interpretable, fast</td>
<td>Assumes linearity, sensitive to outliers</td>
</tr>
<tr class="even">
<td><strong>Logistic Regression</strong></td>
<td>Efficient, interpretable, provides probabilities</td>
<td>Assumes linear boundary, sensitive to outliers</td>
</tr>
<tr class="odd">
<td><strong>Naive Bayes</strong></td>
<td>Fast, interpretable, handles high dimensions</td>
<td>Assumes feature independence, limited boundaries</td>
</tr>
</tbody>
</table>
<p>Choosing a Model</p>
<ul>
<li>Use KNN: For small datasets with nonlinear relationships.</li>
<li>Use Decision Tree: For interpretable models with mixed data types or nonlinear patterns.</li>
<li>Use Linear Regression: For simple regression problems with linearly related data.</li>
<li>Use Logistic Regression: For binary classification problems with linearly separable data.</li>
<li>Use Naive Bayes: For text classification or when feature independence is a reasonable assumption.</li>
</ul>
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 33%">
<col style="width: 41%">
</colgroup>
<thead>
<tr class="header">
<th>Unsupervised <strong>Algorithm</strong></th>
<th>Pros</th>
<th><strong>Cons</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>K-Means</strong></td>
<td>Simple, scalable, handles numerical data well</td>
<td>Sensitive to initialization, assumes spherical clusters</td>
</tr>
<tr class="even">
<td><strong>Apriori Algorithm</strong></td>
<td>Intuitive, interpretable results, useful for rule mining</td>
<td>Computationally expensive, struggles with large/high-dimensional datasets</td>
</tr>
</tbody>
</table>
</section>
</section>
</section>
<section id="tutorial-questions" class="level1">
<h1>Tutorial Questions</h1>
<section id="t1-introduction-to-r" class="level2">
<h2 class="anchored" data-anchor-id="t1-introduction-to-r">T1 (Introduction to R)</h2>
<section id="offsite-questions-functions" class="level3">
<h3 class="anchored" data-anchor-id="offsite-questions-functions">Offsite Questions (Functions)</h3>
<p>General idea of this problem: You have just graduated from NUS and just started your first job. You plan to buy a flat on your own which has price = $1,200,000 (1.2 million dollars). You need to save money for several years before you can afford to make the down payment which is 25% of the flat’s price.</p>
<ul>
<li>Call the amount that you have saved thus far: <strong>saved</strong>. You start the very first month with a savings of $10,000 that your parents gave you.</li>
<li>Call your monthly salary as <strong>salary</strong> which is paid at the end of every month. Each month, you are going to dedicate 40% of your salary to save for the down payment.</li>
<li>Assume that you invest your savings wisely, with a monthly average return of 2%. That means: at the end of each month, you receive an additional of <strong>saved</strong> ×0.02 funds where <strong>saved</strong> is the amount you have from end of previous month to put into your savings.</li>
<li>At the end of each month, your savings will be increased by the return on your investment, plus 40% of your monthly salary.</li>
</ul>
<p>Note: In your code for the questions below, you MUST use the names as given in bold above.</p>
<ol type="1">
<li><p>Write the code to calculate how many months it will take you to save up enough money for the down payment for two persons of of diferent salary: (i) <strong>salary</strong> = $7,000; and (ii) <strong>salary</strong> = $10,000.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Solution 1.i</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>cost <span class="ot">&lt;-</span> <span class="dv">1200000</span> <span class="sc">*</span> <span class="fl">0.25</span> </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>salary <span class="ot">&lt;-</span> <span class="dv">7000</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>saved <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>month <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span>(saved <span class="sc">&lt;</span> cost){</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>month <span class="ot">&lt;-</span> month <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>saved <span class="ot">&lt;-</span> saved <span class="sc">+</span> <span class="fl">0.4</span> <span class="sc">*</span> salary <span class="sc">+</span> <span class="fl">0.02</span> <span class="sc">*</span> saved }</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(month) <span class="co"># 55</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 55</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Solution 2.i</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>cost <span class="ot">&lt;-</span> <span class="dv">1200000</span> <span class="sc">*</span> <span class="fl">0.25</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>salary <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>saved <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>month <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span>(saved <span class="sc">&lt;</span> cost){</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>month <span class="ot">&lt;-</span> month <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>saved <span class="ot">&lt;-</span> saved <span class="sc">+</span> <span class="fl">0.4</span> <span class="sc">*</span> salary <span class="sc">+</span> <span class="fl">0.02</span> <span class="sc">*</span> saved }</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(month) <span class="co"># 44</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 44</code></pre>
</div>
</div></li>
<li><p>In question above, we unrealistically assumed that the salary doesn’t change over the years. However, now we consider that the salary will be raised every 4 months by a rate named rate, this variable should be in decimal form (i.e.&nbsp;0.03 for 3%). The new salary will be applied for the month after every batch of 4 months.</p>
<p>With this further assumption, write the code to calculate how many months it will take a person to save up enough money for the down payment if that person has (i) (<strong>salary</strong> = $7,000 and <strong>rate</strong> = 0.02); (ii) (<strong>salary</strong> = $10,000 and <strong>rate</strong> = 0.01).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Solution 2.i</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>cost <span class="ot">&lt;-</span> <span class="dv">1200000</span> <span class="sc">*</span> <span class="fl">0.25</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>salary <span class="ot">&lt;-</span> <span class="dv">7000</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>saved <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>month <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>rate <span class="ot">&lt;-</span> <span class="fl">0.02</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (saved <span class="sc">&lt;</span> cost) {</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  month <span class="ot">&lt;-</span> month <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  saved <span class="ot">&lt;-</span> saved <span class="sc">+</span> <span class="fl">0.4</span> <span class="sc">*</span> salary <span class="sc">+</span> <span class="fl">0.02</span> <span class="sc">*</span> saved</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (month <span class="sc">%%</span> <span class="dv">4</span> <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    salary <span class="ot">&lt;-</span>  salary <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> rate)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(month) <span class="co">#52</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 52</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Solution 2.ii</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>cost <span class="ot">&lt;-</span> <span class="dv">1200000</span> <span class="sc">*</span> <span class="fl">0.25</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>salary <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>saved <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>month <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>rate <span class="ot">&lt;-</span> <span class="fl">0.01</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (saved <span class="sc">&lt;</span> cost) {</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  month <span class="ot">&lt;-</span> month <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  saved <span class="ot">&lt;-</span> saved <span class="sc">+</span> <span class="fl">0.4</span> <span class="sc">*</span> salary <span class="sc">+</span> <span class="fl">0.02</span> <span class="sc">*</span> saved</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (month <span class="sc">%%</span> <span class="dv">4</span> <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    salary <span class="ot">&lt;-</span>  salary <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> rate)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(month) <span class="co">#43</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 43</code></pre>
</div>
</div></li>
</ol>
</section>
<section id="onsite-questions-loops-which" class="level3">
<h3 class="anchored" data-anchor-id="onsite-questions-loops-which">Onsite Questions (Loops &amp; Which)</h3>
<ol type="1">
<li>A sequence is generated using the following recursive relation:</li>
</ol>
<p><span class="math inline">\(x_n = 2x_{n-1} - x_{n-2} + 5, \quad \text{for } n \geq 3,\)</span></p>
<p>with <span class="math inline">\(x_1 = 0\)</span> and <span class="math inline">\(x_2 = 1\)</span>.</p>
<ol type="a">
<li><p>Use a “for” loop in R to find the 30th term of the series.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">30</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">30</span>) {x[i] <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>x[i<span class="dv">-1</span>] <span class="sc">-</span> x[i<span class="dv">-2</span>] <span class="sc">+</span> <span class="dv">5</span>}</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">30</span>] <span class="co"># 2059</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2059</code></pre>
</div>
</div></li>
<li><p>Find the smallest value of (n) such that <span class="math inline">\(x_n \geq 1,000\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">which</span>(x <span class="sc">&gt;=</span> <span class="dv">1000</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 22 23 24 25 26 27 28 29 30</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># all elements from x_22 onwards are larger than 1000</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># x_22 is the smallest, thus answer is n = 22</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
</ol>
<hr>
<ol start="2" type="1">
<li>Consider another sequence which is generated using the following recursive relation:</li>
</ol>
<p><span class="math inline">\(y_1 = 2800 + 1.02 \times y_0, \quad \text{with } y_0 = 10000\)</span>,</p>
<p><span class="math inline">\(y_n = 2800 + 1.02 \times y_{n-1}, \quad \text{for } n \geq 2\)</span>.</p>
<p>Find the smallest value of <span class="math inline">\(n\)</span> such that <span class="math inline">\(y_n \geq 300,000\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">numeric</span>()</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">append</span>(y, <span class="dv">2800</span> <span class="sc">+</span> <span class="fl">1.02</span><span class="sc">*</span><span class="dv">10000</span>) </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (<span class="fu">max</span>(y) <span class="sc">&lt;</span> <span class="dv">300000</span>) {</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">c</span>(y, <span class="dv">2800</span> <span class="sc">+</span> <span class="fl">1.02</span><span class="sc">*</span><span class="fu">max</span>(y))</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(y) <span class="co"># 55</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 55</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>y[<span class="dv">55</span>] <span class="co"># 305759.6</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 305759.6</code></pre>
</div>
</div>
</section>
</section>
<section id="t2-basic-prob-and-stats" class="level2">
<h2 class="anchored" data-anchor-id="t2-basic-prob-and-stats">T2 (Basic Prob and Stats)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#df = read.csv(...) </span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Imports the dataframe</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co"># BY DEFAULT, READ.CSV:</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Assumes values are separated by commas</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Assumes the data contains headers</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> <span class="fu">read.csv</span>(</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"ex_1.txt"</span>,</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">sep =</span> <span class="st">" "</span>,</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">header =</span> <span class="cn">FALSE</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>) </span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="co"># for tab use "\t"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Interpreting Scatterplots</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Is there any relationship? Is it strong?</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co"># If there is, is it positive or negative?</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Relationship is linear or non-linear?</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Special observations?</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Is the variability of the response stable when x changes? ***</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Interpreting Boxplots</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co"># How many outliers</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Median</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Distribution</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Any visible pattern? (Optional)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="offsite-questions-box-scatter-qq-hist" class="level3">
<h3 class="anchored" data-anchor-id="offsite-questions-box-scatter-qq-hist">Offsite Questions (Box, Scatter, QQ, Hist)</h3>
<p>Forced Expiratory Volume (FEV) is an index of pulmonary function that measures the volume of air expelled after 1 second of constant effort. The dataset <code>FEV.csv</code> contains measurements for 654 children aged 3 to 19 years of age. The purpose of the data collection was to study how FEV is affected by certain other variables. The variables that we shall work with are</p>
<p><strong>Age</strong>: Age in years.<br>
<strong>FEV</strong>: FEV measurement.<br>
<strong>Hgt</strong>: Height in inches.<br>
<strong>height</strong>: Height in meters<br>
<strong>Sex</strong>: 0 = female, 1 = male.<br>
<strong>Smoking status</strong>: 0 = current non-smoker, 1 = current smoker.</p>
<p>(a) What is the response variable in this study?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># FEV is the response variable in this study</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(b) Create a histogram of FEV and comment on it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>fev <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"FEV.csv"</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(fev<span class="sc">$</span>FEV)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Comments:</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co"># range: 0.5 to 6</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co"># unimodal</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co"># slightly right skewed</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co"># may have outliers</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(c) Create a boxplot of FEV and identify how many outliers there are. Investigate your data and comment on these outliers.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>bp <span class="ot">&lt;-</span> <span class="fu">boxplot</span>(fev<span class="sc">$</span>FEV)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>outliers <span class="ot">&lt;-</span> bp<span class="sc">$</span>out</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(outliers)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># There are 9 outliers</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>index <span class="ot">&lt;-</span> <span class="fu">which</span>(fev<span class="sc">$</span>FEV <span class="sc">%in%</span> outliers)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>fev[index,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       ID Age  FEV Hgt Sex Smoke height
321  2142  14 4.84  72   1     0   1.83
452 33041  12 5.22  70   1     0   1.78
464 37241  13 4.88  73   1     0   1.85
517 49541  13 5.08  74   1     0   1.88
609  6144  19 5.10  72   1     0   1.83
624 25941  15 5.79  69   1     0   1.75
632 37441  17 5.63  73   1     0   1.85
648 71141  17 5.64  70   1     0   1.78
649 71142  16 4.87  72   1     1   1.83</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Comments:</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. All outliers are male</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Most (8/9) are</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co"># non-smokers</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. They are rather</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="co"># tall</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(d) Generally, is the sample of FEV normally distributed?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(fev<span class="sc">$</span>FEV, <span class="at">pch =</span> <span class="dv">20</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(fev<span class="sc">$</span>FEV, <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Comments:</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Left tail sample quantiles are larger than expected,</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co"># hence left tail shorter than normal. </span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Right tail sample quantiles larger than expected, hence # right tail longer than normal.</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Combined with the histogram of FEV, it is clear that the</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="co"># sample of FEV is not normally distributed and quite </span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="co"># right skewed.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(e) Create separate histograms for male and female FEV, then obtain separate numerical summaries for males and female FEV. Comment on what you observe.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First, obtain the male and female FEV values separately</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="co"># to plot onto two different histograms.</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>female <span class="ot">=</span> fev<span class="sc">$</span>FEV[<span class="fu">which</span>(fev<span class="sc">$</span>Sex<span class="sc">==</span><span class="dv">0</span>)]</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternative: fev$FEV[fev$Sex==0]</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>male <span class="ot">=</span> fev<span class="sc">$</span>FEV[<span class="fu">which</span>(fev<span class="sc">$</span>Sex<span class="sc">==</span><span class="dv">1</span>)] </span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternative: fev$FEV[fev$Sex==1]</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Now plot the two histograms side-by-side</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>opar <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)) </span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(female, <span class="at">col =</span> <span class="dv">2</span>, <span class="at">freq=</span> <span class="cn">FALSE</span>, </span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a><span class="at">main =</span> <span class="st">"Histogram of Female FEV"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.52</span>))</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(male, <span class="at">col =</span> <span class="dv">4</span>, <span class="at">freq=</span> <span class="cn">FALSE</span>, </span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a><span class="at">main =</span> <span class="st">"Histogram of Male FEV"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.52</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remember to use par(mfrow=c(1,1))  to reset the diagram layout!</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="co"># obtaining separate numerical summaries for male and female</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="fu">IQR</span>(female) <span class="co"># 1.04</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.04</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(female) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.790   1.950   2.490   2.452   2.990   3.840 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(female) <span class="co"># 0.4169424</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4169424</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">IQR</span>(male) <span class="co"># 1.5275</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.5275</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(male)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  0.800   2.007   2.605   2.813   3.535   5.790 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(male) <span class="co"># 1.006866</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.006866</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Comments:</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Both histogram are unimodal but have different shapes. </span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="co"># It is almost symmetrical for females, but quite right-skewed for males.</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Median FEV for females is much lower than males, 2.49 compared to 2.605.</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Variability for males is higher than females.</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="co"># The respective IQR are 1.54 and 1.05.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(f) Create a scatterplot with height (in metres) on the x-axis and FEV on the y-axis.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fev<span class="sc">$</span>height, fev<span class="sc">$</span>FEV)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(female <span class="sc">~</span> fev<span class="sc">$</span>height[<span class="fu">which</span>(fev<span class="sc">$</span>Sex<span class="sc">==</span><span class="dv">0</span>)], </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="at">col =</span> <span class="st">"red"</span>, <span class="at">pch =</span> <span class="dv">20</span>)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(male <span class="sc">~</span> fev<span class="sc">$</span>height[<span class="fu">which</span>(fev<span class="sc">$</span>Sex<span class="sc">==</span><span class="dv">1</span>)], </span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="at">col =</span> <span class="st">"darkblue"</span>, <span class="at">pch =</span> <span class="dv">20</span>)</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="fl">1.2</span>, <span class="dv">5</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Female"</span>, <span class="st">"Male"</span>), </span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>,<span class="st">"darkblue"</span>), <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">20</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>(g) Compute the correlation between FEV and height and comment on your results.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(fev<span class="sc">$</span>FEV, fev<span class="sc">$</span>height) <span class="co"># 0.8675619</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8675619</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Computed correlation is quite high.</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="co"># It is clear from the plot that there is a strong </span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="co"># positive linear association between FEV and height. </span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="co"># The range of FEV and height for males appears larger than for females. </span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="co"># The variability of FEV at lower heights seems slightly </span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="co"># less than the variability of FEV at greater heights.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="onsite-questions-box" class="level3">
<h3 class="anchored" data-anchor-id="onsite-questions-box">Onsite Questions (Box)</h3>
<p>Consider a dataset about HDB resale flats in Singapore given in <code>hdbresale_reg.csv</code>, which helps to investigate the factors that affect the resale price of the flats.</p>
<ol type="1">
<li><p>Import the dataset into R.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>hdb <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"hdbresale_reg.csv"</span>)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(hdb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "X"                   "month"               "town"               
 [4] "flat_type"           "block"               "street_name"        
 [7] "storey_range"        "floor_area_sqm"      "flat_model"         
[10] "lease_commence_date" "resale_price"       </code></pre>
</div>
</div></li>
<li><p>How many flats are in the sample given?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(hdb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6055   11</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the dataframe has 6055 rows and 11 columns</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="co"># thus there are 6055 flats</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
<li><p>Exploring the variable <code>resale_price</code>:</p>
<ol type="a">
<li>Create a histogram. Give your comments. Is the sample of resale prices normally distributed?</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(hdb<span class="sc">$</span>resale_price)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># range: 200k to ~1 mil</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="co"># unimodal</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="co"># clearly right skewed</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="co"># suspected outliers</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="a">
<li>Create a box plot.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>bp <span class="ot">&lt;-</span> <span class="fu">boxplot</span>(hdb<span class="sc">$</span>resale_price)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>outliers <span class="ot">&lt;-</span> bp<span class="sc">$</span>out</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(outliers)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 680000 728000 680000 707000 640000 659500</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(outliers) <span class="co"># 284 outliers</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 284</code></pre>
</div>
</div></li>
</ol>
</section>
</section>
<section id="t3-linear-regression-1" class="level2">
<h2 class="anchored" data-anchor-id="t3-linear-regression-1">T3 (Linear Regression 1)</h2>
<section id="offsite-questions-functions-1" class="level3">
<h3 class="anchored" data-anchor-id="offsite-questions-functions-1">Offsite Questions (Functions)</h3>
<p>Consider the question given in Tutorial 1.</p>
<p>(a) For the first question in Tutorial 1, use the code to define a function, called F1, where the argument of F1 is salary. Run function F1 for the two cases mentioned.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>cost <span class="ot">&lt;-</span> <span class="dv">1200000</span> <span class="sc">*</span> <span class="fl">0.25</span> </span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>F1 <span class="ot">&lt;-</span> <span class="cf">function</span>(salary) {</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  saved <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  month <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span>(saved <span class="sc">&lt;</span> cost) {</span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>    month <span class="ot">&lt;-</span> month <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>    saved <span class="ot">&lt;-</span> saved <span class="sc">+</span> <span class="fl">0.4</span> <span class="sc">*</span> salary <span class="sc">+</span> <span class="fl">0.02</span> <span class="sc">*</span> saved</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(month)</span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(b) For the second question in Tutorial 1, use the code to define a function, called F2, where F2 has two arguments: salary and rate. Run function F2 for the two cases mentioned to obtain the results.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>F2 <span class="ot">&lt;-</span> <span class="cf">function</span>(salary, <span class="at">price =</span> <span class="dv">1200000</span>, <span class="at">rate =</span> <span class="fl">0.01</span>, <span class="at">portion_save =</span> <span class="fl">0.4</span>) {</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">=</span> <span class="fl">0.02</span> <span class="co"># monthly rate return from investment</span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  saved <span class="ot">&lt;-</span> <span class="dv">10000</span> <span class="co"># savings given by parents initially</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  month <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>  cost <span class="ot">=</span> <span class="fl">0.25</span><span class="sc">*</span>price</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span>(saved <span class="sc">&lt;</span> cost) {</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>    month <span class="ot">=</span> month <span class="sc">+</span><span class="dv">1</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>    saved <span class="ot">=</span> saved <span class="sc">+</span> portion_save <span class="sc">*</span> salary <span class="sc">+</span> saved <span class="sc">*</span> r</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (month <span class="sc">%%</span> <span class="dv">4</span> <span class="sc">==</span><span class="dv">0</span>) {</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>      salary <span class="ot">=</span> salary<span class="sc">*</span>(<span class="dv">1</span><span class="sc">+</span>rate)</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(month)</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="onsite-questions-lm-mathematics" class="level3">
<h3 class="anchored" data-anchor-id="onsite-questions-lm-mathematics">Onsite Questions (LM Mathematics)</h3>
<ol type="1">
<li><p>Read the data from the file Colleges.txt. Consider a simple linear regression of the percentage of applicants accepted (Acceptance) on the median combined math and verbal SAT score of students (SAT), called Model M1.</p>
<p>(a) Write your own function in R, name the function as simple, to derive the intercept β0 and the slope β1 of Model M1. Hint: Use the formula of the estimated coefficients, β̂1 and β̂0, given in slide 31/52 of Topic 3.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>simple <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>    beta1 <span class="ot">=</span> (<span class="fu">sum</span>(y<span class="sc">*</span>x) <span class="sc">-</span> <span class="fu">sum</span>(y)<span class="sc">*</span><span class="fu">mean</span>(x)) <span class="sc">/</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>(<span class="fu">sum</span>(x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">-</span> <span class="fu">sum</span>(x)<span class="sc">*</span><span class="fu">mean</span>(x))</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>    beta0 <span class="ot">=</span> <span class="fu">mean</span>(y)<span class="sc">-</span> beta1 <span class="sc">*</span> <span class="fu">mean</span>(x)</span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">c</span>(beta0, beta1))</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"Colleges.txt"</span>, <span class="at">sep =</span> <span class="st">"</span><span class="sc">\t</span><span class="st">"</span>)</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      School School_Type  SAT Acceptance DPerStudent Top.10p PerPhD GradPer
1    Amherst    Lib Arts 1315         22       26636      85     81      93
2 Swarthmore    Lib Arts 1310         24       27487      78     93      88
3   Williams    Lib Arts 1336         28       23772      86     90      93
4    Bowdoin    Lib Arts 1300         24       25703      78     95      90
5  Wellesley    Lib Arts 1250         49       27879      76     91      86
6     Pomona    Lib Arts 1320         33       26668      79     98      80</code></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">simple</span>(data<span class="sc">$</span>SAT, data<span class="sc">$</span>Acceptance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 202.2677440  -0.1300894</code></pre>
</div>
</div>
<p>(b) Use function lm() in R to derive the coefficients of Model M1. Compare with your answer in part (a).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(Acceptance <span class="sc">~</span> SAT , <span class="at">data =</span> data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Acceptance ~ SAT, data = data)

Coefficients:
(Intercept)          SAT  
   202.2677      -0.1301  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Same coefficients from different functions</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Helps verify implementation of 'simple' function</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
<li><p><em>(If time permits)</em>, consider a dataset about HDB resale flats in Singapore given in hdbresale_reg.csv. Consider a simple model (Model M2) where the resale price is the response and the floor area in square meters is the only regressor.</p>
<p>(a) Use the function simple you formed in the question above to find the coefficients of Model M2.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"hdbresale_reg.csv"</span>)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "X"                   "month"               "town"               
 [4] "flat_type"           "block"               "street_name"        
 [7] "storey_range"        "floor_area_sqm"      "flat_model"         
[10] "lease_commence_date" "resale_price"       </code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">simple</span>(<span class="at">x =</span> df<span class="sc">$</span>floor_area_sqm, <span class="at">y =</span> df<span class="sc">$</span>resale_price)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 115145.730   3117.212</code></pre>
</div>
</div>
<p>(b) Use the function lm() in R to derive the coefficients of Model M2.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(df<span class="sc">$</span>resale_price <span class="sc">~</span> df<span class="sc">$</span>floor_area_sqm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = df$resale_price ~ df$floor_area_sqm)

Coefficients:
      (Intercept)  df$floor_area_sqm  
           115146               3117  </code></pre>
</div>
</div></li>
</ol>
</section>
</section>
<section id="t4-linear-regression-2" class="level2">
<h2 class="anchored" data-anchor-id="t4-linear-regression-2">T4 (Linear Regression 2)</h2>
<p>Linear Model Assumptions:</p>
<ol type="1">
<li><p>Quantitative</p></li>
<li><p>Symmetric - Histogram</p></li>
<li><p>Variability of y is stable when x changes - Scatterplot</p></li>
</ol>
<p>Transformations:</p>
<p>y -&gt; log(y), sqrt(y), 1/y</p>
<p>Evaluating Goodness-Of-Fit:</p>
<ul>
<li><p>F-Test (p-value)</p></li>
<li><p>R-squared</p></li>
</ul>
<section id="offsite-questions-hist-linear-regression" class="level3">
<h3 class="anchored" data-anchor-id="offsite-questions-hist-linear-regression">Offsite Questions (Hist, Linear Regression)</h3>
<p>Consider data set given in the file <code>hdbresale_reg.csv</code> on Canvas, which has the information of 6055 HDB resale flats in Singapore. We would want to form a linear model that helps to predict the resale price of HDB flats, based on the floor area in square meters and the type of the flats.</p>
<p>(a) Consider the resale price, plot a histogram of it and give your comments. Is it suitable to fit a<br>
linear model for this response variable? Explain.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"hdbresale_reg.csv"</span>)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   6055 obs. of  11 variables:
 $ X                  : int  580 581 582 583 584 585 586 587 588 589 ...
 $ month              : chr  "2012-03" "2012-03" "2012-03" "2012-03" ...
 $ town               : chr  "CENTRAL AREA" "CENTRAL AREA" "CENTRAL AREA" "CENTRAL AREA" ...
 $ flat_type          : chr  "3 ROOM" "3 ROOM" "3 ROOM" "3 ROOM" ...
 $ block              : chr  "640" "640" "668" "5" ...
 $ street_name        : chr  "ROWELL RD" "ROWELL RD" "CHANDER RD" "TG PAGAR PLAZA" ...
 $ storey_range       : chr  "01 TO 05" "06 TO 10" "01 TO 05" "11 TO 15" ...
 $ floor_area_sqm     : num  74 74 73 59 68 75 68 77 82 105 ...
 $ flat_model         : chr  "Model A" "Model A" "Model A" "Improved" ...
 $ lease_commence_date: int  1984 1984 1984 1977 1979 2003 1980 1974 1978 2002 ...
 $ resale_price       : num  380000 388000 400000 460000 488000 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(data<span class="sc">$</span>resale_price)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Comments: </span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Right-skewed histogram</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Hence, resale price is NOT suitable to be the response </span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a><span class="co"># as assumption of linear model (symmetric) is violated.</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a><span class="co"># For a right skewed variable, it is suggested to try </span></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a><span class="co"># transforming the response by taking its logarithm.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(b) Consider the resale price, plot a histogram of log_e of it and give your comments. Is it more<br>
suitable to fit a linear model for this response variable than the original resale price?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">log</span>(data<span class="sc">$</span>resale_price))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Comments: </span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="co"># The histogram of the log of the resale price </span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="co"># is more symmetric, hence it is more suitable than </span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a><span class="co"># the original resale price as a response for our linear model.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(c) Derive a scatter plot of the log_e of the resale price against the floor area in square meters. Give your comments.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># creates a new column for the log(price)</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>log.price <span class="ot">=</span> <span class="fu">log</span>(data<span class="sc">$</span>resale_price) </span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(data<span class="sc">$</span>log.price <span class="sc">~</span> data<span class="sc">$</span>floor_area_sqm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Comments:</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="co"># There seems to be a strong, positive, linear relationship</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="co"># between log(price) and floor area.</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a><span class="co"># The variability of the log(price) seems fairly stable </span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a><span class="co"># when the floor area changes.***</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(d) Fit a linear model where the log of the resale price be the response. Write down the fitted equation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   6055 obs. of  12 variables:
 $ X                  : int  580 581 582 583 584 585 586 587 588 589 ...
 $ month              : chr  "2012-03" "2012-03" "2012-03" "2012-03" ...
 $ town               : chr  "CENTRAL AREA" "CENTRAL AREA" "CENTRAL AREA" "CENTRAL AREA" ...
 $ flat_type          : chr  "3 ROOM" "3 ROOM" "3 ROOM" "3 ROOM" ...
 $ block              : chr  "640" "640" "668" "5" ...
 $ street_name        : chr  "ROWELL RD" "ROWELL RD" "CHANDER RD" "TG PAGAR PLAZA" ...
 $ storey_range       : chr  "01 TO 05" "06 TO 10" "01 TO 05" "11 TO 15" ...
 $ floor_area_sqm     : num  74 74 73 59 68 75 68 77 82 105 ...
 $ flat_model         : chr  "Model A" "Model A" "Model A" "Improved" ...
 $ lease_commence_date: int  1984 1984 1984 1977 1979 2003 1980 1974 1978 2002 ...
 $ resale_price       : num  380000 388000 400000 460000 488000 ...
 $ log.price          : num  12.8 12.9 12.9 13 13.1 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(data<span class="sc">$</span>flat_type)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "3 ROOM"    "4 ROOM"    "5 ROOM"    "EXECUTIVE" "2 ROOM"   </code></pre>
</div>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>M <span class="ot">=</span> <span class="fu">lm</span>(log.price <span class="sc">~</span> floor_area_sqm <span class="sc">+</span> flat_type, <span class="at">data =</span> data)</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = log.price ~ floor_area_sqm + flat_type, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.28208 -0.07054 -0.01515  0.04323  0.79797 

Coefficients:
                    Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)        1.235e+01  1.891e-02 653.013  &lt; 2e-16 ***
floor_area_sqm     3.712e-03  1.817e-04  20.429  &lt; 2e-16 ***
flat_type3 ROOM    1.190e-01  1.714e-02   6.944  4.2e-12 ***
flat_type4 ROOM    2.093e-01  1.869e-02  11.196  &lt; 2e-16 ***
flat_type5 ROOM    2.762e-01  2.099e-02  13.160  &lt; 2e-16 ***
flat_typeEXECUTIVE 4.302e-01  2.527e-02  17.023  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1156 on 6049 degrees of freedom
Multiple R-squared:  0.7116,    Adjusted R-squared:  0.7114 
F-statistic:  2986 on 5 and 6049 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fitted_log(price) = </span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 12.35 + </span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.003712 * floor_area_sqm +</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.119 ∗ I(flat type = 3 ROOM) +</span></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.2093 ∗ I(flat type = 4 ROOM) +</span></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.2762 ∗ I(flat type = 5 ROOM) +</span></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.4302 ∗ I(flat type = Executive)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(e) Report the coeficient of the floor area in square meters and interpret it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The coefficient of it is 0.003712. </span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Meaning when comparing two flats of the same type, </span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a><span class="co"># then an increase of 1 square meter will increase </span></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a><span class="co"># the predicted log(price) by 0.003712.</span></span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Equivalently, the price will </span></span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a><span class="co"># increase by e^0.003712 = 1.003719 TIMES.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(f) Predict the resale price of a 4-room HDB at that is of 100 square meters.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>new <span class="ot">=</span> <span class="fu">data.frame</span>(</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">floor_area_sqm =</span> <span class="dv">100</span>, </span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">flat_type =</span> <span class="st">"4 ROOM"</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>predicted_log.price <span class="ot">=</span> <span class="fu">predict</span>(M, new)</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>predicted_price <span class="ot">=</span> <span class="fu">exp</span>(predicted_log.price)</span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(predicted_price) <span class="co"># 412807.6</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1 
412807.6 </code></pre>
</div>
</div>
<p>(g) Report <span class="math inline">\(R^2\)</span> of the model and interpret it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7116378</code></pre>
</div>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The R_squared value is 0.712. </span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="co"># That means model M can explain 71.2% </span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a><span class="co"># of the variability of the response in the sample.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="onsite-questions-linear-regression" class="level3">
<h3 class="anchored" data-anchor-id="onsite-questions-linear-regression">Onsite Questions (Linear Regression)</h3>
<ol type="1">
<li>A dataset on house selling price was randomly collected (<code>house_selling_prices_FL.csv</code>). It’s our interest to model how y = selling price (dollar) is dependent on x = the size of the house (square feet). A simple linear regression model (y regress on x) was fitted, called Model 1.</li>
</ol>
<p>The given data has another variable, NW, which specifies if a house is in the part of the town considered less desirable (NW=0).</p>
<p>(a) Derive the correlation between x and y.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"house_selling_prices_FL.csv"</span>)</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   100 obs. of  9 variables:
 $ House   : int  1 2 3 4 5 6 7 8 9 10 ...
 $ Taxes   : int  1360 1050 1010 830 2150 1230 150 1470 1850 320 ...
 $ Bedrooms: int  3 1 3 3 3 3 2 3 3 3 ...
 $ Baths   : num  2 1 1.5 2 2 2 2 2 2 2 ...
 $ Quadrant: chr  "NW" "NW" "NW" "SW" ...
 $ NW      : int  1 1 1 0 1 1 1 1 1 1 ...
 $ price   : int  145000 68000 115000 69000 163000 69900 50000 137000 121300 70000 ...
 $ size    : int  1240 370 1130 1120 1710 1010 860 1420 1270 1160 ...
 $ lot     : int  18000 25000 25000 17000 14000 8000 15300 18000 16000 8000 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(data<span class="sc">$</span>price, data<span class="sc">$</span>size)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7612621</code></pre>
</div>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Correlation between</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 'price' and 'size' is 0.761</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(b) Derive a scatter plot of y against x. Give your comments on the association of y and x.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(data<span class="sc">$</span>price <span class="sc">~</span> data<span class="sc">$</span>size, <span class="at">pch =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(data<span class="sc">$</span>size, data<span class="sc">$</span>price, <span class="at">pch =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-34-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. There is a clear relationship.</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. It is a positive association.</span></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. It seems linear.</span></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Variability of price is quite stable as size changes.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(c) Derive <span class="math inline">\(R^2\)</span> of Model 1. Verify that <span class="math inline">\(\sqrt{R^2} = |cor(y, x)|\)</span>. In which situation can we have <span class="math inline">\(\sqrt{R^2} = cor(y, x)\)</span>?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>M1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(price <span class="sc">~</span> size, <span class="at">data =</span> data)</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>r.squared <span class="ot">&lt;-</span> <span class="fu">summary</span>(M1)<span class="sc">$</span>r.squared</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(r.squared) <span class="co"># 0.57952</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.57952</code></pre>
</div>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">sqrt</span>(r.squared)) <span class="co"># 0.7612621</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7612621</code></pre>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Same as correlation value derived from 1.a.</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Given that we have verified that </span></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a><span class="co"># sqrt(R^2) = abs(cor(y, x)),</span></span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a><span class="co"># sqrt(R^2) = cor(y, x) when </span></span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a><span class="co"># abs(cor(y, x)) = cor(y, x).</span></span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Thus, when cor(y, x) &gt; 0,</span></span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a><span class="co"># then in a simple model y ∼ x, </span></span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a><span class="co"># we always have sqrt(R^2) = cor(y, x).</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(d) Form a model (called Model 2) which has two regressors (x and NW). Report the coefficient of variable NW in Model 2. Interpret it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   100 obs. of  9 variables:
 $ House   : int  1 2 3 4 5 6 7 8 9 10 ...
 $ Taxes   : int  1360 1050 1010 830 2150 1230 150 1470 1850 320 ...
 $ Bedrooms: int  3 1 3 3 3 3 2 3 3 3 ...
 $ Baths   : num  2 1 1.5 2 2 2 2 2 2 2 ...
 $ Quadrant: chr  "NW" "NW" "NW" "SW" ...
 $ NW      : int  1 1 1 0 1 1 1 1 1 1 ...
 $ price   : int  145000 68000 115000 69000 163000 69900 50000 137000 121300 70000 ...
 $ size    : int  1240 370 1130 1120 1710 1010 860 1420 1270 1160 ...
 $ lot     : int  18000 25000 25000 17000 14000 8000 15300 18000 16000 8000 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>NW <span class="ot">=</span> <span class="fu">as.factor</span>(data<span class="sc">$</span>NW)</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   100 obs. of  9 variables:
 $ House   : int  1 2 3 4 5 6 7 8 9 10 ...
 $ Taxes   : int  1360 1050 1010 830 2150 1230 150 1470 1850 320 ...
 $ Bedrooms: int  3 1 3 3 3 3 2 3 3 3 ...
 $ Baths   : num  2 1 1.5 2 2 2 2 2 2 2 ...
 $ Quadrant: chr  "NW" "NW" "NW" "SW" ...
 $ NW      : Factor w/ 2 levels "0","1": 2 2 2 1 2 2 2 2 2 2 ...
 $ price   : int  145000 68000 115000 69000 163000 69900 50000 137000 121300 70000 ...
 $ size    : int  1240 370 1130 1120 1710 1010 860 1420 1270 1160 ...
 $ lot     : int  18000 25000 25000 17000 14000 8000 15300 18000 16000 8000 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>M2 <span class="ot">=</span> <span class="fu">lm</span>(price <span class="sc">~</span> size <span class="sc">+</span> NW, <span class="at">data =</span> data)</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = price ~ size + NW, data = data)

Residuals:
   Min     1Q Median     3Q    Max 
-83207 -22968    215  14135 109149 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -15257.514  11908.297  -1.281 0.203160    
size            77.985      6.209  12.560  &lt; 2e-16 ***
NW1          30569.087   7948.742   3.846 0.000215 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 34390 on 97 degrees of freedom
Multiple R-squared:  0.6352,    Adjusted R-squared:  0.6276 
F-statistic: 84.43 on 2 and 97 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fitted equation of linear model:</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="co"># fitted_price = -15257.514 + 77.985 * size + </span></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a><span class="co">#                   30569.087 * I(NW = 1)</span></span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a><span class="co"># The estimated coefficient of NW in Model 2 is 30569.1 </span></span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a><span class="co"># This means that for houses of same size, those with </span></span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a><span class="co"># NW = 1 (Those located at NorthWest area) has predicted </span></span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a><span class="co"># price higher than that in the area of NW = 0 by $30569.1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(e) Estimate and report the price of a house where its size is 4000 square feet and is located at the more desirable part of the town.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>new_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">size =</span> <span class="dv">4000</span>, <span class="at">NW =</span> <span class="st">"1"</span>)</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(M2, <span class="at">newdata =</span> new_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1 
327252.1 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The predicted price of a house with size x = 4000 and </span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="co"># NW = 1 is $327252.1.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="t5-k-nearest-neighbor" class="level2">
<h2 class="anchored" data-anchor-id="t5-k-nearest-neighbor">T5 (K-Nearest Neighbor)</h2>
<section id="offsite-questions-multiple-scater-linear-regression" class="level3">
<h3 class="anchored" data-anchor-id="offsite-questions-multiple-scater-linear-regression">Offsite Questions (Multiple Scater, Linear Regression)</h3>
<ol type="1">
<li><p>(MLR) Consider the horseshoe female crab data given in the csv file <code>crab.csv</code>. We would want to form a model for the weight of the female crabs (kg), which depends on its width (cm) and its spine condition (1 = both good, 2 = one worn or broken, 3 = both worn or broken).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"crab.csv"</span>)</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  color spine width satell weight
1     3     3  28.3      8   3.05
2     4     3  22.5      0   1.55
3     2     1  26.0      9   2.30
4     4     3  24.8      0   2.10
5     4     3  26.0      4   2.60
6     3     3  23.8      0   2.10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   173 obs. of  5 variables:
 $ color : int  3 4 2 4 4 3 2 4 3 4 ...
 $ spine : int  3 3 1 3 3 3 1 2 1 3 ...
 $ width : num  28.3 22.5 26 24.8 26 23.8 26.5 24.7 23.7 25.6 ...
 $ satell: int  8 0 9 0 4 0 0 0 0 0 ...
 $ weight: num  3.05 1.55 2.3 2.1 2.6 2.1 2.35 1.9 1.95 2.15 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>spine <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(data<span class="sc">$</span>spine)</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 1 = both good</span></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 2 = one worn or broken</span></span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 3 = both worn or broken</span></span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   173 obs. of  5 variables:
 $ color : int  3 4 2 4 4 3 2 4 3 4 ...
 $ spine : Factor w/ 3 levels "1","2","3": 3 3 1 3 3 3 1 2 1 3 ...
 $ width : num  28.3 22.5 26 24.8 26 23.8 26.5 24.7 23.7 25.6 ...
 $ satell: int  8 0 9 0 4 0 0 0 0 0 ...
 $ weight: num  3.05 1.55 2.3 2.1 2.6 2.1 2.35 1.9 1.95 2.15 ...</code></pre>
</div>
</div>
<p>(a) Produce a scatter plot of variable weight against width for different condition of spine.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attach</span>(data)</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(weight <span class="sc">~</span> width, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">main =</span> <span class="st">"weight vs width for each spine class"</span>,</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"width"</span>, <span class="at">ylab =</span> <span class="st">"weight"</span>)</span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(weight[spine <span class="sc">==</span> <span class="st">"1"</span>] <span class="sc">~</span> width[spine <span class="sc">==</span><span class="st">"1"</span>], <span class="at">pch =</span> <span class="dv">15</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(weight[spine <span class="sc">==</span> <span class="st">"2"</span>] <span class="sc">~</span> width[spine <span class="sc">==</span><span class="st">"2"</span>], <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(weight[spine <span class="sc">==</span> <span class="st">"3"</span>] <span class="sc">~</span> width[spine <span class="sc">==</span><span class="st">"3"</span>], <span class="at">pch =</span> <span class="dv">17</span>, <span class="at">col =</span> <span class="st">"green"</span>)</span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="dv">22</span>,<span class="dv">4</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"3"</span>),<span class="at">col=</span><span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"green"</span>), <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">15</span>,<span class="dv">16</span>,<span class="dv">17</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>(b) Fit a linear regression model for weight which has two explanatories, width and spine.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(weight <span class="sc">~</span> width <span class="sc">+</span> spine, <span class="at">data =</span> data)</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = weight ~ width + spine, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.23016 -0.10828  0.01016  0.13356  0.96350 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -3.92955    0.27506 -14.286   &lt;2e-16 ***
width        0.24376    0.01002  24.335   &lt;2e-16 ***
spine2       0.05544    0.08475   0.654    0.514    
spine3      -0.06969    0.05065  -1.376    0.171    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2656 on 169 degrees of freedom
Multiple R-squared:  0.7918,    Adjusted R-squared:  0.7881 
F-statistic: 214.2 on 3 and 169 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>(c) Is the fitted model signicant?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the model f statistic showing p value is less than 2.2 x 10^-16.</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Since this is far below 0.05, the model can be considered significant</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(d) Derive <span class="math inline">\(R^2\)</span> and adjusted <span class="math inline">\(R^2\)</span> of the fitted model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7917598</code></pre>
</div>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.7917598</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)<span class="sc">$</span>adj.r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7880632</code></pre>
</div>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.7880632</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(e) Write down the fitted model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = weight ~ width + spine, data = data)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.23016 -0.10828  0.01016  0.13356  0.96350 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -3.92955    0.27506 -14.286   &lt;2e-16 ***
width        0.24376    0.01002  24.335   &lt;2e-16 ***
spine2       0.05544    0.08475   0.654    0.514    
spine3      -0.06969    0.05065  -1.376    0.171    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2656 on 169 degrees of freedom
Multiple R-squared:  0.7918,    Adjusted R-squared:  0.7881 
F-statistic: 214.2 on 3 and 169 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co"># weight = -3.92955 + 0.24376*width + 0.05544*I(spine=2) -0.06969*I(spine=3)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(f) Two female crabs of the same width, and the diference of their weight if one has spines are of good condition and another one with broken spines.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="co"># weight = -3.92955 + 0.24376*width + 0.05544*I(spine=2) + -0.06969*I(spine=3)</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a><span class="co"># weight1 = -3.92955 + 0.24376*width + 0.05544*0 + -0.06969*0</span></span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a><span class="co"># weight2 = -3.92955 + 0.24376*width + 0.05544*0 + -0.06969*1</span></span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a>weight.dif <span class="ot">&lt;-</span> (<span class="fl">0.05544</span><span class="sc">*</span><span class="dv">0</span> <span class="sc">+</span> <span class="sc">-</span><span class="fl">0.06969</span><span class="sc">*</span><span class="dv">0</span>) <span class="sc">-</span> (<span class="fl">0.05544</span><span class="sc">*</span><span class="dv">0</span> <span class="sc">+</span> <span class="sc">-</span><span class="fl">0.06969</span><span class="sc">*</span><span class="dv">1</span>)</span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a>weight.dif</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.06969</code></pre>
</div>
</div>
<p>(g) Predict the weight of a female crab that has width of 27 cm and has both spines worn or broken.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">width =</span> <span class="dv">27</span>, <span class="at">spine =</span> <span class="st">"3"</span>)</span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(model, <span class="at">newdata =</span> newdata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1 
2.582352 </code></pre>
</div>
</div></li>
<li><p>Measures of classier performance</p>
<p>Suppose we have developed a K-nearest neighbors classier for predicting diabetes status. The following table shows the actual response <span class="math inline">\(Y\)</span> (1 = yes, 0 =n o) and fitted value <span class="math inline">\(\hat Y\)</span> using the classier for 10 test data points. A test data point is predicted to be <span class="math inline">\(\hat G\)</span>= 1 if <span class="math inline">\(\hat Y\)</span> &gt; δ, for a specied threshold value δ (Recall that we use δ = 0.5 in class, also known as the majority rule).</p>
<ol type="a">
<li>We define: <span class="math inline">\(TPR = \frac {TP}{TP +FN}\)</span>, <span class="math inline">\(FPR = \frac {FP}{FP +TN}\)</span>; For each of the thresholds δ = 0.3, 0.6 and 0.8, derive <span class="math inline">\(TPR\)</span> and <span class="math inline">\(FPR\)</span> in making predictions with the K-nearest neighbors classier for the 10 test data points. Plot <span class="math inline">\(TPR\)</span> against <span class="math inline">\(FPR\)</span> for the three thresholds.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>ycap <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.9</span>,<span class="fl">0.5</span>,<span class="fl">0.7</span>,<span class="fl">0.4</span>,<span class="fl">0.5</span>,<span class="fl">0.2</span>,<span class="fl">0.7</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>)</span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>tpr.all <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">0</span>)</span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>fpr.all <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">0</span>)</span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a>sigma.list <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.3</span>,<span class="fl">0.6</span>,<span class="fl">0.8</span>)</span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (sigma <span class="cf">in</span> sigma.list) {</span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a>  pred <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(ycap <span class="sc">&gt;=</span> sigma, <span class="dv">1</span> ,<span class="dv">0</span>)</span>
<span id="cb143-9"><a href="#cb143-9" aria-hidden="true" tabindex="-1"></a>  confusion.matrix <span class="ot">&lt;-</span> <span class="fu">table</span>(y, pred)</span>
<span id="cb143-10"><a href="#cb143-10" aria-hidden="true" tabindex="-1"></a>  tpr <span class="ot">&lt;-</span> confusion.matrix[<span class="dv">2</span>,<span class="dv">2</span>]<span class="sc">/</span><span class="fu">sum</span>(confusion.matrix[<span class="dv">2</span>,])</span>
<span id="cb143-11"><a href="#cb143-11" aria-hidden="true" tabindex="-1"></a>  fpr <span class="ot">&lt;-</span> confusion.matrix[<span class="dv">1</span>,<span class="dv">2</span>]<span class="sc">/</span><span class="fu">sum</span>(confusion.matrix[<span class="dv">1</span>,])</span>
<span id="cb143-12"><a href="#cb143-12" aria-hidden="true" tabindex="-1"></a>  tpr.all <span class="ot">&lt;-</span> <span class="fu">append</span>(tpr.all, tpr)</span>
<span id="cb143-13"><a href="#cb143-13" aria-hidden="true" tabindex="-1"></a>  fpr.all <span class="ot">&lt;-</span> <span class="fu">append</span>(fpr.all, fpr)</span>
<span id="cb143-14"><a href="#cb143-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb143-15"><a href="#cb143-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-16"><a href="#cb143-16" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tpr.all <span class="sc">~</span> fpr.all, <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb143-17"><a href="#cb143-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),</span>
<span id="cb143-18"><a href="#cb143-18" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb143-19"><a href="#cb143-19" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(tpr.all[<span class="dv">1</span>] <span class="sc">~</span> fpr.all[<span class="dv">1</span>], <span class="at">pch =</span> <span class="dv">15</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb143-20"><a href="#cb143-20" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(tpr.all[<span class="dv">2</span>] <span class="sc">~</span> fpr.all[<span class="dv">2</span>], <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb143-21"><a href="#cb143-21" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(tpr.all[<span class="dv">3</span>] <span class="sc">~</span> fpr.all[<span class="dv">3</span>], <span class="at">pch =</span> <span class="dv">17</span>, <span class="at">col =</span> <span class="st">"green"</span>)</span>
<span id="cb143-22"><a href="#cb143-22" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="fl">0.7</span>,<span class="fl">0.4</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">"sigma = 0.3"</span>, <span class="st">"sigma = 0.6"</span>, <span class="st">"sigma = 0.8"</span>),</span>
<span id="cb143-23"><a href="#cb143-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span><span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"green"</span>), <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">15</span>,<span class="dv">16</span>,<span class="dv">17</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>(b) Can we add the two points (0,0) and (1,1) to the plot of <span class="math inline">\(TPR\)</span> against <span class="math inline">\(FPR\)</span> in part (a). Explain why or why not.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co"># If σ &gt; 0.9 then all test points have predicted ˆG = 0 (predicted as negative), </span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a><span class="co"># so TPR = FPR = 0.</span></span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a><span class="co"># If σ &lt; 0.1, then all test points have predicted ˆG = 1 (predicted as positive),</span></span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a><span class="co"># so TPR = FPR = 1.</span></span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Since there exist σ within the range from 0 to 1 for the two points to happen, </span></span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a><span class="co"># these two points can be added to the plot.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
<li><p>The CSV file <code>Caravan.csv</code> contains data on 5822 real customer records on caravan insurance purchase. This data set is owned and supplied by the Dutch data mining company, Sentient Machine Research, and is based on real world business data. Each record consists of 86 variables, containing sociodemographic data (variables 1-43) and product ownership (variables 44-86). Variable 86 (<code>Purchase</code>) indicates whether the customer purchased a caravan insurance policy. For this business, assume that the overall error rate (equivalently, the accuracy) is not of interest. Instead, the company wants to use the classier to predict who are the potential customers likely to purchase insurance. Then the metric precision will be important, since it relates the proportion of Individuals who will actually purchase the insurance, among the group of individuals who are predicted to purchase insurance.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>cara <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Caravan.csv"</span>)</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(cara, <span class="at">n =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  X MOSTYPE MAANTHUI MGEMOMV MGEMLEEF MOSHOOFD MGODRK MGODPR MGODOV MGODGE
1 1      33        1       3        2        8      0      5      1      3
2 2      37        1       2        2        8      1      4      1      4
  MRELGE MRELSA MRELOV MFALLEEN MFGEKIND MFWEKIND MOPLHOOG MOPLMIDD MOPLLAAG
1      7      0      2        1        2        6        1        2        7
2      6      2      2        0        4        5        0        5        4
  MBERHOOG MBERZELF MBERBOER MBERMIDD MBERARBG MBERARBO MSKA MSKB1 MSKB2 MSKC
1        1        0        1        2        5        2    1     1     2    6
2        0        0        0        5        0        4    0     2     3    5
  MSKD MHHUUR MHKOOP MAUT1 MAUT2 MAUT0 MZFONDS MZPART MINKM30 MINK3045 MINK4575
1    1      1      8     8     0     1       8      1       0        4        5
2    0      2      7     7     1     2       6      3       2        0        5
  MINK7512 MINK123M MINKGEM MKOOPKLA PWAPART PWABEDR PWALAND PPERSAUT PBESAUT
1        0        0       4        3       0       0       0        6       0
2        2        0       5        4       2       0       0        0       0
  PMOTSCO PVRAAUT PAANHANG PTRACTOR PWERKT PBROM PLEVEN PPERSONG PGEZONG
1       0       0        0        0      0     0      0        0       0
2       0       0        0        0      0     0      0        0       0
  PWAOREG PBRAND PZEILPL PPLEZIER PFIETS PINBOED PBYSTAND AWAPART AWABEDR
1       0      5       0        0      0       0        0       0       0
2       0      2       0        0      0       0        0       2       0
  AWALAND APERSAUT ABESAUT AMOTSCO AVRAAUT AAANHANG ATRACTOR AWERKT ABROM
1       0        1       0       0       0        0        0      0     0
2       0        0       0       0       0        0        0      0     0
  ALEVEN APERSONG AGEZONG AWAOREG ABRAND AZEILPL APLEZIER AFIETS AINBOED
1      0        0       0       0      1       0        0      0       0
2      0        0       0       0      1       0        0      0       0
  ABYSTAND Purchase
1        0       No
2        0       No</code></pre>
</div>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(cara)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   5822 obs. of  87 variables:
 $ X       : int  1 2 3 4 5 6 7 8 9 10 ...
 $ MOSTYPE : int  33 37 37 9 40 23 39 33 33 11 ...
 $ MAANTHUI: int  1 1 1 1 1 1 2 1 1 2 ...
 $ MGEMOMV : int  3 2 2 3 4 2 3 2 2 3 ...
 $ MGEMLEEF: int  2 2 2 3 2 1 2 3 4 3 ...
 $ MOSHOOFD: int  8 8 8 3 10 5 9 8 8 3 ...
 $ MGODRK  : int  0 1 0 2 1 0 2 0 0 3 ...
 $ MGODPR  : int  5 4 4 3 4 5 2 7 1 5 ...
 $ MGODOV  : int  1 1 2 2 1 0 0 0 3 0 ...
 $ MGODGE  : int  3 4 4 4 4 5 5 2 6 2 ...
 $ MRELGE  : int  7 6 3 5 7 0 7 7 6 7 ...
 $ MRELSA  : int  0 2 2 2 1 6 2 2 0 0 ...
 $ MRELOV  : int  2 2 4 2 2 3 0 0 3 2 ...
 $ MFALLEEN: int  1 0 4 2 2 3 0 0 3 2 ...
 $ MFGEKIND: int  2 4 4 3 4 5 3 5 3 2 ...
 $ MFWEKIND: int  6 5 2 4 4 2 6 4 3 6 ...
 $ MOPLHOOG: int  1 0 0 3 5 0 0 0 0 0 ...
 $ MOPLMIDD: int  2 5 5 4 4 5 4 3 1 4 ...
 $ MOPLLAAG: int  7 4 4 2 0 4 5 6 8 5 ...
 $ MBERHOOG: int  1 0 0 4 0 2 0 2 1 2 ...
 $ MBERZELF: int  0 0 0 0 5 0 0 0 1 0 ...
 $ MBERBOER: int  1 0 0 0 4 0 0 0 0 0 ...
 $ MBERMIDD: int  2 5 7 3 0 4 4 2 1 3 ...
 $ MBERARBG: int  5 0 0 1 0 2 1 5 8 3 ...
 $ MBERARBO: int  2 4 2 2 0 2 5 2 1 3 ...
 $ MSKA    : int  1 0 0 3 9 2 0 2 1 1 ...
 $ MSKB1   : int  1 2 5 2 0 2 1 1 1 2 ...
 $ MSKB2   : int  2 3 0 1 0 2 4 2 0 1 ...
 $ MSKC    : int  6 5 4 4 0 4 5 5 8 4 ...
 $ MSKD    : int  1 0 0 0 0 2 0 2 1 2 ...
 $ MHHUUR  : int  1 2 7 5 4 9 6 0 9 0 ...
 $ MHKOOP  : int  8 7 2 4 5 0 3 9 0 9 ...
 $ MAUT1   : int  8 7 7 9 6 5 8 4 5 6 ...
 $ MAUT2   : int  0 1 0 0 2 3 0 4 2 1 ...
 $ MAUT0   : int  1 2 2 0 1 3 1 2 3 2 ...
 $ MZFONDS : int  8 6 9 7 5 9 9 6 7 6 ...
 $ MZPART  : int  1 3 0 2 4 0 0 3 2 3 ...
 $ MINKM30 : int  0 2 4 1 0 5 4 2 7 2 ...
 $ MINK3045: int  4 0 5 5 0 2 3 5 2 3 ...
 $ MINK4575: int  5 5 0 3 9 3 3 3 1 3 ...
 $ MINK7512: int  0 2 0 0 0 0 0 0 0 1 ...
 $ MINK123M: int  0 0 0 0 0 0 0 0 0 0 ...
 $ MINKGEM : int  4 5 3 4 6 3 3 3 2 4 ...
 $ MKOOPKLA: int  3 4 4 4 3 3 5 3 3 7 ...
 $ PWAPART : int  0 2 2 0 0 0 0 0 0 2 ...
 $ PWABEDR : int  0 0 0 0 0 0 0 0 0 0 ...
 $ PWALAND : int  0 0 0 0 0 0 0 0 0 0 ...
 $ PPERSAUT: int  6 0 6 6 0 6 6 0 5 0 ...
 $ PBESAUT : int  0 0 0 0 0 0 0 0 0 0 ...
 $ PMOTSCO : int  0 0 0 0 0 0 0 0 0 0 ...
 $ PVRAAUT : int  0 0 0 0 0 0 0 0 0 0 ...
 $ PAANHANG: int  0 0 0 0 0 0 0 0 0 0 ...
 $ PTRACTOR: int  0 0 0 0 0 0 0 0 0 0 ...
 $ PWERKT  : int  0 0 0 0 0 0 0 0 0 0 ...
 $ PBROM   : int  0 0 0 0 0 0 0 3 0 0 ...
 $ PLEVEN  : int  0 0 0 0 0 0 0 0 0 0 ...
 $ PPERSONG: int  0 0 0 0 0 0 0 0 0 0 ...
 $ PGEZONG : int  0 0 0 0 0 0 0 0 0 0 ...
 $ PWAOREG : int  0 0 0 0 0 0 0 0 0 0 ...
 $ PBRAND  : int  5 2 2 2 6 0 0 0 0 3 ...
 $ PZEILPL : int  0 0 0 0 0 0 0 0 0 0 ...
 $ PPLEZIER: int  0 0 0 0 0 0 0 0 0 0 ...
 $ PFIETS  : int  0 0 0 0 0 0 0 0 0 0 ...
 $ PINBOED : int  0 0 0 0 0 0 0 0 0 0 ...
 $ PBYSTAND: int  0 0 0 0 0 0 0 0 0 0 ...
 $ AWAPART : int  0 2 1 0 0 0 0 0 0 1 ...
 $ AWABEDR : int  0 0 0 0 0 0 0 0 0 0 ...
 $ AWALAND : int  0 0 0 0 0 0 0 0 0 0 ...
 $ APERSAUT: int  1 0 1 1 0 1 1 0 1 0 ...
 $ ABESAUT : int  0 0 0 0 0 0 0 0 0 0 ...
 $ AMOTSCO : int  0 0 0 0 0 0 0 0 0 0 ...
 $ AVRAAUT : int  0 0 0 0 0 0 0 0 0 0 ...
 $ AAANHANG: int  0 0 0 0 0 0 0 0 0 0 ...
 $ ATRACTOR: int  0 0 0 0 0 0 0 0 0 0 ...
 $ AWERKT  : int  0 0 0 0 0 0 0 0 0 0 ...
 $ ABROM   : int  0 0 0 0 0 0 0 1 0 0 ...
 $ ALEVEN  : int  0 0 0 0 0 0 0 0 0 0 ...
 $ APERSONG: int  0 0 0 0 0 0 0 0 0 0 ...
 $ AGEZONG : int  0 0 0 0 0 0 0 0 0 0 ...
 $ AWAOREG : int  0 0 0 0 0 0 0 0 0 0 ...
 $ ABRAND  : int  1 1 1 1 1 0 0 0 0 1 ...
 $ AZEILPL : int  0 0 0 0 0 0 0 0 0 0 ...
 $ APLEZIER: int  0 0 0 0 0 0 0 0 0 0 ...
 $ AFIETS  : int  0 0 0 0 0 0 0 0 0 0 ...
 $ AINBOED : int  0 0 0 0 0 0 0 0 0 0 ...
 $ ABYSTAND: int  0 0 0 0 0 0 0 0 0 0 ...
 $ Purchase: chr  "No" "No" "No" "No" ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(cara)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5822   87</code></pre>
</div>
</div>
<p>(a) Without any classier, if the company tries to sell insurance to a random selection of customers, what is the success rate?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(cara<span class="sc">$</span>Purchase)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  No  Yes 
5474  348 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>succesRate <span class="ot">&lt;-</span> <span class="fu">table</span>(cara<span class="sc">$</span>Purchase)[<span class="dv">2</span>]<span class="sc">/</span><span class="fu">sum</span>(<span class="fu">table</span>(cara<span class="sc">$</span>Purchase))</span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>succesRate</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Yes 
0.05977327 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="co"># data set shows almost 6% of people purchased insurance</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(b) Standardize the input features. <span class="math inline">\(Hint\)</span>: Use <code>scale()</code> command in R.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>cara <span class="ot">&lt;-</span> cara[,<span class="sc">-</span><span class="dv">1</span>] <span class="co">#throwing the first column since it provides no information</span></span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>scaled.X <span class="ot">&lt;-</span> <span class="fu">scale</span>(cara[,<span class="sc">-</span><span class="dv">86</span>]) <span class="co">#throwing the response column</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(c) Randomly select 1000 observations to form the test data, and the remaining observations will be the training data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">5</span>)</span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">dim</span>(cara)[<span class="dv">1</span>] <span class="co">#train data number</span></span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a>shuffled.index <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>n), <span class="at">size =</span> <span class="dv">1000</span>)</span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a>X.train <span class="ot">&lt;-</span> scaled.X[<span class="sc">-</span>shuffled.index,]</span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a>X.test<span class="ot">&lt;-</span> scaled.X[shuffled.index,]</span>
<span id="cb157-6"><a href="#cb157-6" aria-hidden="true" tabindex="-1"></a>Y.train <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(cara<span class="sc">$</span>Purchase[<span class="sc">-</span>shuffled.index])</span>
<span id="cb157-7"><a href="#cb157-7" aria-hidden="true" tabindex="-1"></a>Y.test <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(cara<span class="sc">$</span>Purchase[shuffled.index])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(d) Use 1-nearest neighbor classier for the training data to predict if a customer will purchase insurance. Compute the precision of the classier.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(class)</span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">knn</span>(X.train, X.test, Y.train, <span class="at">k=</span><span class="dv">1</span>)</span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a>confusion.matrix <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, pred) </span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Precision = TP/TP+FP</span></span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a>precision <span class="ot">&lt;-</span> confusion.matrix[<span class="dv">2</span>,<span class="dv">2</span>]<span class="sc">/</span><span class="fu">sum</span>(confusion.matrix[,<span class="dv">2</span>])</span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true" tabindex="-1"></a>confusion.matrix</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      pred
Y.test  No Yes
   No  892  55
   Yes  44   9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a>precision</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.140625</code></pre>
</div>
</div>
<p>(e) Repeat question 3d, for k-nearest neighbor classier where k = 3,5,10. Which value of k gives the best precision?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>precision.all <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>k.list <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> k.list) {</span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a>  pred <span class="ot">&lt;-</span> <span class="fu">knn</span>(X.train, X.test, Y.train, <span class="at">k =</span> k)</span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a>  confusion.matrix <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, pred) </span>
<span id="cb162-6"><a href="#cb162-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Precision = TP/TP+FP</span></span>
<span id="cb162-7"><a href="#cb162-7" aria-hidden="true" tabindex="-1"></a>  precision <span class="ot">&lt;-</span> confusion.matrix[<span class="dv">2</span>,<span class="dv">2</span>]<span class="sc">/</span><span class="fu">sum</span>(confusion.matrix[,<span class="dv">2</span>])</span>
<span id="cb162-8"><a href="#cb162-8" aria-hidden="true" tabindex="-1"></a>  precision.all <span class="ot">&lt;-</span> <span class="fu">rbind</span>(precision.all, <span class="fu">data.frame</span>(k, precision))</span>
<span id="cb162-9"><a href="#cb162-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb162-10"><a href="#cb162-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb162-11"><a href="#cb162-11" aria-hidden="true" tabindex="-1"></a>precision.all</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   k  precision
1  3 0.05263158
2  5 0.14285714
3 10        NaN</code></pre>
</div>
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="co"># So far, k = 5 gives the best precision.</span></span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a><span class="co"># However, one might use N -fold cross validation </span></span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a><span class="co"># to have the average precision for each k.</span></span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true" tabindex="-1"></a><span class="co"># With that, the value of k that gives largest average precision is chosen.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
</ol>
</section>
<section id="onsite-questions-knn-mathematics" class="level3">
<h3 class="anchored" data-anchor-id="onsite-questions-knn-mathematics">Onsite Questions (KNN Mathematics)</h3>
<ol type="1">
<li>The k-nearest neighbor classifier</li>
</ol>
<p>The table below provides a training data set containing six observations, three predictors, and one qualitative response variable, y.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Obs</th>
<th><span class="math inline">\(X_1\)</span></th>
<th><span class="math inline">\(X_2\)</span></th>
<th><span class="math inline">\(X_3\)</span></th>
<th>Y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>0</td>
<td>3</td>
<td>0</td>
<td>Red</td>
</tr>
<tr class="even">
<td>2</td>
<td>2</td>
<td>0</td>
<td>0</td>
<td>Red</td>
</tr>
<tr class="odd">
<td>3</td>
<td>0</td>
<td>1</td>
<td>3</td>
<td>Red</td>
</tr>
<tr class="even">
<td>4</td>
<td>0</td>
<td>1</td>
<td>2</td>
<td>Green</td>
</tr>
<tr class="odd">
<td>5</td>
<td>-1</td>
<td>0</td>
<td>1</td>
<td>Green</td>
</tr>
<tr class="even">
<td>6</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>Red</td>
</tr>
</tbody>
</table>
<p>Suppose we wish to use this data set to make a prediction for a new observation with response Y given that it has <span class="math inline">\(X_1 = X_2 = X_3 = 0\)</span> using K-nearest neighbors.</p>
<p>(a) Compute the Euclidean distance between each observation and the test point, <span class="math inline">\(X_1 = X_2 = X_3 = 0\)</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a>X3 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Red"</span>, <span class="st">"Red"</span>, <span class="st">"Red"</span>, <span class="st">"Green"</span>, <span class="st">"Green"</span>, <span class="st">"Red"</span>)</span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true" tabindex="-1"></a>dataframe <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(X1, X2, X3, Y)</span>
<span id="cb165-6"><a href="#cb165-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-7"><a href="#cb165-7" aria-hidden="true" tabindex="-1"></a>dataframe<span class="sc">$</span>distance <span class="ot">&lt;-</span> </span>
<span id="cb165-8"><a href="#cb165-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sqrt</span>(</span>
<span id="cb165-9"><a href="#cb165-9" aria-hidden="true" tabindex="-1"></a>        dataframe<span class="sc">$</span>X1<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> </span>
<span id="cb165-10"><a href="#cb165-10" aria-hidden="true" tabindex="-1"></a>        dataframe<span class="sc">$</span>X2<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> </span>
<span id="cb165-11"><a href="#cb165-11" aria-hidden="true" tabindex="-1"></a>        dataframe<span class="sc">$</span>X3<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb165-12"><a href="#cb165-12" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb165-13"><a href="#cb165-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb165-14"><a href="#cb165-14" aria-hidden="true" tabindex="-1"></a>dataframe <span class="ot">&lt;-</span> dataframe[<span class="fu">order</span>(dataframe<span class="sc">$</span>distance),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(b) What is our prediction with K=1? Why?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prediction for K = 1 is </span></span>
<span id="cb166-2"><a href="#cb166-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Green as the one nearest </span></span>
<span id="cb166-3"><a href="#cb166-3" aria-hidden="true" tabindex="-1"></a><span class="co"># point is also Green. Thus,</span></span>
<span id="cb166-4"><a href="#cb166-4" aria-hidden="true" tabindex="-1"></a><span class="co"># by majority vote, KNN </span></span>
<span id="cb166-5"><a href="#cb166-5" aria-hidden="true" tabindex="-1"></a><span class="co"># classifies the new data</span></span>
<span id="cb166-6"><a href="#cb166-6" aria-hidden="true" tabindex="-1"></a><span class="co"># point as Green.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br>
(c) What is our prediction with K=3? Why?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prediction for K = 3 is </span></span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Red as 2/3 of the nearest</span></span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a><span class="co"># points are Red, with one </span></span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Green point. Thus,</span></span>
<span id="cb167-5"><a href="#cb167-5" aria-hidden="true" tabindex="-1"></a><span class="co"># by majority vote, KNN </span></span>
<span id="cb167-6"><a href="#cb167-6" aria-hidden="true" tabindex="-1"></a><span class="co"># classifies the new data</span></span>
<span id="cb167-7"><a href="#cb167-7" aria-hidden="true" tabindex="-1"></a><span class="co"># point as Red.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br>
(d) If the Bayes decision boundary (the gold standard decision boundary) in this problem is highly non-linear, then would we expect the best value for KKK to be large or small? Why?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We would expect the best</span></span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a><span class="co"># value of K to be small, </span></span>
<span id="cb168-3"><a href="#cb168-3" aria-hidden="true" tabindex="-1"></a><span class="co"># since it translates to </span></span>
<span id="cb168-4"><a href="#cb168-4" aria-hidden="true" tabindex="-1"></a><span class="co"># a more flexible </span></span>
<span id="cb168-5"><a href="#cb168-5" aria-hidden="true" tabindex="-1"></a><span class="co"># classification method.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="t6-decision-trees" class="level2">
<h2 class="anchored" data-anchor-id="t6-decision-trees">T6 (Decision Trees)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit &lt;- rpart(...)</span></span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict using decision trees</span></span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a><span class="co">#predict(fit, newdata, type = "class") # Classification</span></span>
<span id="cb169-5"><a href="#cb169-5" aria-hidden="true" tabindex="-1"></a><span class="co">#predict(fit, newdata, type = "prob") # Raw probability</span></span>
<span id="cb169-6"><a href="#cb169-6" aria-hidden="true" tabindex="-1"></a><span class="co"># **No need to remove features</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="offsite-questions-knn-tuning-n-fold-cv-decision-trees" class="level3">
<h3 class="anchored" data-anchor-id="offsite-questions-knn-tuning-n-fold-cv-decision-trees">Offsite Questions (KNN Tuning, N-fold CV, Decision Trees)</h3>
<ol type="1">
<li><p><em>(KNN and N -fold Cross Validation)</em></p>
<p>Loan managers often need to take into account an applicant’s demographic and socioeconomic proles in deciding whether to approve a loan to the applicant, to minimize losses due to defaults. In this exercise we will build and evaluate a classier based on the German Credit Data to predict whether an applicant is considered as having good or bad credit risk. The features or predictors include (1) loan duration (in months), (2) credit amount, (3) Installment rate in percentage of disposable income and (4) age in years.</p>
<p>(a) Read and explore the data from the file <code>German_credit.csv</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"German_credit.csv"</span>)</span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Creditability Duration Amount Instalment Age
1             1       18   1049          4  21
2             1        9   2799          2  36
3             1       12    841          2  23
4             1       12   2122          3  39
5             1       12   2171          4  38
6             1       10   2241          1  48</code></pre>
</div>
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   1000 obs. of  5 variables:
 $ Creditability: int  1 1 1 1 1 1 1 1 1 1 ...
 $ Duration     : int  18 9 12 12 12 10 8 6 18 24 ...
 $ Amount       : int  1049 2799 841 2122 2171 2241 3398 1361 1098 3758 ...
 $ Instalment   : int  4 2 2 3 4 1 1 2 4 1 ...
 $ Age          : int  21 36 23 39 38 48 39 40 65 23 ...</code></pre>
</div>
</div>
<p>(b) Standardize the input features.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">scale</span>(data[<span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> data<span class="sc">$</span>Creditability</span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(X)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Duration     Amount  Instalment         Age
[1,] -0.2407368 -0.7872630  0.91801781 -1.28093214
[2,] -0.9870788 -0.1673006 -0.86974813  0.04034293
[3,] -0.7382981 -0.8609500 -0.86974813 -1.10476213
[4,] -0.7382981 -0.4071375  0.02413484  0.30459795
[5,] -0.7382981 -0.3897785  0.91801781  0.21651294
[6,] -0.9041519 -0.3649800 -1.76363111  1.09736299</code></pre>
</div>
</div>
<p>(c) Randomly select 800 customer records to form the training data, and the remaining 200 records will be the test data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">dim</span>(data)[<span class="dv">1</span>]</span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a>index <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="dv">800</span>)</span>
<span id="cb176-4"><a href="#cb176-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-5"><a href="#cb176-5" aria-hidden="true" tabindex="-1"></a>training.X <span class="ot">&lt;-</span> X[index, ]</span>
<span id="cb176-6"><a href="#cb176-6" aria-hidden="true" tabindex="-1"></a>test.X <span class="ot">&lt;-</span> X[<span class="sc">-</span>index, ]</span>
<span id="cb176-7"><a href="#cb176-7" aria-hidden="true" tabindex="-1"></a>training.Y <span class="ot">&lt;-</span> Y[index]</span>
<span id="cb176-8"><a href="#cb176-8" aria-hidden="true" tabindex="-1"></a>test.Y <span class="ot">&lt;-</span> Y[<span class="sc">-</span>index]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(d) Use 1-nearest neighbor classier for the training data to predict if a loan applicant is credible for the 200 test points. Compute the accuracy of the classier.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb177"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(class)</span>
<span id="cb177-2"><a href="#cb177-2" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">knn</span>(training.X, test.X, training.Y, <span class="at">k=</span><span class="dv">1</span>)</span>
<span id="cb177-3"><a href="#cb177-3" aria-hidden="true" tabindex="-1"></a>confusion.matrix <span class="ot">&lt;-</span> <span class="fu">table</span>(test.Y, pred)</span>
<span id="cb177-4"><a href="#cb177-4" aria-hidden="true" tabindex="-1"></a>confusion.matrix</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      pred
test.Y  0  1
     0 24 35
     1 47 94</code></pre>
</div>
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a>accuracy <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">diag</span>(confusion.matrix))<span class="sc">/</span><span class="fu">sum</span>(confusion.matrix)</span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a>accuracy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.59</code></pre>
</div>
</div>
<p>(e) Use N -folds cross validation with N = 5 to find the average accuracy for the 1-nearest neighbor classifier.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(class)</span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb181-3"><a href="#cb181-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-4"><a href="#cb181-4" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"German_credit.csv"</span>)</span>
<span id="cb181-5"><a href="#cb181-5" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">scale</span>(data[<span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb181-6"><a href="#cb181-6" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> data<span class="sc">$</span>Creditability</span>
<span id="cb181-7"><a href="#cb181-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-8"><a href="#cb181-8" aria-hidden="true" tabindex="-1"></a>n_folds <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb181-9"><a href="#cb181-9" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(Y)</span>
<span id="cb181-10"><a href="#cb181-10" aria-hidden="true" tabindex="-1"></a>folds_j <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n_folds, <span class="at">length.out =</span> n ))</span>
<span id="cb181-11"><a href="#cb181-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-12"><a href="#cb181-12" aria-hidden="true" tabindex="-1"></a>accuracy <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_folds)</span>
<span id="cb181-13"><a href="#cb181-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_folds) {</span>
<span id="cb181-14"><a href="#cb181-14" aria-hidden="true" tabindex="-1"></a>  test_j <span class="ot">&lt;-</span> <span class="fu">which</span>(folds_j <span class="sc">==</span> j) </span>
<span id="cb181-15"><a href="#cb181-15" aria-hidden="true" tabindex="-1"></a>  test.y <span class="ot">&lt;-</span> Y[test_j] </span>
<span id="cb181-16"><a href="#cb181-16" aria-hidden="true" tabindex="-1"></a>  train.X <span class="ot">&lt;-</span> X[<span class="sc">-</span>test_j, ]  </span>
<span id="cb181-17"><a href="#cb181-17" aria-hidden="true" tabindex="-1"></a>  test.X <span class="ot">&lt;-</span> X[test_j, ]  </span>
<span id="cb181-18"><a href="#cb181-18" aria-hidden="true" tabindex="-1"></a>  train.y <span class="ot">&lt;-</span> Y[<span class="sc">-</span>test_j] </span>
<span id="cb181-19"><a href="#cb181-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-20"><a href="#cb181-20" aria-hidden="true" tabindex="-1"></a>  knn.pred <span class="ot">&lt;-</span> <span class="fu">knn</span>(train.X, test.X, train.y, <span class="at">k =</span> <span class="dv">1</span>) </span>
<span id="cb181-21"><a href="#cb181-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-22"><a href="#cb181-22" aria-hidden="true" tabindex="-1"></a>  confusion.matrix <span class="ot">&lt;-</span> <span class="fu">table</span>(test.y, knn.pred)</span>
<span id="cb181-23"><a href="#cb181-23" aria-hidden="true" tabindex="-1"></a>  accuracy[j] <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">diag</span>(confusion.matrix))<span class="sc">/</span><span class="fu">sum</span>(confusion.matrix)</span>
<span id="cb181-24"><a href="#cb181-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb181-25"><a href="#cb181-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb181-26"><a href="#cb181-26" aria-hidden="true" tabindex="-1"></a>ave.accuracy <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">mean</span>(accuracy), <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb181-27"><a href="#cb181-27" aria-hidden="true" tabindex="-1"></a>ave.accuracy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.622</code></pre>
</div>
</div>
<p>(f) Repeat question 1e for K-nearest neighbor classifiers where K = 1, 2, …100.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="do">### FULL KNN WITH N-FOLDS VALIDATION</span></span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(class)</span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb183-4"><a href="#cb183-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-5"><a href="#cb183-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"German_credit.csv"</span>)</span>
<span id="cb183-6"><a href="#cb183-6" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">scale</span>(data[<span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb183-7"><a href="#cb183-7" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> data<span class="sc">$</span>Creditability</span>
<span id="cb183-8"><a href="#cb183-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-9"><a href="#cb183-9" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb183-10"><a href="#cb183-10" aria-hidden="true" tabindex="-1"></a>n_folds <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb183-11"><a href="#cb183-11" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(Y)</span>
<span id="cb183-12"><a href="#cb183-12" aria-hidden="true" tabindex="-1"></a>folds_j <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n_folds, <span class="at">length.out =</span> n ))</span>
<span id="cb183-13"><a href="#cb183-13" aria-hidden="true" tabindex="-1"></a>ave.accuracy <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(k))</span>
<span id="cb183-14"><a href="#cb183-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-15"><a href="#cb183-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb183-16"><a href="#cb183-16" aria-hidden="true" tabindex="-1"></a>  accuracy <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_folds)</span>
<span id="cb183-17"><a href="#cb183-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_folds) {</span>
<span id="cb183-18"><a href="#cb183-18" aria-hidden="true" tabindex="-1"></a>    test_j <span class="ot">&lt;-</span> <span class="fu">which</span>(folds_j <span class="sc">==</span> j) </span>
<span id="cb183-19"><a href="#cb183-19" aria-hidden="true" tabindex="-1"></a>    test.y <span class="ot">&lt;-</span> Y[test_j] </span>
<span id="cb183-20"><a href="#cb183-20" aria-hidden="true" tabindex="-1"></a>    train.X <span class="ot">&lt;-</span> X[<span class="sc">-</span>test_j, ]  </span>
<span id="cb183-21"><a href="#cb183-21" aria-hidden="true" tabindex="-1"></a>    test.X <span class="ot">&lt;-</span> X[test_j, ]  </span>
<span id="cb183-22"><a href="#cb183-22" aria-hidden="true" tabindex="-1"></a>    train.y <span class="ot">&lt;-</span> Y[<span class="sc">-</span>test_j] </span>
<span id="cb183-23"><a href="#cb183-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-24"><a href="#cb183-24" aria-hidden="true" tabindex="-1"></a>    knn.pred <span class="ot">&lt;-</span> <span class="fu">knn</span>(train.X, test.X, train.y, <span class="at">k =</span> i) </span>
<span id="cb183-25"><a href="#cb183-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-26"><a href="#cb183-26" aria-hidden="true" tabindex="-1"></a>    confusion.matrix<span class="ot">=</span><span class="fu">table</span>(test.y, knn.pred)</span>
<span id="cb183-27"><a href="#cb183-27" aria-hidden="true" tabindex="-1"></a>    accuracy[j] <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">diag</span>(confusion.matrix))<span class="sc">/</span><span class="fu">sum</span>(confusion.matrix)</span>
<span id="cb183-28"><a href="#cb183-28" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb183-29"><a href="#cb183-29" aria-hidden="true" tabindex="-1"></a>  ave.accuracy[i] <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">mean</span>(accuracy), <span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb183-30"><a href="#cb183-30" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb183-31"><a href="#cb183-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb183-32"><a href="#cb183-32" aria-hidden="true" tabindex="-1"></a>ave.accuracy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] 0.622 0.597 0.661 0.674 0.684 0.671 0.676 0.686 0.686 0.691 0.702 0.699
 [13] 0.705 0.702 0.707 0.695 0.699 0.702 0.700 0.693 0.695 0.695 0.697 0.695
 [25] 0.699 0.697 0.696 0.700 0.693 0.688 0.697 0.692 0.697 0.698 0.697 0.692
 [37] 0.695 0.695 0.695 0.696 0.696 0.701 0.699 0.701 0.699 0.699 0.699 0.698
 [49] 0.699 0.696 0.698 0.699 0.699 0.696 0.695 0.699 0.696 0.697 0.696 0.698
 [61] 0.697 0.696 0.699 0.697 0.697 0.697 0.697 0.696 0.698 0.699 0.699 0.696
 [73] 0.698 0.697 0.698 0.696 0.698 0.698 0.698 0.699 0.699 0.698 0.698 0.700
 [85] 0.698 0.698 0.700 0.700 0.699 0.700 0.700 0.701 0.701 0.701 0.700 0.700
 [97] 0.699 0.698 0.699 0.699</code></pre>
</div>
</div>
<p>(g) Compare the 100 classifiers above, which few values of K give the best average accuracy?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glue)</span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a>index <span class="ot">=</span> <span class="fu">which</span>(ave.accuracy <span class="sc">==</span> <span class="fu">max</span>(ave.accuracy))</span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span>k, ave.accuracy)</span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> index, <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-65-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb186"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glue</span>(<span class="st">"most accurate k = {index} with average accuracy = {ave.accuracy[index]}"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>most accurate k = 15 with average accuracy = 0.707</code></pre>
</div>
</div></li>
<li><p><em>(Decision Trees)</em></p>
<p>Consider the famous Iris Flower Data set which was rst introduced in 1936 by the famous statistician Ronald Fisher. This data set consists of 50 observations from each of three species of Iris (Iris setosa, Iris virginica and Iris versicolor). Four features were measured from each observation: the length and the width of the sepals and petals (in cm).</p>
<p>(a) Use decision tree method to predict Iris species based on all four features.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a>iris <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"iris.csv"</span>)</span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(iris)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  sepal.length sepal.width petal.length petal.width       class
1          5.1         3.5          1.4         0.2 Iris-setosa
2          4.9         3.0          1.4         0.2 Iris-setosa
3          4.7         3.2          1.3         0.2 Iris-setosa
4          4.6         3.1          1.5         0.2 Iris-setosa
5          5.0         3.6          1.4         0.2 Iris-setosa
6          5.4         3.9          1.7         0.4 Iris-setosa</code></pre>
</div>
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(iris)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   150 obs. of  5 variables:
 $ sepal.length: num  5.1 4.9 4.7 4.6 5 5.4 4.6 5 4.4 4.9 ...
 $ sepal.width : num  3.5 3 3.2 3.1 3.6 3.9 3.4 3.4 2.9 3.1 ...
 $ petal.length: num  1.4 1.4 1.3 1.5 1.4 1.7 1.4 1.5 1.4 1.5 ...
 $ petal.width : num  0.2 0.2 0.2 0.2 0.2 0.4 0.3 0.2 0.2 0.1 ...
 $ class       : chr  "Iris-setosa" "Iris-setosa" "Iris-setosa" "Iris-setosa" ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(iris)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 150   5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb194"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart)</span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">rpart</span>(class <span class="sc">~</span> sepal.length <span class="sc">+</span> sepal.width <span class="sc">+</span> petal.length <span class="sc">+</span> petal.width,</span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> iris,</span>
<span id="cb194-4"><a href="#cb194-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">method=</span><span class="st">"class"</span>,</span>
<span id="cb194-5"><a href="#cb194-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">parms=</span><span class="fu">list</span>(<span class="at">split=</span><span class="st">'information'</span>),</span>
<span id="cb194-6"><a href="#cb194-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">control =</span> <span class="fu">rpart.control</span>( <span class="at">minsplit =</span><span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(b) Visualize the decision tree above, using the <code>rpart.plot</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart.plot)</span>
<span id="cb195-2"><a href="#cb195-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rpart.plot</span>(fit, <span class="at">type=</span><span class="dv">4</span>, <span class="at">extra=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-67-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The fitted tree is given in the figure below.</span></span>
<span id="cb196-2"><a href="#cb196-2" aria-hidden="true" tabindex="-1"></a><span class="co"># If the measurement of petal length is less than 2.5 cm </span></span>
<span id="cb196-3"><a href="#cb196-3" aria-hidden="true" tabindex="-1"></a><span class="co"># then the flower is of Iris-setosa</span></span>
<span id="cb196-4"><a href="#cb196-4" aria-hidden="true" tabindex="-1"></a><span class="co"># If the petal length is ≥ 2.5 cm with the petal width is ≥ 1.8 cm </span></span>
<span id="cb196-5"><a href="#cb196-5" aria-hidden="true" tabindex="-1"></a><span class="co"># then high chance (45/46) it will be an Iris-virginica.</span></span>
<span id="cb196-6"><a href="#cb196-6" aria-hidden="true" tabindex="-1"></a><span class="co"># If the petal length is ≥ 2.5 cm with the petal width is &lt; 1.8 cm</span></span>
<span id="cb196-7"><a href="#cb196-7" aria-hidden="true" tabindex="-1"></a><span class="co"># then we continue to check if the petal length is in the interval</span></span>
<span id="cb196-8"><a href="#cb196-8" aria-hidden="true" tabindex="-1"></a><span class="co"># [2.5, 5]. If yes, then high chance (47/48) it is Iris-versicolor.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(c) What are the more important features in the fitted tree above?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb197"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="co"># It seems the sepal length and sepal width </span></span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a><span class="co"># are not important in the classification while</span></span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a><span class="co"># the petal length and petal width are more important.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
</ol>
</section>
</section>
<section id="t7-decision-trees-2" class="level2">
<h2 class="anchored" data-anchor-id="t7-decision-trees-2">T7 (Decision Trees 2)</h2>
<section id="offsite-questions-decision-trees-n-fold-cv" class="level3">
<h3 class="anchored" data-anchor-id="offsite-questions-decision-trees-n-fold-cv">Offsite Questions (Decision Trees, N-fold CV)</h3>
<p>(DT and N-fold Cross Validation)</p>
<p>Consider the famous Iris Flower Data set which was first introduced in 1936 by the famous statistician Ronald Fisher. This data set consists of 50 observations from each of three species of Iris (Iris setosa, Iris virginica, and Iris versicolor).</p>
<p>Four features were measured from each observation: the length and the width of the sepals and petals (in cm).</p>
<p><img src="images/clipboard-2361412568.png" class="img-fluid"></p>
<p>In Tutorial 6, we used the decision tree method to predict Iris species based on all four features. We now would want to use N-fold CV to check on how good the method is, based on the accuracy.</p>
<p>We’ll use 5-fold CV where we would want to keep the ratio of the three species the same (1:1:1) in both the training set and test set.</p>
<p>What’s the average accuracy of the decision tree method?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"iris.csv"</span>)</span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   150 obs. of  5 variables:
 $ sepal.length: num  5.1 4.9 4.7 4.6 5 5.4 4.6 5 4.4 4.9 ...
 $ sepal.width : num  3.5 3 3.2 3.1 3.6 3.9 3.4 3.4 2.9 3.1 ...
 $ petal.length: num  1.4 1.4 1.3 1.5 1.4 1.7 1.4 1.5 1.4 1.5 ...
 $ petal.width : num  0.2 0.2 0.2 0.2 0.2 0.4 0.3 0.2 0.2 0.1 ...
 $ class       : chr  "Iris-setosa" "Iris-setosa" "Iris-setosa" "Iris-setosa" ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df<span class="sc">$</span>class)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Iris-setosa Iris-versicolor  Iris-virginica 
             50              50              50 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1101</span>)</span>
<span id="cb202-2"><a href="#cb202-2" aria-hidden="true" tabindex="-1"></a>n_folds <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb202-3"><a href="#cb202-3" aria-hidden="true" tabindex="-1"></a>folds_indexes_1 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n_folds, <span class="at">length.out =</span> <span class="dv">50</span>))</span>
<span id="cb202-4"><a href="#cb202-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">table</span>(folds_indexes_1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>folds_indexes_1
 1  2  3  4  5 
10 10 10 10 10 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb204"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" aria-hidden="true" tabindex="-1"></a>folds_indexes_2 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n_folds, <span class="at">length.out =</span> <span class="dv">50</span>))</span>
<span id="cb204-2"><a href="#cb204-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">table</span>(folds_indexes_2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>folds_indexes_2
 1  2  3  4  5 
10 10 10 10 10 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a>folds_indexes_3 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n_folds, <span class="at">length.out =</span> <span class="dv">50</span>))</span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">table</span>(folds_indexes_3))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>folds_indexes_3
 1  2  3  4  5 
10 10 10 10 10 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a>folds_indexes <span class="ot">=</span> <span class="fu">c</span>(folds_indexes_1, folds_indexes_2, folds_indexes_3)</span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">table</span>(folds_indexes))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>folds_indexes
 1  2  3  4  5 
30 30 30 30 30 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(folds_indexes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] 3 5 3 2 3 1 5 4 2 2 1 3 5 1 4 5 2 3 4 4 5 3 5 1 4 1 1 4 4 2 2 5 1 2 3 2 3
 [38] 5 1 4 1 3 5 2 1 2 4 5 3 4 1 5 2 1 3 3 4 5 3 2 3 1 1 5 5 1 1 5 3 5 1 4 2 4
 [75] 3 3 1 4 1 4 4 2 2 2 5 1 2 4 5 3 4 4 3 2 5 2 2 5 4 3 5 5 2 4 2 2 5 4 3 3 1
[112] 1 5 4 4 5 3 3 3 2 4 1 1 2 1 3 4 2 1 5 4 1 1 5 4 5 3 5 1 2 2 2 4 1 2 4 3 3
[149] 5 3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb212"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a>accuracy <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_folds)</span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_folds) {</span>
<span id="cb212-3"><a href="#cb212-3" aria-hidden="true" tabindex="-1"></a>  test_indexes <span class="ot">&lt;-</span> <span class="fu">which</span>(i <span class="sc">==</span> folds_indexes)</span>
<span id="cb212-4"><a href="#cb212-4" aria-hidden="true" tabindex="-1"></a>  fit <span class="ot">&lt;-</span> <span class="fu">rpart</span>(class <span class="sc">~</span> ., <span class="at">method =</span> <span class="st">"class"</span>,</span>
<span id="cb212-5"><a href="#cb212-5" aria-hidden="true" tabindex="-1"></a>               data <span class="ot">&lt;-</span> df[<span class="sc">-</span>test_indexes,])</span>
<span id="cb212-6"><a href="#cb212-6" aria-hidden="true" tabindex="-1"></a>  prediction <span class="ot">=</span> <span class="fu">predict</span>(fit, df[test_indexes,],</span>
<span id="cb212-7"><a href="#cb212-7" aria-hidden="true" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">"class"</span>)</span>
<span id="cb212-8"><a href="#cb212-8" aria-hidden="true" tabindex="-1"></a>  accuracy[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(prediction <span class="sc">==</span> df<span class="sc">$</span>class[test_indexes])</span>
<span id="cb212-9"><a href="#cb212-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb212-10"><a href="#cb212-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-11"><a href="#cb212-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(accuracy)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9666667 0.9000000 1.0000000 0.9333333 0.9000000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">mean</span>(accuracy))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.94</code></pre>
</div>
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The average accuracy of the decision tree method is 0.94</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="onsite-questions-decision-trees-tuning-n-fold-cv" class="level3">
<h3 class="anchored" data-anchor-id="onsite-questions-decision-trees-tuning-n-fold-cv">Onsite Questions (Decision Trees Tuning, N-fold CV)</h3>
<p>(Decision Trees)</p>
<p>Customer churn is the loss of clients or customers. Banks, telephone service companies, Internet service providers, pay TV companies, and insurance firms often use customer churn analysis and customer churn rates as one of their key business metrics.</p>
<p>This is because the cost of retaining an existing customer is far less than acquiring a new one. Companies from these sectors often have customer service branches which attempt to win back defecting clients, because recovered long-term customers can be worth much more to a company than newly recruited clients.</p>
<p>In this problem, a wireless telecommunications company wants to predict whether a customer will churn (switch to a different company) in the next six months. With a reasonably accurate prediction of a person’s churning, the sales and marketing groups can attempt to retain the customer by offering various incentives. Variables of our concern are listed below.</p>
<p>(i) Age (years)</p>
<p>(ii) Married (true/false)</p>
<p>(iii) Duration as a customer (years)</p>
<p>(iv) Churned contacts - Number of the customer’s contacts that have churned (count)</p>
<p>(v) Churned (true/false) — Whether the customer churned</p>
<p>(a) Build a decision tree for predicting customer churn, using the feature variables Age, Married, Cust_years, and Churned_contacts.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb217-2"><a href="#cb217-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"churn.csv"</span>)</span>
<span id="cb217-3"><a href="#cb217-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   8000 obs. of  6 variables:
 $ ID              : int  1 2 3 4 5 6 7 8 9 10 ...
 $ Churned         : int  0 0 0 0 0 0 0 0 0 0 ...
 $ Age             : int  61 50 47 50 29 43 50 29 32 48 ...
 $ Married         : int  1 1 1 1 1 1 0 0 1 1 ...
 $ Cust_years      : int  3 3 2 3 1 4 2 3 3 4 ...
 $ Churned_contacts: int  1 2 0 3 3 3 1 2 3 0 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>Churned <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df<span class="sc">$</span>Churned)</span>
<span id="cb219-2"><a href="#cb219-2" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>Married <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(df<span class="sc">$</span>Married)</span>
<span id="cb219-3"><a href="#cb219-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-4"><a href="#cb219-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-5"><a href="#cb219-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart)</span>
<span id="cb219-6"><a href="#cb219-6" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">rpart</span>(Churned <span class="sc">~</span> Age <span class="sc">+</span> Married <span class="sc">+</span> Cust_years <span class="sc">+</span> Churned_contacts, </span>
<span id="cb219-7"><a href="#cb219-7" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> df,</span>
<span id="cb219-8"><a href="#cb219-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">method =</span> <span class="st">"class"</span>,</span>
<span id="cb219-9"><a href="#cb219-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">parms =</span> <span class="fu">list</span>(<span class="at">split =</span> <span class="st">'information'</span>),</span>
<span id="cb219-10"><a href="#cb219-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">control =</span> <span class="fu">rpart.control</span>(<span class="at">minsplit =</span> <span class="dv">1</span>))</span>
<span id="cb219-11"><a href="#cb219-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-12"><a href="#cb219-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart.plot)</span>
<span id="cb219-13"><a href="#cb219-13" aria-hidden="true" tabindex="-1"></a><span class="fu">rpart.plot</span>(fit, <span class="at">type=</span><span class="dv">4</span>, <span class="at">extra=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-72-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>(b) Consider the decision tree in part (a) to predict binary variable Churned. Use the tree to predict customer churn for the following observations.</p>
<p><img src="images/clipboard-683929762.png" class="img-fluid"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb220"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" aria-hidden="true" tabindex="-1"></a>index <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2821</span>, <span class="dv">96</span>, <span class="dv">5085</span>, <span class="dv">758</span>, <span class="dv">487</span>, <span class="dv">987</span>, <span class="dv">6061</span>, <span class="dv">3745</span>, <span class="dv">4709</span>, <span class="dv">2769</span>)</span>
<span id="cb220-2"><a href="#cb220-2" aria-hidden="true" tabindex="-1"></a>df[index,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       ID Churned Age Married Cust_years Churned_contacts
2821 2821       0  26       1          2                2
96     96       1  23       1          3                3
5085 5085       0  56       1          5                2
758   758       0  36       1          5                2
487   487       0  45       0          2                1
987   987       0  28       0          2                2
6061 6061       0  22       1          3                0
3745 3745       0  22       0          3                2
4709 4709       0  60       1          2                1
2769 2769       0  32       0          3                1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb222"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit, <span class="at">newdata =</span> df[index,], <span class="at">type =</span> <span class="st">"class"</span>)</span>
<span id="cb222-2"><a href="#cb222-2" aria-hidden="true" tabindex="-1"></a>pred</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2821   96 5085  758  487  987 6061 3745 4709 2769 
   1    1    0    0    0    1    1    1    0    0 
Levels: 0 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb224"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a>confusion_matrix <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="at">actual =</span> df<span class="sc">$</span>Churned[index], <span class="at">predicted =</span> pred)</span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a>confusion_matrix</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      predicted
actual 0 1
     0 5 4
     1 0 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb226"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" aria-hidden="true" tabindex="-1"></a>accuracy <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">diag</span>(confusion_matrix)) <span class="sc">/</span> <span class="fu">sum</span>(confusion_matrix)</span>
<span id="cb226-2"><a href="#cb226-2" aria-hidden="true" tabindex="-1"></a>accuracy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6</code></pre>
</div>
</div>
<p>Recall that we studied N-fold cross-validation for the K-nearest neighbor classifier, in which the value of k is varied to control the complexity of the decision surface for the classifier.</p>
<p>For decision tree classification, when fitting a tree using function <code>rpart()</code>, we use the argument <code>control = rpart.control(minsplit = 1)</code> where <code>minsplit = 1</code> is to specify the minimum number of observations that must exist in a node in order for a split to be attempted. By default, <code>minsplit = 20</code>. This <code>minsplit</code> argument helps to draft the complexity of a tree, complex with many layers and branches or simple with few layers and less branches.</p>
<p>For this control = <code>rpart.control()</code>, there is a similar complexity parameter exists, which is denoted as <code>cp</code> where by default <code>cp = 0.01</code>:</p>
<pre><code>control = rpart.control(cp = 0.01)</code></pre>
<p>Heuristically, smaller values of <code>cp</code> correspond to decision trees of larger sizes, and hence more complex decision surfaces.</p>
<p>For this problem, we will investigate n-fold cross-validation for a decision tree classifier.</p>
<p>Consider the data set “bank-sample.csv” we discussed in the lectures. For this exercise, we will fit a decision tree with <code>subscribed</code> as outcome; and <code>job</code>, <code>marital</code>, <code>education</code>, <code>default</code>, <code>housing</code>, <code>loan</code>, <code>contact</code>, and <code>poutcome</code> as 8 feature variables. <strong>We want to find the best cp value in terms of mis-classification error rate.</strong></p>
<ol type="1">
<li><p>Randomly split the entire data set into 10 mutually exclusive data sets.</p></li>
<li><p>Let cp take on the values <span class="math inline">\(10^k\)</span> for k=−5,−4,…,0,…,3,4,5.</p></li>
<li><p>At each cp value, run the following loop for j=1,2,…,10.</p>
<ul>
<li><p>i. Set the jth group to be the test set.</p></li>
<li><p>ii. Fit a decision tree on the other 9 sets with the value of cp.</p></li>
<li><p>iii. Predict the class assignment of <code>subscribed</code> for each observation of the test set.</p></li>
<li><p>iv. Calculate the number of mis-classification(s) by comparing predicted versus actual class labels in the test set.</p></li>
</ul></li>
<li><p>Determine the best cp value in terms of mis-classification error rate.</p></li>
</ol>
<p><strong>Note:</strong> mis-classification error rate is the complement of the accuracy.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"bank-sample.csv"</span>)</span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   2000 obs. of  17 variables:
 $ age       : int  31 45 46 35 39 31 34 39 38 50 ...
 $ job       : chr  "management" "entrepreneur" "services" "management" ...
 $ marital   : chr  "single" "married" "divorced" "married" ...
 $ education : chr  "tertiary" "tertiary" "secondary" "tertiary" ...
 $ default   : chr  "no" "no" "no" "no" ...
 $ balance   : int  0 1752 4329 1108 1410 499 0 26233 8444 72 ...
 $ housing   : chr  "yes" "yes" "no" "yes" ...
 $ loan      : chr  "no" "yes" "no" "no" ...
 $ contact   : chr  "cellular" "cellular" "cellular" "cellular" ...
 $ day       : int  15 20 21 17 23 9 6 2 17 22 ...
 $ month     : chr  "apr" "nov" "nov" "nov" ...
 $ duration  : int  185 56 534 52 55 122 611 462 39 171 ...
 $ campaign  : int  2 2 2 1 1 2 1 1 2 13 ...
 $ pdays     : int  -1 -1 -1 -1 -1 -1 183 -1 324 -1 ...
 $ previous  : int  0 0 0 0 0 0 1 0 1 0 ...
 $ poutcome  : chr  "unknown" "unknown" "unknown" "unknown" ...
 $ subscribed: chr  "no" "no" "yes" "no" ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb231"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a>col_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"subscribed"</span>, <span class="st">"job"</span>, <span class="st">"marital"</span>, <span class="st">"education"</span>, <span class="st">"default"</span>, <span class="st">"housing"</span>, <span class="st">"loan"</span>, <span class="st">"contact"</span>, <span class="st">"poutcome"</span>)</span>
<span id="cb231-2"><a href="#cb231-2" aria-hidden="true" tabindex="-1"></a>df_new <span class="ot">&lt;-</span> df[,col_names]</span>
<span id="cb231-3"><a href="#cb231-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(df_new)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   2000 obs. of  9 variables:
 $ subscribed: chr  "no" "no" "yes" "no" ...
 $ job       : chr  "management" "entrepreneur" "services" "management" ...
 $ marital   : chr  "single" "married" "divorced" "married" ...
 $ education : chr  "tertiary" "tertiary" "secondary" "tertiary" ...
 $ default   : chr  "no" "no" "no" "no" ...
 $ housing   : chr  "yes" "yes" "no" "yes" ...
 $ loan      : chr  "no" "yes" "no" "no" ...
 $ contact   : chr  "cellular" "cellular" "cellular" "cellular" ...
 $ poutcome  : chr  "unknown" "unknown" "unknown" "unknown" ...</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb233"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb233-2"><a href="#cb233-2" aria-hidden="true" tabindex="-1"></a>cp_values <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span>(<span class="sc">-</span><span class="dv">5</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb233-3"><a href="#cb233-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(cp_values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1e-05 1e-04 1e-03 1e-02 1e-01 1e+00 1e+01 1e+02 1e+03 1e+04 1e+05</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb235"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart)</span>
<span id="cb235-2"><a href="#cb235-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart.plot)</span>
<span id="cb235-3"><a href="#cb235-3" aria-hidden="true" tabindex="-1"></a>index <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb235-4"><a href="#cb235-4" aria-hidden="true" tabindex="-1"></a>cp_err <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">11</span>)</span>
<span id="cb235-5"><a href="#cb235-5" aria-hidden="true" tabindex="-1"></a>n_folds <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb235-6"><a href="#cb235-6" aria-hidden="true" tabindex="-1"></a>folds_indexes <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n_folds, <span class="at">length.out =</span> <span class="fu">dim</span>(df_new)[<span class="dv">1</span>])) <span class="co">#nrow(df_new) the same </span></span>
<span id="cb235-7"><a href="#cb235-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (cp_val <span class="cf">in</span> cp_values) {</span>
<span id="cb235-8"><a href="#cb235-8" aria-hidden="true" tabindex="-1"></a>  err <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">10</span>)</span>
<span id="cb235-9"><a href="#cb235-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) {</span>
<span id="cb235-10"><a href="#cb235-10" aria-hidden="true" tabindex="-1"></a>    test_indexes <span class="ot">&lt;-</span> <span class="fu">which</span>(folds_indexes <span class="sc">==</span> j)</span>
<span id="cb235-11"><a href="#cb235-11" aria-hidden="true" tabindex="-1"></a>    fit <span class="ot">&lt;-</span> <span class="fu">rpart</span>(subscribed <span class="sc">~</span> .,</span>
<span id="cb235-12"><a href="#cb235-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">method =</span> <span class="st">"class"</span>,</span>
<span id="cb235-13"><a href="#cb235-13" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> df_new[<span class="sc">-</span>test_indexes,],</span>
<span id="cb235-14"><a href="#cb235-14" aria-hidden="true" tabindex="-1"></a>                 <span class="at">control =</span> <span class="fu">rpart.control</span>(<span class="at">cp =</span> cp_val))</span>
<span id="cb235-15"><a href="#cb235-15" aria-hidden="true" tabindex="-1"></a>    prediction <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit,</span>
<span id="cb235-16"><a href="#cb235-16" aria-hidden="true" tabindex="-1"></a>                          df_new[test_indexes,],</span>
<span id="cb235-17"><a href="#cb235-17" aria-hidden="true" tabindex="-1"></a>                          <span class="at">type =</span> <span class="st">"class"</span>)</span>
<span id="cb235-18"><a href="#cb235-18" aria-hidden="true" tabindex="-1"></a>    err[j] <span class="ot">&lt;-</span> <span class="fu">mean</span>(prediction <span class="sc">!=</span> df_new<span class="sc">$</span>subscribed[test_indexes])</span>
<span id="cb235-19"><a href="#cb235-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb235-20"><a href="#cb235-20" aria-hidden="true" tabindex="-1"></a>  cp_err[index] <span class="ot">&lt;-</span> <span class="fu">mean</span>(err)</span>
<span id="cb235-21"><a href="#cb235-21" aria-hidden="true" tabindex="-1"></a>  index <span class="ot">&lt;-</span> index <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb235-22"><a href="#cb235-22" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb236"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">log</span>(cp_values, <span class="at">base =</span> <span class="dv">10</span>), cp_err, <span class="at">type =</span> <span class="st">'b'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-77-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb237"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a>best.cp <span class="ot">&lt;-</span> cp_values[<span class="fu">which</span>(cp_err <span class="sc">==</span> <span class="fu">min</span>(cp_err))]</span>
<span id="cb237-2"><a href="#cb237-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(best.cp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.01</code></pre>
</div>
<div class="sourceCode cell-code" id="cb239"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="co"># From the plot, we can observe that cp = 0.01 gives the lowest misclassification error rate.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb240"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb240-1"><a href="#cb240-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">rpart</span>(subscribed <span class="sc">~</span> ., </span>
<span id="cb240-2"><a href="#cb240-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">method =</span> <span class="st">"class"</span>, </span>
<span id="cb240-3"><a href="#cb240-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">data =</span> df_new, </span>
<span id="cb240-4"><a href="#cb240-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">control =</span> <span class="fu">rpart.control</span>(<span class="at">cp =</span> <span class="fl">0.01</span>))</span>
<span id="cb240-5"><a href="#cb240-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rpart.plot</span>(fit, <span class="at">type =</span> <span class="dv">4</span>, <span class="at">extra =</span> <span class="dv">2</span>, <span class="at">clip.right.labs =</span> <span class="cn">FALSE</span>, <span class="at">varlen =</span> <span class="dv">0</span>, <span class="at">faclen =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-78-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="t8-naive-bayes" class="level2">
<h2 class="anchored" data-anchor-id="t8-naive-bayes">T8 (Naive Bayes)</h2>
<section id="offsite-questions-naive-bayes-decision-trees-roc-auc" class="level3">
<h3 class="anchored" data-anchor-id="offsite-questions-naive-bayes-decision-trees-roc-auc">Offsite Questions (Naive Bayes, Decision Trees, ROC, AUC)</h3>
<p>Consider the data set “Titanic.csv” again.</p>
<p>(a) Fit a decision tree on all the three feature variables, called M2, which uses <code>minsplit = 1</code> and information gain.</p>
<p>(b) Plot the tree M2.</p>
<p>(c) Plot the ROC curves and derive the AUC values for the two classifiers (naive Bayes from on-site question and decision tree). Which classifier has a larger AUC value?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb241"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Titanic.csv"</span>)</span>
<span id="cb241-2"><a href="#cb241-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   2201 obs. of  4 variables:
 $ Class   : chr  "3rd" "3rd" "3rd" "3rd" ...
 $ Sex     : chr  "Male" "Male" "Male" "Male" ...
 $ Age     : chr  "Child" "Child" "Child" "Child" ...
 $ Survived: chr  "No" "No" "No" "No" ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb243"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart)</span>
<span id="cb243-2"><a href="#cb243-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart.plot)</span>
<span id="cb243-3"><a href="#cb243-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(e1071)</span>
<span id="cb243-4"><a href="#cb243-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ROCR)</span>
<span id="cb243-5"><a href="#cb243-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-6"><a href="#cb243-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">100</span>)</span>
<span id="cb243-7"><a href="#cb243-7" aria-hidden="true" tabindex="-1"></a>M1 <span class="ot">&lt;-</span> <span class="fu">naiveBayes</span>(Survived <span class="sc">~</span> Class <span class="sc">+</span> Sex <span class="sc">+</span> Age, df)</span>
<span id="cb243-8"><a href="#cb243-8" aria-hidden="true" tabindex="-1"></a>M2 <span class="ot">&lt;-</span> <span class="fu">rpart</span>(Survived <span class="sc">~</span> Class <span class="sc">+</span> Sex <span class="sc">+</span> Age, </span>
<span id="cb243-9"><a href="#cb243-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> df,</span>
<span id="cb243-10"><a href="#cb243-10" aria-hidden="true" tabindex="-1"></a>            <span class="at">method =</span> <span class="st">"class"</span>,</span>
<span id="cb243-11"><a href="#cb243-11" aria-hidden="true" tabindex="-1"></a>            <span class="at">control =</span> <span class="fu">rpart.control</span>(<span class="at">minsplit =</span> <span class="dv">1</span>),</span>
<span id="cb243-12"><a href="#cb243-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">parms =</span> <span class="fu">list</span>(<span class="at">split =</span> <span class="st">'information'</span>))</span>
<span id="cb243-13"><a href="#cb243-13" aria-hidden="true" tabindex="-1"></a><span class="fu">rpart.plot</span>(M2, <span class="at">type =</span> <span class="dv">4</span>, <span class="at">extra =</span> <span class="dv">2</span>, <span class="at">clip.right.labs =</span> <span class="cn">FALSE</span>, <span class="at">varlen =</span> <span class="dv">0</span>, <span class="at">faclen =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-79-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb244"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the ROC curves and derive the AUC values for the two classifiers (naive Bayes from on-site question and decision tree). Which classifier has a larger AUC value?</span></span>
<span id="cb244-2"><a href="#cb244-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb244-3"><a href="#cb244-3" aria-hidden="true" tabindex="-1"></a>pred.M1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(M1, df, <span class="at">type =</span> <span class="st">'raw'</span>)</span>
<span id="cb244-4"><a href="#cb244-4" aria-hidden="true" tabindex="-1"></a>score <span class="ot">&lt;-</span> pred.M1[,<span class="dv">2</span>]</span>
<span id="cb244-5"><a href="#cb244-5" aria-hidden="true" tabindex="-1"></a>survived_numeric <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>Survived <span class="sc">==</span> <span class="st">"Yes"</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb244-6"><a href="#cb244-6" aria-hidden="true" tabindex="-1"></a>pred_nb <span class="ot">&lt;-</span> <span class="fu">prediction</span>(score, survived_numeric)</span>
<span id="cb244-7"><a href="#cb244-7" aria-hidden="true" tabindex="-1"></a>roc_nb <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_nb, <span class="at">measure =</span> <span class="st">"tpr"</span>, <span class="at">x.measure =</span> <span class="st">"fpr"</span>)</span>
<span id="cb244-8"><a href="#cb244-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_nb, <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-79-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb245"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a>pred.M2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(M2, df, <span class="at">type =</span> <span class="st">'prob'</span>)</span>
<span id="cb245-2"><a href="#cb245-2" aria-hidden="true" tabindex="-1"></a>score2 <span class="ot">&lt;-</span> pred.M2[,<span class="dv">2</span>]</span>
<span id="cb245-3"><a href="#cb245-3" aria-hidden="true" tabindex="-1"></a>pred_dt <span class="ot">&lt;-</span> <span class="fu">prediction</span>(score2, survived_numeric)</span>
<span id="cb245-4"><a href="#cb245-4" aria-hidden="true" tabindex="-1"></a>roc_dt <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_dt, <span class="at">measure =</span> <span class="st">"tpr"</span>, <span class="at">x.measure =</span> <span class="st">"fpr"</span>)</span>
<span id="cb245-5"><a href="#cb245-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_dt, <span class="at">col =</span> <span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-79-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb246"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb246-1"><a href="#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_nb, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">main =</span> <span class="st">"ROC Curves: Naive Bayes vs Decision Tree"</span>)</span>
<span id="cb246-2"><a href="#cb246-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Add ROC curve for Decision Tree</span></span>
<span id="cb246-3"><a href="#cb246-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_dt, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb246-4"><a href="#cb246-4" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="st">"bottomright"</span>, </span>
<span id="cb246-5"><a href="#cb246-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Naive Bayes"</span>, <span class="st">"Decision Tree"</span>), </span>
<span id="cb246-6"><a href="#cb246-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>), </span>
<span id="cb246-7"><a href="#cb246-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb246-8"><a href="#cb246-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-79-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb247"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb247-1"><a href="#cb247-1" aria-hidden="true" tabindex="-1"></a>auc_nb <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_nb, <span class="at">measure =</span> <span class="st">"auc"</span>)</span>
<span id="cb247-2"><a href="#cb247-2" aria-hidden="true" tabindex="-1"></a>auc_nb_value <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(auc_nb<span class="sc">@</span>y.values) <span class="co"># Extract the AUC value</span></span>
<span id="cb247-3"><a href="#cb247-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(auc_nb_value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7164944</code></pre>
</div>
<div class="sourceCode cell-code" id="cb249"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb249-1"><a href="#cb249-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.7164944</span></span>
<span id="cb249-2"><a href="#cb249-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-3"><a href="#cb249-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb249-4"><a href="#cb249-4" aria-hidden="true" tabindex="-1"></a>auc_dt <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_dt, <span class="at">measure =</span> <span class="st">"auc"</span>)</span>
<span id="cb249-5"><a href="#cb249-5" aria-hidden="true" tabindex="-1"></a>auc_dt_value <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(auc_dt<span class="sc">@</span>y.values) <span class="co"># Extract the AUC value</span></span>
<span id="cb249-6"><a href="#cb249-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(auc_dt_value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7262628</code></pre>
</div>
<div class="sourceCode cell-code" id="cb251"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.7262628</span></span>
<span id="cb251-2"><a href="#cb251-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb251-3"><a href="#cb251-3" aria-hidden="true" tabindex="-1"></a><span class="co"># From AUC values, the decision tree classifier is</span></span>
<span id="cb251-4"><a href="#cb251-4" aria-hidden="true" tabindex="-1"></a><span class="co"># slightly better than the Naive Bayes classifier</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="onsite-questions-naive-bayes-mathematics" class="level3">
<h3 class="anchored" data-anchor-id="onsite-questions-naive-bayes-mathematics">Onsite Questions (Naive Bayes Mathematics)</h3>
<p>Data set “Titanic.csv” provides information on the fate of passengers on the fatal maiden voyage of the ocean liner Titanic. It includes the variables: economic status (class), sex, age, and survival. We will train a naive Bayes classifier using this data set, and predict survival.</p>
<ol type="1">
<li><p>Compute the probabilities <span class="math inline">\(P(Y=1)\)</span> (survived) and <span class="math inline">\(P(Y=0)\)</span> (did not survive).</p></li>
<li><p>Compute the conditional probabilities <span class="math inline">\(P(X_i = x_i | Y = 1)\)</span> and <span class="math inline">\(P(X_i = x_i | Y = 0)\)</span>, where i=1,2,3,4 for the feature variables X={class,sex,age}</p></li>
<li><p>Predict survival for an adult female passenger in 2nd class cabin.</p></li>
<li><p>Compare your prediction in (c) with the one performed by the <code>naiveBayes()</code> function in package <code>e1071</code></p></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb252"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb252-1"><a href="#cb252-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Titanic.csv"</span>)</span>
<span id="cb252-2"><a href="#cb252-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   2201 obs. of  4 variables:
 $ Class   : chr  "3rd" "3rd" "3rd" "3rd" ...
 $ Sex     : chr  "Male" "Male" "Male" "Male" ...
 $ Age     : chr  "Child" "Child" "Child" "Child" ...
 $ Survived: chr  "No" "No" "No" "No" ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb254"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(df<span class="sc">$</span>Survived))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
      No      Yes 
0.676965 0.323035 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb256"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb256-1"><a href="#cb256-1" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">table</span>(df[,<span class="fu">c</span>(<span class="st">"Survived"</span>, <span class="st">"Class"</span>)])</span>
<span id="cb256-2"><a href="#cb256-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Class
Survived 1st 2nd 3rd Crew
     No  122 167 528  673
     Yes 203 118 178  212</code></pre>
</div>
<div class="sourceCode cell-code" id="cb258"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb258-1"><a href="#cb258-1" aria-hidden="true" tabindex="-1"></a>class.pro <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(tab, <span class="at">margin =</span> <span class="dv">1</span>)</span>
<span id="cb258-2"><a href="#cb258-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(class.pro)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Class
Survived        1st        2nd        3rd       Crew
     No  0.08187919 0.11208054 0.35436242 0.45167785
     Yes 0.28551336 0.16596343 0.25035162 0.29817159</code></pre>
</div>
<div class="sourceCode cell-code" id="cb260"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a><span class="co"># P (Class = 1st | Y = 1) = 0.286</span></span>
<span id="cb260-2"><a href="#cb260-2" aria-hidden="true" tabindex="-1"></a><span class="co"># P (Class = 2nd | Y = 1) = 0.166</span></span>
<span id="cb260-3"><a href="#cb260-3" aria-hidden="true" tabindex="-1"></a><span class="co"># P (Class = 3rd | Y = 1) = 0.250</span></span>
<span id="cb260-4"><a href="#cb260-4" aria-hidden="true" tabindex="-1"></a><span class="co"># P (Class = Crew | Y = 1) = 0.298</span></span>
<span id="cb260-5"><a href="#cb260-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-6"><a href="#cb260-6" aria-hidden="true" tabindex="-1"></a><span class="co"># P (Class = 1st | Y = 0) = 0.0819</span></span>
<span id="cb260-7"><a href="#cb260-7" aria-hidden="true" tabindex="-1"></a><span class="co"># P (Class = 2nd | Y = 0) = 0.112</span></span>
<span id="cb260-8"><a href="#cb260-8" aria-hidden="true" tabindex="-1"></a><span class="co"># P (Class = 3rd | Y = 0) = 0.354</span></span>
<span id="cb260-9"><a href="#cb260-9" aria-hidden="true" tabindex="-1"></a><span class="co"># P (Class = Crew | Y = 0) = 0.452</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb261"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb261-1"><a href="#cb261-1" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">table</span>(df[,<span class="fu">c</span>(<span class="st">"Survived"</span>, <span class="st">"Sex"</span>)])</span>
<span id="cb261-2"><a href="#cb261-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Sex
Survived Female Male
     No     126 1364
     Yes    344  367</code></pre>
</div>
<div class="sourceCode cell-code" id="cb263"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a>sex.pro <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(tab, <span class="at">margin =</span> <span class="dv">1</span>)</span>
<span id="cb263-2"><a href="#cb263-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(sex.pro)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Sex
Survived     Female       Male
     No  0.08456376 0.91543624
     Yes 0.48382560 0.51617440</code></pre>
</div>
<div class="sourceCode cell-code" id="cb265"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb265-1"><a href="#cb265-1" aria-hidden="true" tabindex="-1"></a><span class="co"># P (Class = Female | Y = 1) = 0.484</span></span>
<span id="cb265-2"><a href="#cb265-2" aria-hidden="true" tabindex="-1"></a><span class="co"># P (Class = Male | Y = 1) = 0.516</span></span>
<span id="cb265-3"><a href="#cb265-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb265-4"><a href="#cb265-4" aria-hidden="true" tabindex="-1"></a><span class="co"># P (Class = Female | Y = 0) = 0.085</span></span>
<span id="cb265-5"><a href="#cb265-5" aria-hidden="true" tabindex="-1"></a><span class="co"># P (Class = Male | Y = 0) = 0.915</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb266"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb266-1"><a href="#cb266-1" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">table</span>(df[,<span class="fu">c</span>(<span class="st">"Survived"</span>, <span class="st">"Age"</span>)])</span>
<span id="cb266-2"><a href="#cb266-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Age
Survived Adult Child
     No   1438    52
     Yes   654    57</code></pre>
</div>
<div class="sourceCode cell-code" id="cb268"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb268-1"><a href="#cb268-1" aria-hidden="true" tabindex="-1"></a>age.pro <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(tab, <span class="at">margin =</span> <span class="dv">1</span>)</span>
<span id="cb268-2"><a href="#cb268-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(age.pro)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Age
Survived      Adult      Child
     No  0.96510067 0.03489933
     Yes 0.91983122 0.08016878</code></pre>
</div>
<div class="sourceCode cell-code" id="cb270"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb270-1"><a href="#cb270-1" aria-hidden="true" tabindex="-1"></a><span class="co"># P (Class = Adult | Y = 1) = 0.920</span></span>
<span id="cb270-2"><a href="#cb270-2" aria-hidden="true" tabindex="-1"></a><span class="co"># P (Class = Child | Y = 1) = 0.080</span></span>
<span id="cb270-3"><a href="#cb270-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-4"><a href="#cb270-4" aria-hidden="true" tabindex="-1"></a><span class="co"># P (Class = Adult | Y = 0) = 0.965</span></span>
<span id="cb270-5"><a href="#cb270-5" aria-hidden="true" tabindex="-1"></a><span class="co"># P (Class = Child | Y = 0) = 0.035</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb271"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb271-1"><a href="#cb271-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predict survival for an adult female passenger in 2nd class cabin.</span></span>
<span id="cb271-2"><a href="#cb271-2" aria-hidden="true" tabindex="-1"></a><span class="co"># P(Y = 1) *.                   # Survival </span></span>
<span id="cb271-3"><a href="#cb271-3" aria-hidden="true" tabindex="-1"></a><span class="co"># P(Class = 2nd|Y = 1) *        # 2nd Class</span></span>
<span id="cb271-4"><a href="#cb271-4" aria-hidden="true" tabindex="-1"></a><span class="co"># P(Sex = Female|Y = 1) *.      # Female</span></span>
<span id="cb271-5"><a href="#cb271-5" aria-hidden="true" tabindex="-1"></a><span class="co"># P(Age = Adult|Y = 1)          # Adult</span></span>
<span id="cb271-6"><a href="#cb271-6" aria-hidden="true" tabindex="-1"></a><span class="co"># = 0.323035 * 0.16596343 * 0.48382560 * 0.91983122</span></span>
<span id="cb271-7"><a href="#cb271-7" aria-hidden="true" tabindex="-1"></a><span class="co"># = 0.02385937</span></span>
<span id="cb271-8"><a href="#cb271-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb271-9"><a href="#cb271-9" aria-hidden="true" tabindex="-1"></a><span class="co"># P(Y = 0) *                    # Survival </span></span>
<span id="cb271-10"><a href="#cb271-10" aria-hidden="true" tabindex="-1"></a><span class="co"># P(Class = 2nd|Y = 0) *        # 2nd Class</span></span>
<span id="cb271-11"><a href="#cb271-11" aria-hidden="true" tabindex="-1"></a><span class="co"># P(Sex = Female|Y = 0) *       # Female</span></span>
<span id="cb271-12"><a href="#cb271-12" aria-hidden="true" tabindex="-1"></a><span class="co"># P(Age = Adult|Y = 0)          # Adult</span></span>
<span id="cb271-13"><a href="#cb271-13" aria-hidden="true" tabindex="-1"></a><span class="co"># = 0.676965 * 0.11208054 * 0.08456376 * 0.96510067</span></span>
<span id="cb271-14"><a href="#cb271-14" aria-hidden="true" tabindex="-1"></a><span class="co"># = 0.006192319</span></span>
<span id="cb271-15"><a href="#cb271-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb271-16"><a href="#cb271-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Thus, the ratio between probability of survived </span></span>
<span id="cb271-17"><a href="#cb271-17" aria-hidden="true" tabindex="-1"></a><span class="co"># and not survived is 0.02385937/0.006192319 (3.85)</span></span>
<span id="cb271-18"><a href="#cb271-18" aria-hidden="true" tabindex="-1"></a><span class="co"># which is nearly 4 times. </span></span>
<span id="cb271-19"><a href="#cb271-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb271-20"><a href="#cb271-20" aria-hidden="true" tabindex="-1"></a><span class="co"># We predict that an adult female passenger in 2nd class</span></span>
<span id="cb271-21"><a href="#cb271-21" aria-hidden="true" tabindex="-1"></a><span class="co"># cabin will survive.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb272"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb272-1"><a href="#cb272-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Compare your prediction in (c) with naiveBayes() function</span></span>
<span id="cb272-2"><a href="#cb272-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(e1071)</span>
<span id="cb272-3"><a href="#cb272-3" aria-hidden="true" tabindex="-1"></a>M1 <span class="ot">&lt;-</span> <span class="fu">naiveBayes</span>(Survived <span class="sc">~</span> Class <span class="sc">+</span> Sex <span class="sc">+</span> Age, df)</span>
<span id="cb272-4"><a href="#cb272-4" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Class =</span> <span class="st">"2nd"</span>, <span class="at">Sex =</span> <span class="st">"Female"</span>, <span class="at">Age =</span> <span class="st">"Adult"</span>)</span>
<span id="cb272-5"><a href="#cb272-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb272-6"><a href="#cb272-6" aria-hidden="true" tabindex="-1"></a>pred.label <span class="ot">&lt;-</span> <span class="fu">predict</span>(M1, newdata)</span>
<span id="cb272-7"><a href="#cb272-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pred.label)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] Yes
Levels: No Yes</code></pre>
</div>
<div class="sourceCode cell-code" id="cb274"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb274-1"><a href="#cb274-1" aria-hidden="true" tabindex="-1"></a>pred.prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(M1, newdata, <span class="st">"raw"</span>)</span>
<span id="cb274-2"><a href="#cb274-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pred.prob)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            No       Yes
[1,] 0.2060556 0.7939444</code></pre>
</div>
<div class="sourceCode cell-code" id="cb276"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb276-1"><a href="#cb276-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(pred.prob[<span class="dv">1</span>,<span class="st">"Yes"</span>] <span class="sc">/</span> pred.prob[<span class="dv">1</span>,<span class="st">"No"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Yes 
3.853059 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb278"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb278-1"><a href="#cb278-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ratio is same as calculated.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="t9-logistic-regression" class="level2">
<h2 class="anchored" data-anchor-id="t9-logistic-regression">T9 (Logistic Regression)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb279"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb279-1"><a href="#cb279-1" aria-hidden="true" tabindex="-1"></a><span class="co"># M1 = glm(y ~ x1 + x2 + ..., data = ..., family = binomial)</span></span>
<span id="cb279-2"><a href="#cb279-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb279-3"><a href="#cb279-3" aria-hidden="true" tabindex="-1"></a><span class="co"># predict(M1, newdata = ..., type = "response")</span></span>
<span id="cb279-4"><a href="#cb279-4" aria-hidden="true" tabindex="-1"></a><span class="co">#    Get probability</span></span>
<span id="cb279-5"><a href="#cb279-5" aria-hidden="true" tabindex="-1"></a><span class="co"># predict(M1, newdata = ..., type = "link")</span></span>
<span id="cb279-6"><a href="#cb279-6" aria-hidden="true" tabindex="-1"></a><span class="co">#    Get Log-odds (Rarely used)</span></span>
<span id="cb279-7"><a href="#cb279-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb279-8"><a href="#cb279-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Coefficient of numerical features:</span></span>
<span id="cb279-9"><a href="#cb279-9" aria-hidden="true" tabindex="-1"></a><span class="co"># If other regressors are fixed, when X increases by one</span></span>
<span id="cb279-10"><a href="#cb279-10" aria-hidden="true" tabindex="-1"></a><span class="co"># unit, the LOG-odds of Y increases/decreases by C units.</span></span>
<span id="cb279-11"><a href="#cb279-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Thus, odds of Y will be e^C = ... TIMES larger/smaller.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="offsite-questions-logistic-regression-roc-auc" class="level3">
<h3 class="anchored" data-anchor-id="offsite-questions-logistic-regression-roc-auc">Offsite Questions (Logistic Regression, ROC, AUC)</h3>
<p>Consider data set <code>Titanic.csv</code> again which was mentioned in Tutorial 8.</p>
<ol type="1">
<li><p>Perform logistic regression using all the feature variables to predict the survival status, called model M2.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb280"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb280-1"><a href="#cb280-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Titanic.csv"</span>)</span>
<span id="cb280-2"><a href="#cb280-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   2201 obs. of  4 variables:
 $ Class   : chr  "3rd" "3rd" "3rd" "3rd" ...
 $ Sex     : chr  "Male" "Male" "Male" "Male" ...
 $ Age     : chr  "Child" "Child" "Child" "Child" ...
 $ Survived: chr  "No" "No" "No" "No" ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb282"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb282-1"><a href="#cb282-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>survived_numeric <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>Survived <span class="sc">==</span> <span class="st">"No"</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb282-2"><a href="#cb282-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb282-3"><a href="#cb282-3" aria-hidden="true" tabindex="-1"></a>M2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(survived_numeric <span class="sc">~</span> Class <span class="sc">+</span> Sex <span class="sc">+</span> Age, <span class="at">data =</span> df, <span class="at">family =</span> binomial)</span>
<span id="cb282-4"><a href="#cb282-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = survived_numeric ~ Class + Sex + Age, family = binomial, 
    data = df)

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)   2.0438     0.1679  12.171  &lt; 2e-16 ***
Class2nd     -1.0181     0.1960  -5.194 2.05e-07 ***
Class3rd     -1.7778     0.1716 -10.362  &lt; 2e-16 ***
ClassCrew    -0.8577     0.1573  -5.451 5.00e-08 ***
SexMale      -2.4201     0.1404 -17.236  &lt; 2e-16 ***
AgeChild      1.0615     0.2440   4.350 1.36e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 2769.5  on 2200  degrees of freedom
Residual deviance: 2210.1  on 2195  degrees of freedom
AIC: 2222.1

Number of Fisher Scoring iterations: 4</code></pre>
</div>
</div></li>
<li><p>Write down the fitted equation of model M2.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb284"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb284-1"><a href="#cb284-1" aria-hidden="true" tabindex="-1"></a><span class="co"># p_hat = predicted probability of survival</span></span>
<span id="cb284-2"><a href="#cb284-2" aria-hidden="true" tabindex="-1"></a><span class="co"># log(p_hat/(1-p_hat)) = 2.0438 - 1.0181 * I(Class=2nd) - 1.7778 * I(Class = 3rd) </span></span>
<span id="cb284-3"><a href="#cb284-3" aria-hidden="true" tabindex="-1"></a><span class="co"># - 0.8577 * I(Class = Crew) - 2.4201 * I(Sex = Male) + 1.0615 * I(Age = Child)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
<li><p>Interpret the coefficient of the variable ‘Sex’ in M2.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb285"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb285-1"><a href="#cb285-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Female is the reference, Male is indicated by indicator.</span></span>
<span id="cb285-2"><a href="#cb285-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Meaning, given the same condition on class and age, when </span></span>
<span id="cb285-3"><a href="#cb285-3" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing to a female, the LOG-odds of survival for a </span></span>
<span id="cb285-4"><a href="#cb285-4" aria-hidden="true" tabindex="-1"></a><span class="co"># male is less than that of a female by 2.4201.</span></span>
<span id="cb285-5"><a href="#cb285-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Thus, odds of survival of a male passenger will be less</span></span>
<span id="cb285-6"><a href="#cb285-6" aria-hidden="true" tabindex="-1"></a><span class="co"># than that of a female by e^2.4201 = 11.25 TIMES</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
<li><p>Interpret the coefficient of the variable ‘Age’ in M2.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb286"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb286-1"><a href="#cb286-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adult is the reference, Child is indicated by indicator.</span></span>
<span id="cb286-2"><a href="#cb286-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Meaning, given the same condition on class and sex, when # comparing to a adult, the LOG-odds of survival for a </span></span>
<span id="cb286-3"><a href="#cb286-3" aria-hidden="true" tabindex="-1"></a><span class="co"># child is higher than that of an adult by 1.0615.</span></span>
<span id="cb286-4"><a href="#cb286-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Thus, odds of survival of a child passenger will be more</span></span>
<span id="cb286-5"><a href="#cb286-5" aria-hidden="true" tabindex="-1"></a><span class="co"># than that of an adult by e^1.0615 = 2.89 TIMES</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
<li><p>Obtain and compare the ROC curves and AUC for the two classifiers: naive Bayes (from Tutorial 8) and logistic regression.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb287"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb287-1"><a href="#cb287-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">'e1071'</span>)</span>
<span id="cb287-2"><a href="#cb287-2" aria-hidden="true" tabindex="-1"></a>M1 <span class="ot">&lt;-</span> <span class="fu">naiveBayes</span>(survived_numeric <span class="sc">~</span> Class <span class="sc">+</span> Sex <span class="sc">+</span> Age, <span class="at">data =</span> df)</span>
<span id="cb287-3"><a href="#cb287-3" aria-hidden="true" tabindex="-1"></a>M2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(survived_numeric <span class="sc">~</span> Class <span class="sc">+</span> Sex <span class="sc">+</span> Age, <span class="at">data =</span> df, <span class="at">family =</span> binomial)</span>
<span id="cb287-4"><a href="#cb287-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-5"><a href="#cb287-5" aria-hidden="true" tabindex="-1"></a>pred.M2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(M2, <span class="at">newdata =</span> df, <span class="at">type =</span> <span class="st">'response'</span>)</span>
<span id="cb287-6"><a href="#cb287-6" aria-hidden="true" tabindex="-1"></a>pred_lr <span class="ot">&lt;-</span> <span class="fu">prediction</span>(pred.M2, df<span class="sc">$</span>survived_numeric)</span>
<span id="cb287-7"><a href="#cb287-7" aria-hidden="true" tabindex="-1"></a>roc_lr <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_lr, <span class="at">measure =</span> <span class="st">"tpr"</span>, <span class="at">x.measure =</span> <span class="st">"fpr"</span>)</span>
<span id="cb287-8"><a href="#cb287-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_lr, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb287-9"><a href="#cb287-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-10"><a href="#cb287-10" aria-hidden="true" tabindex="-1"></a>pred.M1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(M1, <span class="at">newdata =</span> df, <span class="at">type =</span> <span class="st">'raw'</span>)</span>
<span id="cb287-11"><a href="#cb287-11" aria-hidden="true" tabindex="-1"></a>pred_nb <span class="ot">&lt;-</span> <span class="fu">prediction</span>(pred.M1[, <span class="dv">2</span>], df<span class="sc">$</span>survived_numeric) <span class="co"># pred.M1[,2] is score </span></span>
<span id="cb287-12"><a href="#cb287-12" aria-hidden="true" tabindex="-1"></a>roc_nb <span class="ot">&lt;-</span>  <span class="fu">performance</span>(pred_nb, <span class="at">measure =</span> <span class="st">"tpr"</span>, <span class="at">x.measure =</span> <span class="st">"fpr"</span>)</span>
<span id="cb287-13"><a href="#cb287-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc_nb, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb287-14"><a href="#cb287-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-15"><a href="#cb287-15" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="st">"bottomright"</span>, </span>
<span id="cb287-16"><a href="#cb287-16" aria-hidden="true" tabindex="-1"></a>       <span class="fu">c</span>(<span class="st">"logistic regression"</span>, <span class="st">"naiveBayes"</span>),</span>
<span id="cb287-17"><a href="#cb287-17" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>), </span>
<span id="cb287-18"><a href="#cb287-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-91-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb288"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb288-1"><a href="#cb288-1" aria-hidden="true" tabindex="-1"></a>auc_lr <span class="ot">=</span> <span class="fu">performance</span>(pred_lr, <span class="at">measure =</span><span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb288-2"><a href="#cb288-2" aria-hidden="true" tabindex="-1"></a>auc_lr <span class="co"># 0.7597259</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7597259</code></pre>
</div>
<div class="sourceCode cell-code" id="cb290"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb290-1"><a href="#cb290-1" aria-hidden="true" tabindex="-1"></a>auc_nb <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred_nb, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb290-2"><a href="#cb290-2" aria-hidden="true" tabindex="-1"></a>auc_nb <span class="co">#0.7164944</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7164944</code></pre>
</div>
<div class="sourceCode cell-code" id="cb292"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb292-1"><a href="#cb292-1" aria-hidden="true" tabindex="-1"></a><span class="co"># LR is slightly better than NB in </span></span>
<span id="cb292-2"><a href="#cb292-2" aria-hidden="true" tabindex="-1"></a><span class="co"># predicting survival status </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
</ol>
</section>
<section id="onsite-questions-logistic-regression-threshold" class="level3">
<h3 class="anchored" data-anchor-id="onsite-questions-logistic-regression-threshold">Onsite Questions (Logistic Regression, Threshold)</h3>
<p>(Data set <code>Smarket.csv</code> contains data on percentage returns for the S&amp;P 500 stock index over 1250 days, from the beginning of 2001 until the end of 2005. For each date, the data contains the trading volume and the percentage returns for each of the five previous trading days, <code>Lag1</code> through <code>Lag5</code>.</p>
<ol type="1">
<li><p>Find the proportion of the days that the direction is up.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb293"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb293-1"><a href="#cb293-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Smarket.csv"</span>)</span>
<span id="cb293-2"><a href="#cb293-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   1250 obs. of  10 variables:
 $ X        : int  1 2 3 4 5 6 7 8 9 10 ...
 $ Year     : int  2001 2001 2001 2001 2001 2001 2001 2001 2001 2001 ...
 $ Lag1     : num  0.381 0.959 1.032 -0.623 0.614 ...
 $ Lag2     : num  -0.192 0.381 0.959 1.032 -0.623 ...
 $ Lag3     : num  -2.624 -0.192 0.381 0.959 1.032 ...
 $ Lag4     : num  -1.055 -2.624 -0.192 0.381 0.959 ...
 $ Lag5     : num  5.01 -1.055 -2.624 -0.192 0.381 ...
 $ Volume   : num  1.19 1.3 1.41 1.28 1.21 ...
 $ Today    : num  0.959 1.032 -0.623 0.614 0.213 ...
 $ Direction: chr  "Up" "Up" "Down" "Up" ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb295"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb295-1"><a href="#cb295-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>X <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb295-2"><a href="#cb295-2" aria-hidden="true" tabindex="-1"></a>tab <span class="ot">&lt;-</span> <span class="fu">prop.table</span>(<span class="fu">table</span>(df<span class="sc">$</span>Direction))</span>
<span id="cb295-3"><a href="#cb295-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  Down     Up 
0.4816 0.5184 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb297"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb297-1"><a href="#cb297-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Proportion of days where direction is up is 0.5184</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
<li><p>Fit a logistic regression model (called model M3) that helps to predict the direction of S&amp;P 500 index, based on trading volume and the percentage returns for each of the five previous trading days, <code>Lag1</code> through <code>Lag5</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb298"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb298-1"><a href="#cb298-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>num_dir <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df<span class="sc">$</span>Direction <span class="sc">==</span> <span class="st">"Up"</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb298-2"><a href="#cb298-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   1250 obs. of  10 variables:
 $ Year     : int  2001 2001 2001 2001 2001 2001 2001 2001 2001 2001 ...
 $ Lag1     : num  0.381 0.959 1.032 -0.623 0.614 ...
 $ Lag2     : num  -0.192 0.381 0.959 1.032 -0.623 ...
 $ Lag3     : num  -2.624 -0.192 0.381 0.959 1.032 ...
 $ Lag4     : num  -1.055 -2.624 -0.192 0.381 0.959 ...
 $ Lag5     : num  5.01 -1.055 -2.624 -0.192 0.381 ...
 $ Volume   : num  1.19 1.3 1.41 1.28 1.21 ...
 $ Today    : num  0.959 1.032 -0.623 0.614 0.213 ...
 $ Direction: chr  "Up" "Up" "Down" "Up" ...
 $ num_dir  : num  1 1 0 1 1 1 0 1 1 1 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb300"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb300-1"><a href="#cb300-1" aria-hidden="true" tabindex="-1"></a>M3 <span class="ot">&lt;-</span> <span class="fu">glm</span>(num_dir <span class="sc">~</span> Volume <span class="sc">+</span> Lag1 <span class="sc">+</span> Lag2 <span class="sc">+</span> Lag3 <span class="sc">+</span> Lag4 <span class="sc">+</span> Lag5,</span>
<span id="cb300-2"><a href="#cb300-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">data =</span> df,</span>
<span id="cb300-3"><a href="#cb300-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">family =</span> binomial)</span>
<span id="cb300-4"><a href="#cb300-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = num_dir ~ Volume + Lag1 + Lag2 + Lag3 + Lag4 + 
    Lag5, family = binomial, data = df)

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)
(Intercept) -0.126000   0.240736  -0.523    0.601
Volume       0.135441   0.158360   0.855    0.392
Lag1        -0.073074   0.050167  -1.457    0.145
Lag2        -0.042301   0.050086  -0.845    0.398
Lag3         0.011085   0.049939   0.222    0.824
Lag4         0.009359   0.049974   0.187    0.851
Lag5         0.010313   0.049511   0.208    0.835

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 1731.2  on 1249  degrees of freedom
Residual deviance: 1727.6  on 1243  degrees of freedom
AIC: 1741.6

Number of Fisher Scoring iterations: 3</code></pre>
</div>
</div></li>
<li><p>Consider δ = 0.5184 as the border line to predict the direction be up or down, calculate the accuracy of model M3 when predicting for the days in the data set given.<br>
<em>Hint: To recall on what the role of δ is, please revise Tutorial 5 question 2.</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb302"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb302-1"><a href="#cb302-1" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fl">0.5184</span></span>
<span id="cb302-2"><a href="#cb302-2" aria-hidden="true" tabindex="-1"></a>pred.prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(M3, df, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb302-3"><a href="#cb302-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(pred.prob)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        1         2         3         4         5         6 
0.5070841 0.4814679 0.4811388 0.5152224 0.5107812 0.5069565 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb304"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb304-1"><a href="#cb304-1" aria-hidden="true" tabindex="-1"></a>pred.lab <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(pred.prob <span class="sc">&gt;=</span> sigma, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb304-2"><a href="#cb304-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(pred.lab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1 2 3 4 5 6 
0 0 0 0 0 0 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb306"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb306-1"><a href="#cb306-1" aria-hidden="true" tabindex="-1"></a>acc <span class="ot">&lt;-</span> <span class="fu">mean</span>(pred.lab <span class="sc">==</span> df<span class="sc">$</span>num_dir)</span>
<span id="cb306-2"><a href="#cb306-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(acc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5352</code></pre>
</div>
<div class="sourceCode cell-code" id="cb308"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb308-1"><a href="#cb308-1" aria-hidden="true" tabindex="-1"></a><span class="co"># acc got 0.5352</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
<li><p>(Extra) Write R code to plot the ROC curve for model M3. Derive and report AUC value of it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb309"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb309-1"><a href="#cb309-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ROCR)</span>
<span id="cb309-2"><a href="#cb309-2" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">prediction</span>(pred.prob, df<span class="sc">$</span>num_dir)</span>
<span id="cb309-3"><a href="#cb309-3" aria-hidden="true" tabindex="-1"></a>roc <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred, <span class="at">measure =</span> <span class="st">"tpr"</span>, <span class="at">x.measure =</span> <span class="st">"fpr"</span>)</span>
<span id="cb309-4"><a href="#cb309-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(roc, <span class="at">col =</span> <span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-95-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb310"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb310-1"><a href="#cb310-1" aria-hidden="true" tabindex="-1"></a>auc <span class="ot">&lt;-</span> <span class="fu">performance</span>(pred , <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb310-2"><a href="#cb310-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(auc) <span class="co"># 0.5387341</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5387341</code></pre>
</div>
</div></li>
</ol>
</section>
</section>
<section id="t10-k-means-clustering" class="level2">
<h2 class="anchored" data-anchor-id="t10-k-means-clustering">T10 (K-Means Clustering)</h2>
<p>Use kmeans() function: <code>kout &lt;- kmeans(data, centers = n)</code></p>
<p>To get final centroid positions: <code>kout$centers</code></p>
<p>To get size of each cluster: <code>kout$size</code></p>
<p>To get WSS for each cluster: <code>kout$withinss</code></p>
<p>To get Total WSS: <code>sum(kout$withinss)</code> OR <code>kout$tot.withinss</code></p>
<section id="offsite-questions-k-means-mathematics" class="level3">
<h3 class="anchored" data-anchor-id="offsite-questions-k-means-mathematics">Offsite Questions (K-Means Mathematics)</h3>
<ol type="1">
<li>Suppose we have data for five objects on two features:</li>
</ol>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Object</th>
<th>x1</th>
<th>x2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td>B</td>
<td>1.5</td>
<td>2</td>
</tr>
<tr class="odd">
<td>C</td>
<td>3</td>
<td>4</td>
</tr>
<tr class="even">
<td>D</td>
<td>3.5</td>
<td>5</td>
</tr>
<tr class="odd">
<td>E</td>
<td>4.5</td>
<td>5</td>
</tr>
</tbody>
</table>
<p>We set k=2 to cluster the five data points into two clusters, P and Q, and initialize the algorithm with the centroids <span class="math inline">\((x_1, x_2, P) = (2, 2)\)</span> and <span class="math inline">\((x_1, x_2, Q) = (4, 4)\)</span>.</p>
<p>(a) Fill up the following table to identify the objects in each cluster during the first iteration of the kkk-means algorithm:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Cluster</th>
<th>Object(s)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>P</td>
<td></td>
</tr>
<tr class="even">
<td>Q</td>
<td></td>
</tr>
</tbody>
</table>
<div class="cell">
<div class="sourceCode cell-code" id="cb312"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb312-1"><a href="#cb312-1" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1.5</span>, <span class="dv">3</span>, <span class="fl">3.5</span>, <span class="fl">4.5</span>)</span>
<span id="cb312-2"><a href="#cb312-2" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">5</span>)</span>
<span id="cb312-3"><a href="#cb312-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb312-4"><a href="#cb312-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x1, x2, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb312-5"><a href="#cb312-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb312-6"><a href="#cb312-6" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">1.1</span>,<span class="fl">1.1</span>,<span class="st">"A"</span>)</span>
<span id="cb312-7"><a href="#cb312-7" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">1.6</span>, <span class="fl">2.2</span>, <span class="st">'B'</span>)</span>
<span id="cb312-8"><a href="#cb312-8" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">3.1</span>, <span class="fl">4.1</span>, <span class="st">'C'</span>)</span>
<span id="cb312-9"><a href="#cb312-9" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">3.63</span>, <span class="dv">5</span>, <span class="st">'D'</span>)</span>
<span id="cb312-10"><a href="#cb312-10" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">4.35</span>, <span class="dv">5</span>, <span class="st">'E'</span>)</span>
<span id="cb312-11"><a href="#cb312-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb312-12"><a href="#cb312-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding the starting centroids </span></span>
<span id="cb312-13"><a href="#cb312-13" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="dv">2</span>,<span class="dv">2</span>, <span class="at">pch =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">'red'</span>)</span>
<span id="cb312-14"><a href="#cb312-14" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">2.2</span>, <span class="fl">2.1</span>, <span class="st">'C-P'</span>)</span>
<span id="cb312-15"><a href="#cb312-15" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="dv">4</span>,<span class="dv">4</span>, <span class="at">pch =</span> <span class="dv">10</span>, <span class="at">col =</span> <span class="st">'darkgreen'</span>)</span>
<span id="cb312-16"><a href="#cb312-16" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">4</span>,<span class="fl">3.8</span>, <span class="st">'C-Q'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-96-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb313"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb313-1"><a href="#cb313-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2.458333</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(b) Compute the new centroids for the two clusters based on cluster assignment in (a).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb314"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb314-1"><a href="#cb314-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding the new centroids after the first iteration:</span></span>
<span id="cb314-2"><a href="#cb314-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x1, x2, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb314-3"><a href="#cb314-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-4"><a href="#cb314-4" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="fl">1.25</span>, <span class="fl">1.5</span>, <span class="at">col =</span> <span class="st">'red'</span>, <span class="at">pch =</span> <span class="dv">2</span>)</span>
<span id="cb314-5"><a href="#cb314-5" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">1.35</span>, <span class="fl">1.4</span>, <span class="st">'C-P-new'</span>)</span>
<span id="cb314-6"><a href="#cb314-6" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="dv">11</span><span class="sc">/</span><span class="dv">3</span>, <span class="dv">14</span><span class="sc">/</span><span class="dv">3</span>, <span class="at">col =</span> <span class="st">'darkgreen'</span>, <span class="at">pch =</span> <span class="dv">10</span>)</span>
<span id="cb314-7"><a href="#cb314-7" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">11</span><span class="sc">/</span><span class="dv">3</span>, <span class="fl">4.5</span>, <span class="st">'C-Q-new'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-97-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>(c) Based on the centroids computed in (b), identify the objects in each cluster during the second iteration of the k-means algorithm.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb315"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb315-1"><a href="#cb315-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">data.frame</span>(x1, x2)</span>
<span id="cb315-2"><a href="#cb315-2" aria-hidden="true" tabindex="-1"></a>data</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   x1 x2
1 1.0  1
2 1.5  2
3 3.0  4
4 3.5  5
5 4.5  5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb317"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb317-1"><a href="#cb317-1" aria-hidden="true" tabindex="-1"></a>kout <span class="ot">=</span> <span class="fu">kmeans</span>(data, <span class="at">centers =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(d) Calculate the Within Sum of Squares (WSS) for the clustering assignment in (c).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb318"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb318-1"><a href="#cb318-1" aria-hidden="true" tabindex="-1"></a>kout<span class="sc">$</span>withinss</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.833333 0.625000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb320"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb320-1"><a href="#cb320-1" aria-hidden="true" tabindex="-1"></a>kout<span class="sc">$</span>tot.withinss</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.458333</code></pre>
</div>
</div>
<ol start="2" type="1">
<li>(K-Means) Consider data set <code>hdb-2012-to-2014.csv</code> which was extracted from the published data. The file has information on the HDB resale flats from Jan 2012 to Dec 2014.</li>
</ol>
<p>(a) Load data into R. Use k-means algorithm to pick an optimal value for k in terms of <strong>WSS</strong>, based on two variables, <code>resale_price</code> and <code>floor_area_sqm</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb322"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb322-1"><a href="#cb322-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"hdb-2012-to-2014.csv"</span>)</span>
<span id="cb322-2"><a href="#cb322-2" aria-hidden="true" tabindex="-1"></a><span class="co"># str(df)</span></span>
<span id="cb322-3"><a href="#cb322-3" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>X <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb322-4"><a href="#cb322-4" aria-hidden="true" tabindex="-1"></a>numeric_df <span class="ot">&lt;-</span> df[<span class="fu">sapply</span>(df, is.numeric)]</span>
<span id="cb322-5"><a href="#cb322-5" aria-hidden="true" tabindex="-1"></a>numeric_df <span class="ot">&lt;-</span> <span class="fu">scale</span>(numeric_df)</span>
<span id="cb322-6"><a href="#cb322-6" aria-hidden="true" tabindex="-1"></a><span class="co"># str(numeric_df)</span></span>
<span id="cb322-7"><a href="#cb322-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb322-8"><a href="#cb322-8" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb322-9"><a href="#cb322-9" aria-hidden="true" tabindex="-1"></a>wss <span class="ot">&lt;-</span> <span class="fu">numeric</span>(K)</span>
<span id="cb322-10"><a href="#cb322-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>K) {</span>
<span id="cb322-11"><a href="#cb322-11" aria-hidden="true" tabindex="-1"></a>  kout <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(numeric_df[,<span class="fu">c</span>(<span class="st">"resale_price"</span>, <span class="st">"floor_area_sqm"</span>)], <span class="at">centers =</span> k)</span>
<span id="cb322-12"><a href="#cb322-12" aria-hidden="true" tabindex="-1"></a>  wss[k] <span class="ot">&lt;-</span> kout<span class="sc">$</span>tot.withinss</span>
<span id="cb322-13"><a href="#cb322-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb322-14"><a href="#cb322-14" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(wss)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 12092.0000  5504.6301  2993.4997  2095.7739  1793.0680  1567.9575
 [7]  1186.4503  1063.3284   970.4396   795.9938   725.1273   698.4266
[13]   656.0890   606.6262   571.2220   533.8408   507.0974   509.0501
[19]   433.0342   419.6298</code></pre>
</div>
<div class="sourceCode cell-code" id="cb324"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb324-1"><a href="#cb324-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span>K, wss, <span class="at">type=</span><span class="st">"b"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-100-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb325"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb325-1"><a href="#cb325-1" aria-hidden="true" tabindex="-1"></a><span class="co"># k = 3 is a good choice, </span></span>
<span id="cb325-2"><a href="#cb325-2" aria-hidden="true" tabindex="-1"></a><span class="co"># because the reduction in WSS </span></span>
<span id="cb325-3"><a href="#cb325-3" aria-hidden="true" tabindex="-1"></a><span class="co"># from k = 3 to k = 4</span></span>
<span id="cb325-4"><a href="#cb325-4" aria-hidden="true" tabindex="-1"></a><span class="co"># is not significant</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(b) With the optimal k in part (a), plot the data points in the k clusters determined.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb326"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb326-1"><a href="#cb326-1" aria-hidden="true" tabindex="-1"></a>kout <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(numeric_df, <span class="at">centers =</span> <span class="dv">3</span>)</span>
<span id="cb326-2"><a href="#cb326-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb326-3"><a href="#cb326-3" aria-hidden="true" tabindex="-1"></a>  df<span class="sc">$</span>floor_area_sqm,</span>
<span id="cb326-4"><a href="#cb326-4" aria-hidden="true" tabindex="-1"></a>  df<span class="sc">$</span>resale_price,</span>
<span id="cb326-5"><a href="#cb326-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> kout<span class="sc">$</span>cluster</span>
<span id="cb326-6"><a href="#cb326-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-101-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb327"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb327-1"><a href="#cb327-1" aria-hidden="true" tabindex="-1"></a>unscaled_kout <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(df[,<span class="fu">c</span>(<span class="st">"floor_area_sqm"</span>, <span class="st">"resale_price"</span>)], <span class="at">centers =</span> <span class="dv">3</span>)</span>
<span id="cb327-2"><a href="#cb327-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb327-3"><a href="#cb327-3" aria-hidden="true" tabindex="-1"></a>  df<span class="sc">$</span>floor_area_sqm,</span>
<span id="cb327-4"><a href="#cb327-4" aria-hidden="true" tabindex="-1"></a>  df<span class="sc">$</span>resale_price,</span>
<span id="cb327-5"><a href="#cb327-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> unscaled_kout<span class="sc">$</span>cluster</span>
<span id="cb327-6"><a href="#cb327-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-102-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="onsite-questions-k-means-clustering" class="level3">
<h3 class="anchored" data-anchor-id="onsite-questions-k-means-clustering">Onsite Questions (K-Means Clustering)</h3>
<p>Consider the famous Iris Flower Data set which was first introduced in 1936 by the famous statistician Ronald Fisher. This data set consists of observations from flowers of Iris species. For each observation, four features were measured: the flower’s length and width of the sepals and petals (in cm).<br>
The data set is given in a file named <code>iris.csv</code>.</p>
<ol type="1">
<li><p>Use K-means clustering method to cluster all the flowers into k groups where k=1,2,3,…,10 where for each value of k the value of <strong>WSS</strong> - the within sum of squares is obtained.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb328"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb328-1"><a href="#cb328-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"iris.csv"</span>)</span>
<span id="cb328-2"><a href="#cb328-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   150 obs. of  5 variables:
 $ sepal.length: num  5.1 4.9 4.7 4.6 5 5.4 4.6 5 4.4 4.9 ...
 $ sepal.width : num  3.5 3 3.2 3.1 3.6 3.9 3.4 3.4 2.9 3.1 ...
 $ petal.length: num  1.4 1.4 1.3 1.5 1.4 1.7 1.4 1.5 1.4 1.5 ...
 $ petal.width : num  0.2 0.2 0.2 0.2 0.2 0.4 0.3 0.2 0.2 0.1 ...
 $ class       : chr  "Iris-setosa" "Iris-setosa" "Iris-setosa" "Iris-setosa" ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb330"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb330-1"><a href="#cb330-1" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>class <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb330-2"><a href="#cb330-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">scale</span>(df)</span>
<span id="cb330-3"><a href="#cb330-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb330-4"><a href="#cb330-4" aria-hidden="true" tabindex="-1"></a>wss_list <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">10</span>)</span>
<span id="cb330-5"><a href="#cb330-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10</span>)</span>
<span id="cb330-6"><a href="#cb330-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) {</span>
<span id="cb330-7"><a href="#cb330-7" aria-hidden="true" tabindex="-1"></a>  kout <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(df, <span class="at">centers =</span> k)</span>
<span id="cb330-8"><a href="#cb330-8" aria-hidden="true" tabindex="-1"></a>  wss_list[k] <span class="ot">&lt;-</span> kout<span class="sc">$</span>tot.withinss</span>
<span id="cb330-9"><a href="#cb330-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb330-10"><a href="#cb330-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(wss_list)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 596.00000 222.24046 140.02604 113.60040 105.71145  81.67272  88.44134
 [8]  66.71099  57.17694  47.35887</code></pre>
</div>
</div></li>
<li><p>Write code to obtain the plot of <strong>WSS</strong> against k. Which value of k would you choose as the number of clusters for all the observations in the data set? Explain.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb332"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb332-1"><a href="#cb332-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, wss_list, </span>
<span id="cb332-2"><a href="#cb332-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">'b'</span>,</span>
<span id="cb332-3"><a href="#cb332-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">"black"</span>,</span>
<span id="cb332-4"><a href="#cb332-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Number of Clusters"</span>, </span>
<span id="cb332-5"><a href="#cb332-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Within Sum of Squares"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-104-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb333"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb333-1"><a href="#cb333-1" aria-hidden="true" tabindex="-1"></a><span class="co"># k = 3 is a good choice, </span></span>
<span id="cb333-2"><a href="#cb333-2" aria-hidden="true" tabindex="-1"></a><span class="co"># because the reduction in WSS </span></span>
<span id="cb333-3"><a href="#cb333-3" aria-hidden="true" tabindex="-1"></a><span class="co"># from k = 3 to k = 4</span></span>
<span id="cb333-4"><a href="#cb333-4" aria-hidden="true" tabindex="-1"></a><span class="co"># is not significant</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
<li><p>With the value of k chosen above, report the centroids of all the clusters and the number of the observations in each cluster.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb334"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb334-1"><a href="#cb334-1" aria-hidden="true" tabindex="-1"></a>kout <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(df, <span class="at">centers =</span> <span class="dv">3</span>)</span>
<span id="cb334-2"><a href="#cb334-2" aria-hidden="true" tabindex="-1"></a>kout<span class="sc">$</span>centers</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  sepal.length sepal.width petal.length petal.width
1  -1.01119138   0.8394944   -1.3005215  -1.2509379
2   1.13217737   0.0962759    0.9929445   1.0137756
3  -0.05005221  -0.8773526    0.3463713   0.2811215</code></pre>
</div>
<div class="sourceCode cell-code" id="cb336"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb336-1"><a href="#cb336-1" aria-hidden="true" tabindex="-1"></a>kout<span class="sc">$</span>size</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 50 47 53</code></pre>
</div>
</div></li>
</ol>
</section>
</section>
<section id="t11-association-rules" class="level2">
<h2 class="anchored" data-anchor-id="t11-association-rules">T11 (Association Rules)</h2>
<p>Machine learning concept used in Market Based Analysis</p>
<ul>
<li><p>Patterns of co-occurrence</p></li>
<li><p>Link between products purchased together</p></li>
</ul>
<p>Rules <strong>do not</strong> extract an individual’s preference, rather find relationships between set of elements of every distinct transaction. Different from collaborative filtering.</p>
<p><strong>Support:</strong> Measure of how frequent an itemset is in all the transactions.</p>
<p><img src="images/clipboard-2372333094.png" class="img-fluid"></p>
<p><strong>Confidence:</strong> Measure of likeliness of occurrence of buying a specific item given that the user is buying another item.</p>
<p><img src="images/clipboard-1735566391.png" class="img-fluid"></p>
<p><strong>Lift:</strong> The rise in probability of having {Y} in the cart with the knowledge of {X} being present (compared to no knowledge on {X} being present)</p>
<p><img src="images/clipboard-832366.png" class="img-fluid"></p>
<p>Lift &lt; 1 : Having {X} on the cart does not increase the chances of occurrence of {Y} on the cart</p>
<p>Lift &gt; 1 :&nbsp; Vouches for high association between {Y} and {X}. Higher value indicates greater chances of preference to buy {Y} if the customer has already bought {X}</p>
<p><strong>Leverage:</strong> Similar notion to Lift, except instead of using Ratios, it uses differences</p>
<p><img src="images/clipboard-3216104608.png" class="img-fluid"></p>
<p>Similar notion to Lift, except instead of using Ratios, it uses differences</p>
<p>Leverage &gt; 0 : Strong relationship for {X} -&gt; {Y}</p>
<p>Leverage = 0 : Statistically Independent ({X} does not affect {Y})</p>
<p>Leverage &lt; 0 : Negative relationship between {X} and {Y}</p>
<section id="offsite-questions-association-rules-mathematics" class="level3">
<h3 class="anchored" data-anchor-id="offsite-questions-association-rules-mathematics">Offsite Questions (Association Rules Mathematics)</h3>
<ol type="1">
<li>A local retailer has a database that stores 10,000 transactions of last summer. After analyzing the data, a data science team has identified the following statistics:</li>
</ol>
<ul>
<li>{battery} appears in 6000 transactions</li>
<li>{sunscreen} appears in 5000 transactions</li>
<li>{sandals} appears in 4000 transactions</li>
<li>{bowls} appears in 2000 transactions</li>
<li>{battery, sunscreen} appears in 1500 transactions</li>
<li>{battery, sandals} appears in 1000 transactions</li>
<li>{battery, bowls} appears in 250 transactions</li>
<li>{battery, sunscreen, sandals} appears in 600 transactions</li>
</ul>
<ol type="a">
<li><p>What are the support values of the preceding itemsets?</p>
<p><img src="images/clipboard-4287054081.png" class="img-fluid"></p></li>
<li><p>Assuming the minimum support is 0.05, which itemsets are considered frequent?</p>
<p><img src="images/clipboard-3013610408.png" class="img-fluid"></p></li>
<li><p>What are the confidence values of {battery} → {sunscreen} and {battery, sunscreen} → {sandals}? Which of these two rules is more interesting, i.e., has higher values of confidence?</p></li>
</ol>
<p><img src="images/clipboard-3457055832.png" class="img-fluid"></p>
<ol start="2" type="1">
<li>Suppose for three products ( A, B ) and ( C ), support({A}) = 0.6, support({B}) = 0.6, confidence({B} → {A}) = 0.9 and confidence({C} → {A, B}) = 0.5. Compute the following quantities:
<ul>
<li><p>Lift({A} → {B})</p></li>
<li><p>Leverage({A} → {B})</p></li>
<li><p>Confidence({A} → {B})</p></li>
<li><p>Lift({A, B} → {C})</p>
<p><img src="images/clipboard-1247641227.png" class="img-fluid"></p></li>
</ul></li>
</ol>
</section>
<section id="qa" class="level3">
<h3 class="anchored" data-anchor-id="qa">Q&amp;A</h3>
<ol type="1">
<li><p>Can you explain the order function?</p>
<p>Returns indexes of sorted version of vector passed to it</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb338"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb338-1"><a href="#cb338-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">9</span>, <span class="dv">18</span>, <span class="dv">5</span>, <span class="dv">15</span>, <span class="dv">12</span>)</span>
<span id="cb338-2"><a href="#cb338-2" aria-hidden="true" tabindex="-1"></a><span class="fu">order</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3 1 5 4 2</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb340"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb340-1"><a href="#cb340-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">9</span>, <span class="dv">18</span>, <span class="dv">5</span>, <span class="dv">15</span>, <span class="dv">12</span>)</span>
<span id="cb340-2"><a href="#cb340-2" aria-hidden="true" tabindex="-1"></a>sorted_indexes <span class="ot">&lt;-</span> <span class="fu">order</span>(x)</span>
<span id="cb340-3"><a href="#cb340-3" aria-hidden="true" tabindex="-1"></a>x[sorted_indexes]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  5  9 12 15 18</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb342"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb342-1"><a href="#cb342-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">9</span>, <span class="dv">18</span>, <span class="dv">5</span>, <span class="dv">15</span>, <span class="dv">12</span>)</span>
<span id="cb342-2"><a href="#cb342-2" aria-hidden="true" tabindex="-1"></a>x[<span class="fu">order</span>(x)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  5  9 12 15 18</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb344"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb344-1"><a href="#cb344-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb344-2"><a href="#cb344-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">9</span>, <span class="dv">18</span>, <span class="dv">5</span>, <span class="dv">15</span>, <span class="dv">12</span>),</span>
<span id="cb344-3"><a href="#cb344-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"D"</span>, <span class="st">"E"</span>))</span>
<span id="cb344-4"><a href="#cb344-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-5"><a href="#cb344-5" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   x y
1  9 A
2 18 B
3  5 C
4 15 D
5 12 E</code></pre>
</div>
<div class="sourceCode cell-code" id="cb346"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb346-1"><a href="#cb346-1" aria-hidden="true" tabindex="-1"></a>sorted_index <span class="ot">&lt;-</span> <span class="fu">order</span>(df<span class="sc">$</span>x)</span>
<span id="cb346-2"><a href="#cb346-2" aria-hidden="true" tabindex="-1"></a>df[sorted_index, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   x y
3  5 C
1  9 A
5 12 E
4 15 D
2 18 B</code></pre>
</div>
<div class="sourceCode cell-code" id="cb348"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb348-1"><a href="#cb348-1" aria-hidden="true" tabindex="-1"></a>sorted_index <span class="ot">&lt;-</span> <span class="fu">order</span>(df<span class="sc">$</span>x, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb348-2"><a href="#cb348-2" aria-hidden="true" tabindex="-1"></a>df[sorted_index, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   x y
2 18 B
4 15 D
5 12 E
1  9 A
3  5 C</code></pre>
</div>
</div></li>
<li><p>Is it possible to give a template code for every topic?</p>
<ul>
<li><p>Template code is provided in the Tutorial R Code files on Canvas</p></li>
<li><p>Can also look through previous tutorial slides for sample code</p></li>
<li><p>Go through the code, understand the logic and be prepared to modify it where necessary to suit the final’s questions’ needs</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb350"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb350-1"><a href="#cb350-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (3.e) Repeat question 3d for k = 3, 5, 10. Which k gives the best precision?</span></span>
<span id="cb350-2"><a href="#cb350-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-3"><a href="#cb350-3" aria-hidden="true" tabindex="-1"></a>k_values <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb350-4"><a href="#cb350-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (k_val <span class="cf">in</span> k_values) {</span>
<span id="cb350-5"><a href="#cb350-5" aria-hidden="true" tabindex="-1"></a>  knn.pred <span class="ot">&lt;-</span> <span class="fu">knn</span>(train.X, test.X, train.Y, <span class="at">k =</span> k_val) </span>
<span id="cb350-6"><a href="#cb350-6" aria-hidden="true" tabindex="-1"></a>  conf.matrix <span class="ot">&lt;-</span> <span class="fu">table</span>(test.Y, knn.pred)</span>
<span id="cb350-7"><a href="#cb350-7" aria-hidden="true" tabindex="-1"></a>  precision <span class="ot">&lt;-</span> conf.matrix[<span class="dv">2</span>,<span class="dv">2</span>]<span class="sc">/</span><span class="fu">sum</span>(conf.matrix[,<span class="dv">2</span>])</span>
<span id="cb350-8"><a href="#cb350-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(k_val, precision))</span>
<span id="cb350-9"><a href="#cb350-9" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb351"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb351-1"><a href="#cb351-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (1.e.) Use 5-fold cross validation to get average accuracy (K = 1).</span></span>
<span id="cb351-2"><a href="#cb351-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb351-3"><a href="#cb351-3" aria-hidden="true" tabindex="-1"></a>n_folds <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb351-4"><a href="#cb351-4" aria-hidden="true" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n_folds, <span class="at">length.out =</span> <span class="fu">dim</span>(data)[<span class="dv">1</span>])</span>
<span id="cb351-5"><a href="#cb351-5" aria-hidden="true" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">sample</span>(folds)</span>
<span id="cb351-6"><a href="#cb351-6" aria-hidden="true" tabindex="-1"></a>accuracies <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_folds)</span>
<span id="cb351-7"><a href="#cb351-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb351-8"><a href="#cb351-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (curr_fold <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_folds) {</span>
<span id="cb351-9"><a href="#cb351-9" aria-hidden="true" tabindex="-1"></a>  test_index <span class="ot">&lt;-</span> <span class="fu">which</span>(folds <span class="sc">==</span> curr_fold)</span>
<span id="cb351-10"><a href="#cb351-10" aria-hidden="true" tabindex="-1"></a>  train.X <span class="ot">&lt;-</span> standardised.X[<span class="sc">-</span>test_index,]</span>
<span id="cb351-11"><a href="#cb351-11" aria-hidden="true" tabindex="-1"></a>  test.X <span class="ot">&lt;-</span> standardised.X[test_index,]</span>
<span id="cb351-12"><a href="#cb351-12" aria-hidden="true" tabindex="-1"></a>  train.Y <span class="ot">&lt;-</span> data<span class="sc">$</span>Creditability[<span class="sc">-</span>test_index]</span>
<span id="cb351-13"><a href="#cb351-13" aria-hidden="true" tabindex="-1"></a>  test.Y <span class="ot">&lt;-</span> data<span class="sc">$</span>Creditability[test_index]</span>
<span id="cb351-14"><a href="#cb351-14" aria-hidden="true" tabindex="-1"></a>  pred <span class="ot">&lt;-</span> <span class="fu">knn</span>(train.X, test.X, train.Y, <span class="at">k =</span> <span class="dv">1</span>)</span>
<span id="cb351-15"><a href="#cb351-15" aria-hidden="true" tabindex="-1"></a>  accuracies[curr_fold] <span class="ot">&lt;-</span> <span class="fu">mean</span>(test.Y <span class="sc">==</span> pred)</span>
<span id="cb351-16"><a href="#cb351-16" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
<li><p>If a NB question has numeric inputs in the dataset given, are we expected to change it to categorical by using as.factor? Even if qn doesn’t say anything? Or qn wud usually specify?</p>
<ul>
<li><p>Naive Bayes can actually handle numeric features, but it is not taught in this course</p></li>
<li><p>As such, any features for Naive Bayes should be categorical</p></li>
<li><p>Do not change it to categorical yourself, question will usually specify</p></li>
</ul>
<ol type="1">
<li>Can you explain conditional entropy and its calculation?
<ul>
<li><p>Entropy is a measure of the randomness</p>
<p><img src="images/clipboard-451619793.png" class="img-fluid"></p></li>
<li><p>Imagine using this to measure entropy of flipping a coin</p>
<p><img src="images/clipboard-157113776.png" class="img-fluid"></p></li>
<li><p>Formula for conditional entropy</p>
<p><img src="images/clipboard-3492415708.png" class="img-fluid"></p></li>
</ul></li>
</ol></li>
</ol>
</section>
</section>
</section>
<section id="midterm-practice" class="level1">
<h1>Midterm Practice</h1>
<ol type="1">
<li><p>(50 points) The data file patient_satisfaction.csv is a random sample collected from a<br>
hospital about the satisfactory of patients about the hospital’s service when they were discharged.<br>
The data set includes information about patient’s age, the score of illness severity, the anxiety<br>
score, and the status if the patient went through surgery (1) or only had medical treatment (0).<br>
The given file contains columns with names listed below.</p>
<p><img src="images/clipboard-3191248250.png" class="img-fluid"></p>
<p>please run function setwd() in a separate line (if you need it) when importing the data set<br>
into R. Use set.seed(310)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb352"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb352-1"><a href="#cb352-1" aria-hidden="true" tabindex="-1"></a><span class="co"># setwd("/Users/rayana/Desktop/DSAFIN")</span></span>
<span id="cb352-2"><a href="#cb352-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">310</span>)</span>
<span id="cb352-3"><a href="#cb352-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb352-4"><a href="#cb352-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Part 1 ##</span></span>
<span id="cb352-5"><a href="#cb352-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb352-6"><a href="#cb352-6" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Patient Satisfaction.csv"</span>)</span>
<span id="cb352-7"><a href="#cb352-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Q1</span></span>
<span id="cb352-8"><a href="#cb352-8" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(data)[<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="st">"Surgical"</span></span>
<span id="cb352-9"><a href="#cb352-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Q2</span></span>
<span id="cb352-10"><a href="#cb352-10" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(data<span class="sc">$</span>Surgical))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
   0    1 
0.44 0.56 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb354"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb354-1"><a href="#cb354-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 56% patients had surgery</span></span>
<span id="cb354-2"><a href="#cb354-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Q3</span></span>
<span id="cb354-3"><a href="#cb354-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(data<span class="sc">$</span>Satisfaction, <span class="at">probability =</span> <span class="cn">TRUE</span>, </span>
<span id="cb354-4"><a href="#cb354-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Histogram of Satisfaction with Normal Density Curve"</span>,</span>
<span id="cb354-5"><a href="#cb354-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Satisfaction"</span>, <span class="at">col =</span> <span class="st">"lightblue"</span>, <span class="at">border =</span> <span class="st">"black"</span>)</span>
<span id="cb354-6"><a href="#cb354-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb354-7"><a href="#cb354-7" aria-hidden="true" tabindex="-1"></a>x_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(data<span class="sc">$</span>Satisfaction), <span class="fu">max</span>(data<span class="sc">$</span>Satisfaction), <span class="at">length =</span> <span class="dv">100</span>)</span>
<span id="cb354-8"><a href="#cb354-8" aria-hidden="true" tabindex="-1"></a>y_values <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(x_values, <span class="at">mean =</span> <span class="fu">mean</span>(data<span class="sc">$</span>Satisfaction), <span class="at">sd =</span> <span class="fu">sd</span>(data<span class="sc">$</span>Satisfaction))</span>
<span id="cb354-9"><a href="#cb354-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x_values, y_values, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-112-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb355"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb355-1"><a href="#cb355-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Q4</span></span>
<span id="cb355-2"><a href="#cb355-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(data<span class="sc">$</span>Satisfaction, <span class="at">pch =</span> <span class="dv">20</span>)</span>
<span id="cb355-3"><a href="#cb355-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(data<span class="sc">$</span>Satisfaction, <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-113-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb356"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb356-1"><a href="#cb356-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Comments:</span></span>
<span id="cb356-2"><a href="#cb356-2" aria-hidden="true" tabindex="-1"></a><span class="co"># BOTH LEFT TAIL AND RIGHT TAIL ARE NOT CLEARLY CONTRADICT FROM NORMAL </span></span>
<span id="cb356-3"><a href="#cb356-3" aria-hidden="true" tabindex="-1"></a><span class="co"># SOME MIGHT SAY: RIGHT TAIL POSSIBLY/LIGHTLY SHORTER THAN NORMAL</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb357"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb357-1"><a href="#cb357-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Q5</span></span>
<span id="cb357-2"><a href="#cb357-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb357-3"><a href="#cb357-3" aria-hidden="true" tabindex="-1"></a>bp <span class="ot">&lt;-</span> <span class="fu">boxplot</span>(data<span class="sc">$</span>Satisfaction <span class="sc">~</span> data<span class="sc">$</span>Surgical)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-114-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb358"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb358-1"><a href="#cb358-1" aria-hidden="true" tabindex="-1"></a><span class="co"># outliers &lt;- bp$out</span></span>
<span id="cb358-2"><a href="#cb358-2" aria-hidden="true" tabindex="-1"></a><span class="co"># length(outliers)</span></span>
<span id="cb358-3"><a href="#cb358-3" aria-hidden="true" tabindex="-1"></a><span class="co"># index &lt;- which(data$Satisfaction %in% outliers)</span></span>
<span id="cb358-4"><a href="#cb358-4" aria-hidden="true" tabindex="-1"></a><span class="co"># fev[index,]</span></span>
<span id="cb358-5"><a href="#cb358-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb358-6"><a href="#cb358-6" aria-hidden="true" tabindex="-1"></a><span class="co"># the median point of satisfaction for patients got surgical is lower.</span></span>
<span id="cb358-7"><a href="#cb358-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 2 boxes are overlapping. </span></span>
<span id="cb358-8"><a href="#cb358-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Hence, NO clear difference in the satisfaction points of patients with or without surgical. </span></span>
<span id="cb358-9"><a href="#cb358-9" aria-hidden="true" tabindex="-1"></a><span class="co"># no outlier for both groups </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb359"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb359-1"><a href="#cb359-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Q6</span></span>
<span id="cb359-2"><a href="#cb359-2" aria-hidden="true" tabindex="-1"></a><span class="co">#unsurge = data$Satisfaction[which(data$Surgical==0)]</span></span>
<span id="cb359-3"><a href="#cb359-3" aria-hidden="true" tabindex="-1"></a><span class="co">#surge = data$Satisfaction[which(data$Surgical==1)] </span></span>
<span id="cb359-4"><a href="#cb359-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-5"><a href="#cb359-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(data<span class="sc">$</span>Satisfaction <span class="sc">~</span> data<span class="sc">$</span>Age, <span class="at">type =</span> <span class="st">"n"</span>)</span>
<span id="cb359-6"><a href="#cb359-6" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(data<span class="sc">$</span>Satisfaction[<span class="fu">which</span>(data<span class="sc">$</span>Surgical <span class="sc">==</span> <span class="dv">1</span>)] <span class="sc">~</span> data<span class="sc">$</span>Age[<span class="fu">which</span>(data<span class="sc">$</span>Surgical<span class="sc">==</span><span class="dv">1</span>)], <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">pch =</span> <span class="dv">20</span>)</span>
<span id="cb359-7"><a href="#cb359-7" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(data<span class="sc">$</span>Satisfaction[<span class="fu">which</span>(data<span class="sc">$</span>Surgical <span class="sc">==</span> <span class="dv">0</span>)] <span class="sc">~</span> data<span class="sc">$</span>Age[<span class="fu">which</span>(data<span class="sc">$</span>Surgical<span class="sc">==</span><span class="dv">0</span>)], <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">pch =</span> <span class="dv">20</span>)</span>
<span id="cb359-8"><a href="#cb359-8" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="dv">25</span>, <span class="dv">50</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Surgical"</span>, <span class="st">"No surgical"</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>,<span class="st">"blue"</span>), <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">20</span>,<span class="dv">20</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-115-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb360"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb360-1"><a href="#cb360-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(data<span class="sc">$</span>Satisfaction, data<span class="sc">$</span>Age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.8707049</code></pre>
</div>
<div class="sourceCode cell-code" id="cb362"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb362-1"><a href="#cb362-1" aria-hidden="true" tabindex="-1"></a><span class="co"># -0.87</span></span>
<span id="cb362-2"><a href="#cb362-2" aria-hidden="true" tabindex="-1"></a><span class="co"># strong negative association, quite linear  </span></span>
<span id="cb362-3"><a href="#cb362-3" aria-hidden="true" tabindex="-1"></a><span class="co"># the variablity of satisfaction is quite stable when age changes </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb363"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb363-1"><a href="#cb363-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Part 2 ##</span></span>
<span id="cb363-2"><a href="#cb363-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Q7</span></span>
<span id="cb363-3"><a href="#cb363-3" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Surgical <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(data<span class="sc">$</span>Surgical)</span>
<span id="cb363-4"><a href="#cb363-4" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">lm</span>(Satisfaction <span class="sc">~</span> ., <span class="at">data =</span> data)</span>
<span id="cb363-5"><a href="#cb363-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Satisfaction ~ ., data = data)

Residuals:
    Min      1Q  Median      3Q     Max 
-18.506  -5.096   1.306   4.738  28.722 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 140.1689     8.3191  16.849 2.77e-13 ***
Age          -1.1428     0.1904  -6.002 7.22e-06 ***
Severity     -0.4699     0.1866  -2.518   0.0204 *  
Surgical1     2.2259     4.1402   0.538   0.5968    
Anxiety       1.2673     1.4922   0.849   0.4058    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 9.921 on 20 degrees of freedom
Multiple R-squared:  0.8183,    Adjusted R-squared:  0.7819 
F-statistic: 22.51 on 4 and 20 DF,  p-value: 3.611e-07</code></pre>
</div>
<div class="sourceCode cell-code" id="cb365"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb365-1"><a href="#cb365-1" aria-hidden="true" tabindex="-1"></a><span class="co"># (Surgical = 1) and Anxiety variables are not significant at significance level 0.1</span></span>
<span id="cb365-2"><a href="#cb365-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb365-3"><a href="#cb365-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Q8</span></span>
<span id="cb365-4"><a href="#cb365-4" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Age =</span> <span class="dv">35</span>, <span class="at">Severity =</span> <span class="dv">45</span>, <span class="at">Anxiety =</span> <span class="fl">2.5</span>, <span class="at">Surgical =</span> <span class="st">"0"</span>)</span>
<span id="cb365-5"><a href="#cb365-5" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Age =</span> <span class="dv">60</span>, <span class="at">Severity =</span> <span class="dv">40</span>, <span class="at">Anxiety =</span> <span class="dv">3</span>, <span class="at">Surgical =</span> <span class="st">"1"</span>)</span>
<span id="cb365-6"><a href="#cb365-6" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(M, <span class="at">newdata =</span> A)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1 
82.19378 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb367"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb367-1"><a href="#cb367-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(M, <span class="at">newdata =</span> B)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1 
58.83136 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb369"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb369-1"><a href="#cb369-1" aria-hidden="true" tabindex="-1"></a><span class="co"># REPORT THE OUTCOMES</span></span>
<span id="cb369-2"><a href="#cb369-2" aria-hidden="true" tabindex="-1"></a><span class="co"># A: 82.19378 </span></span>
<span id="cb369-3"><a href="#cb369-3" aria-hidden="true" tabindex="-1"></a><span class="co"># B: 58.83136</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb370"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb370-1"><a href="#cb370-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Part 3 ##</span></span>
<span id="cb370-2"><a href="#cb370-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Q9</span></span>
<span id="cb370-3"><a href="#cb370-3" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>S <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(data<span class="sc">$</span>Satisfaction <span class="sc">&lt;=</span> <span class="dv">70</span>, <span class="st">"Not Good"</span>, <span class="st">"Good"</span>)</span>
<span id="cb370-4"><a href="#cb370-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Q10</span></span>
<span id="cb370-5"><a href="#cb370-5" aria-hidden="true" tabindex="-1"></a>data.X <span class="ot">&lt;-</span> <span class="fu">scale</span>(data[,<span class="fu">c</span>(<span class="st">"Age"</span>, <span class="st">"Severity"</span>, <span class="st">"Anxiety"</span>)])</span>
<span id="cb370-6"><a href="#cb370-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Q11</span></span>
<span id="cb370-7"><a href="#cb370-7" aria-hidden="true" tabindex="-1"></a>train.index <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(data), <span class="at">size =</span> <span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb371"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb371-1"><a href="#cb371-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Q12</span></span>
<span id="cb371-2"><a href="#cb371-2" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> data<span class="sc">$</span>S</span>
<span id="cb371-3"><a href="#cb371-3" aria-hidden="true" tabindex="-1"></a>train.X <span class="ot">&lt;-</span> data.X[train.index, ]  </span>
<span id="cb371-4"><a href="#cb371-4" aria-hidden="true" tabindex="-1"></a>test.X <span class="ot">&lt;-</span> data.X[<span class="sc">-</span>train.index, ] </span>
<span id="cb371-5"><a href="#cb371-5" aria-hidden="true" tabindex="-1"></a>train.y <span class="ot">&lt;-</span> Y[train.index] </span>
<span id="cb371-6"><a href="#cb371-6" aria-hidden="true" tabindex="-1"></a>test.y <span class="ot">&lt;-</span> Y[<span class="sc">-</span>train.index] </span>
<span id="cb371-7"><a href="#cb371-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb371-8"><a href="#cb371-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(class)</span>
<span id="cb371-9"><a href="#cb371-9" aria-hidden="true" tabindex="-1"></a>k_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">9</span>, <span class="dv">11</span>)</span>
<span id="cb371-10"><a href="#cb371-10" aria-hidden="true" tabindex="-1"></a>accuracy <span class="ot">&lt;-</span> <span class="fu">numeric</span>()  </span>
<span id="cb371-11"><a href="#cb371-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb371-12"><a href="#cb371-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> k_values) {  </span>
<span id="cb371-13"><a href="#cb371-13" aria-hidden="true" tabindex="-1"></a>    knn.pred <span class="ot">&lt;-</span> <span class="fu">knn</span>(train.X, test.X, train.y, <span class="at">k =</span> k) </span>
<span id="cb371-14"><a href="#cb371-14" aria-hidden="true" tabindex="-1"></a>    confusion.matrix <span class="ot">&lt;-</span> <span class="fu">table</span>(test.y, knn.pred)  </span>
<span id="cb371-15"><a href="#cb371-15" aria-hidden="true" tabindex="-1"></a>    accuracy <span class="ot">&lt;-</span> <span class="fu">append</span>(accuracy, <span class="fu">sum</span>(<span class="fu">diag</span>(confusion.matrix)) <span class="sc">/</span> <span class="fu">sum</span>(confusion.matrix))  </span>
<span id="cb371-16"><a href="#cb371-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb371-17"><a href="#cb371-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb371-18"><a href="#cb371-18" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(accuracy)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8 0.8 0.8 0.7 0.7</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb373"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb373-1"><a href="#cb373-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Q13</span></span>
<span id="cb373-2"><a href="#cb373-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(k_values, accuracy, <span class="at">type =</span> <span class="st">"b"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-119-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb374"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb374-1"><a href="#cb374-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Q14</span></span>
<span id="cb374-2"><a href="#cb374-2" aria-hidden="true" tabindex="-1"></a><span class="co"># best k is either 3,5,7</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb375"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb375-1"><a href="#cb375-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Q15</span></span>
<span id="cb375-2"><a href="#cb375-2" aria-hidden="true" tabindex="-1"></a>scaled_A <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb375-3"><a href="#cb375-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Age =</span> (A<span class="sc">$</span>Age <span class="sc">-</span> <span class="fu">mean</span>(data<span class="sc">$</span>Age)) <span class="sc">/</span> <span class="fu">sd</span>(data<span class="sc">$</span>Age),</span>
<span id="cb375-4"><a href="#cb375-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Severity =</span> (A<span class="sc">$</span>Severity <span class="sc">-</span> <span class="fu">mean</span>(data<span class="sc">$</span>Severity)) <span class="sc">/</span> <span class="fu">sd</span>(data<span class="sc">$</span>Severity),</span>
<span id="cb375-5"><a href="#cb375-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Anxiety =</span> (A<span class="sc">$</span>Anxiety <span class="sc">-</span> <span class="fu">mean</span>(data<span class="sc">$</span>Anxiety)) <span class="sc">/</span> <span class="fu">sd</span>(data<span class="sc">$</span>Anxiety)</span>
<span id="cb375-6"><a href="#cb375-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb375-7"><a href="#cb375-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8"><a href="#cb375-8" aria-hidden="true" tabindex="-1"></a>knn.pred <span class="ot">&lt;-</span> <span class="fu">knn</span>(train.X, scaled_A, train.y, <span class="at">k =</span> <span class="dv">3</span>)</span>
<span id="cb375-9"><a href="#cb375-9" aria-hidden="true" tabindex="-1"></a>knn.pred</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] Good
Levels: Good Not Good</code></pre>
</div>
<div class="sourceCode cell-code" id="cb377"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb377-1"><a href="#cb377-1" aria-hidden="true" tabindex="-1"></a><span class="co"># REPORT: PATIENT A is predicted as will rank Good for for hospital service. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb378"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb378-1"><a href="#cb378-1" aria-hidden="true" tabindex="-1"></a><span class="do">### 2</span></span>
<span id="cb378-2"><a href="#cb378-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Q1</span></span>
<span id="cb378-3"><a href="#cb378-3" aria-hidden="true" tabindex="-1"></a>annual_salary <span class="ot">&lt;-</span> <span class="dv">50000</span></span>
<span id="cb378-4"><a href="#cb378-4" aria-hidden="true" tabindex="-1"></a>salary_increase <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb378-5"><a href="#cb378-5" aria-hidden="true" tabindex="-1"></a>saving <span class="ot">&lt;-</span> <span class="dv">30000</span></span>
<span id="cb378-6"><a href="#cb378-6" aria-hidden="true" tabindex="-1"></a>target <span class="ot">&lt;-</span> <span class="dv">100000</span></span>
<span id="cb378-7"><a href="#cb378-7" aria-hidden="true" tabindex="-1"></a>saved_proportion <span class="ot">&lt;-</span> <span class="fl">0.2</span></span>
<span id="cb378-8"><a href="#cb378-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb378-9"><a href="#cb378-9" aria-hidden="true" tabindex="-1"></a>function.year <span class="ot">&lt;-</span> <span class="cf">function</span>(annual_salary, salary_increase, saving, target, saved_proportion) {</span>
<span id="cb378-10"><a href="#cb378-10" aria-hidden="true" tabindex="-1"></a>  year <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb378-11"><a href="#cb378-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> (saving <span class="sc">&lt;</span> target) {</span>
<span id="cb378-12"><a href="#cb378-12" aria-hidden="true" tabindex="-1"></a>    annual_salary <span class="ot">&lt;-</span> annual_salary <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> salary_increase)</span>
<span id="cb378-13"><a href="#cb378-13" aria-hidden="true" tabindex="-1"></a>    saving <span class="ot">&lt;-</span> saving <span class="sc">+</span> annual_salary <span class="sc">*</span> saved_proportion</span>
<span id="cb378-14"><a href="#cb378-14" aria-hidden="true" tabindex="-1"></a>    year <span class="ot">&lt;-</span> year <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb378-15"><a href="#cb378-15" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb378-16"><a href="#cb378-16" aria-hidden="true" tabindex="-1"></a> <span class="fu">return</span>(year)</span>
<span id="cb378-17"><a href="#cb378-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb378-18"><a href="#cb378-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb378-19"><a href="#cb378-19" aria-hidden="true" tabindex="-1"></a><span class="fu">function.year</span>(annual_salary, salary_increase, saving, target, saved_proportion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6</code></pre>
</div>
<div class="sourceCode cell-code" id="cb380"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb380-1"><a href="#cb380-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Alena need to save for 6 years</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb381"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb381-1"><a href="#cb381-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Q2</span></span>
<span id="cb381-2"><a href="#cb381-2" aria-hidden="true" tabindex="-1"></a>annual_salary <span class="ot">&lt;-</span> <span class="dv">50000</span></span>
<span id="cb381-3"><a href="#cb381-3" aria-hidden="true" tabindex="-1"></a>salary_increase <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb381-4"><a href="#cb381-4" aria-hidden="true" tabindex="-1"></a>saving <span class="ot">&lt;-</span> <span class="dv">30000</span></span>
<span id="cb381-5"><a href="#cb381-5" aria-hidden="true" tabindex="-1"></a>target <span class="ot">&lt;-</span> <span class="dv">100000</span></span>
<span id="cb381-6"><a href="#cb381-6" aria-hidden="true" tabindex="-1"></a>saved_proportion <span class="ot">&lt;-</span> <span class="fl">0.2</span></span>
<span id="cb381-7"><a href="#cb381-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb381-8"><a href="#cb381-8" aria-hidden="true" tabindex="-1"></a>year <span class="ot">&lt;-</span> <span class="fu">function.year</span>(annual_salary, salary_increase, saving, target, saved_proportion)</span>
<span id="cb381-9"><a href="#cb381-9" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> (year <span class="sc">&gt;</span> <span class="dv">5</span>) {</span>
<span id="cb381-10"><a href="#cb381-10" aria-hidden="true" tabindex="-1"></a>  saved_proportion <span class="ot">&lt;-</span> saved_proportion <span class="sc">+</span> <span class="fl">0.01</span></span>
<span id="cb381-11"><a href="#cb381-11" aria-hidden="true" tabindex="-1"></a>  year <span class="ot">&lt;-</span> <span class="fu">function.year</span>(annual_salary, salary_increase, saving, target, saved_proportion)</span>
<span id="cb381-12"><a href="#cb381-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb381-13"><a href="#cb381-13" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(saved_proportion)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.25</code></pre>
</div>
<div class="sourceCode cell-code" id="cb383"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb383-1"><a href="#cb383-1" aria-hidden="true" tabindex="-1"></a><span class="co"># smallest proportion of annual salary that she should save so that she could have enough</span></span>
<span id="cb383-2"><a href="#cb383-2" aria-hidden="true" tabindex="-1"></a><span class="co"># money for her start-up at the end of 2029 is 25%</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="final-practice" class="level1">
<h1>Final Practice</h1>
<section id="semester-2" class="level3">
<h3 class="anchored" data-anchor-id="semester-2">23/24 Semester 2</h3>
<p><img src="images/clipboard-1262997958.png" class="img-fluid"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb384"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb384-1"><a href="#cb384-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ===== Question 1 =====</span></span>
<span id="cb384-2"><a href="#cb384-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb384-3"><a href="#cb384-3" aria-hidden="true" tabindex="-1"></a><span class="co"># a) True.</span></span>
<span id="cb384-4"><a href="#cb384-4" aria-hidden="true" tabindex="-1"></a><span class="co"># b) True</span></span>
<span id="cb384-5"><a href="#cb384-5" aria-hidden="true" tabindex="-1"></a><span class="co"># c) False</span></span>
<span id="cb384-6"><a href="#cb384-6" aria-hidden="true" tabindex="-1"></a><span class="co"># d) False. </span></span>
<span id="cb384-7"><a href="#cb384-7" aria-hidden="true" tabindex="-1"></a><span class="co"># e) True</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/clipboard-42922271.png" class="img-fluid"></p>
<p><img src="images/clipboard-1716315755.png" class="img-fluid"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb385"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb385-1"><a href="#cb385-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ===== Question 2 =====</span></span>
<span id="cb385-2"><a href="#cb385-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb385-3"><a href="#cb385-3" aria-hidden="true" tabindex="-1"></a><span class="co"># a) Right skewed</span></span>
<span id="cb385-4"><a href="#cb385-4" aria-hidden="true" tabindex="-1"></a><span class="co"># b) Histogram</span></span>
<span id="cb385-5"><a href="#cb385-5" aria-hidden="true" tabindex="-1"></a><span class="co"># c) Scatter Plot </span></span>
<span id="cb385-6"><a href="#cb385-6" aria-hidden="true" tabindex="-1"></a><span class="co"># d) Box Plot </span></span>
<span id="cb385-7"><a href="#cb385-7" aria-hidden="true" tabindex="-1"></a><span class="co"># e) A </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/clipboard-1551795137.png" class="img-fluid"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb386"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb386-1"><a href="#cb386-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ===== Question 3 =====</span></span>
<span id="cb386-2"><a href="#cb386-2" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'crab.csv'</span>)</span>
<span id="cb386-3"><a href="#cb386-3" aria-hidden="true" tabindex="-1"></a>df1<span class="sc">$</span>color <span class="ot">=</span> <span class="fu">as.factor</span>(df1<span class="sc">$</span>color)</span>
<span id="cb386-4"><a href="#cb386-4" aria-hidden="true" tabindex="-1"></a>df1<span class="sc">$</span>spine <span class="ot">=</span> <span class="fu">as.factor</span>(df1<span class="sc">$</span>spine)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb387"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb387-1"><a href="#cb387-1" aria-hidden="true" tabindex="-1"></a><span class="do">## ---- PART I: LINEAR REGRESSION MODEL ----</span></span>
<span id="cb387-2"><a href="#cb387-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(df1<span class="sc">$</span>satell,<span class="at">col =</span> <span class="st">'red'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-126-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb388"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb388-1"><a href="#cb388-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The histogram for satell is heavily right skewed, </span></span>
<span id="cb388-2"><a href="#cb388-2" aria-hidden="true" tabindex="-1"></a><span class="co"># there are no gaps in the range of values, and</span></span>
<span id="cb388-3"><a href="#cb388-3" aria-hidden="true" tabindex="-1"></a><span class="co"># there might be suspected outliers in the data</span></span>
<span id="cb388-4"><a href="#cb388-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb388-5"><a href="#cb388-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(df1<span class="sc">$</span>width,df1<span class="sc">$</span>satell,<span class="at">pch =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-126-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb389"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb389-1"><a href="#cb389-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Comment: No clear association between satell and width.</span></span>
<span id="cb389-2"><a href="#cb389-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb389-3"><a href="#cb389-3" aria-hidden="true" tabindex="-1"></a>M1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(satell <span class="sc">~</span> color <span class="sc">+</span> spine <span class="sc">+</span> width <span class="sc">+</span> weight, <span class="at">data =</span> df1)</span>
<span id="cb389-4"><a href="#cb389-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M1)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.151085</code></pre>
</div>
<div class="sourceCode cell-code" id="cb391"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb391-1"><a href="#cb391-1" aria-hidden="true" tabindex="-1"></a><span class="co"># comment: R squared value of M1 is 0.151, this means that the model can only explain 15.1% of the variance of the dataset</span></span>
<span id="cb391-2"><a href="#cb391-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb391-3"><a href="#cb391-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Width is the most insignificant, it has the highest p-value</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/clipboard-3024193786.png" class="img-fluid"></p>
<p><img src="images/clipboard-147900429.png" class="img-fluid"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb392"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb392-1"><a href="#cb392-1" aria-hidden="true" tabindex="-1"></a><span class="do">## ---- PART II: LOGISTIC REGRESSION MODEL ----</span></span>
<span id="cb392-2"><a href="#cb392-2" aria-hidden="true" tabindex="-1"></a>df1<span class="sc">$</span>status <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(df1<span class="sc">$</span>satell <span class="sc">&gt;</span><span class="dv">0</span>, <span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb392-3"><a href="#cb392-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb392-4"><a href="#cb392-4" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(df1<span class="sc">$</span>status)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  0   1 
 62 111 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb394"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb394-1"><a href="#cb394-1" aria-hidden="true" tabindex="-1"></a><span class="co"># There are 111 female crabs that have at least 1 satellite </span></span>
<span id="cb394-2"><a href="#cb394-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb394-3"><a href="#cb394-3" aria-hidden="true" tabindex="-1"></a>CS.table <span class="ot">&lt;-</span> <span class="fu">table</span>(df1<span class="sc">$</span>color,df1<span class="sc">$</span>status)</span>
<span id="cb394-4"><a href="#cb394-4" aria-hidden="true" tabindex="-1"></a>CS.table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
     0  1
  2  3  9
  3 26 69
  4 18 26
  5 15  7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb396"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb396-1"><a href="#cb396-1" aria-hidden="true" tabindex="-1"></a><span class="co"># There are 69 female crabs that are of medium colour and has at least a satellite</span></span>
<span id="cb396-2"><a href="#cb396-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb396-3"><a href="#cb396-3" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(CS.table,<span class="at">margin =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   
            0         1
  2 0.2500000 0.7500000
  3 0.2736842 0.7263158
  4 0.4090909 0.5909091
  5 0.6818182 0.3181818</code></pre>
</div>
<div class="sourceCode cell-code" id="cb398"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb398-1"><a href="#cb398-1" aria-hidden="true" tabindex="-1"></a><span class="co"># P(Status = 1 | Color = 2) = 0.75</span></span>
<span id="cb398-2"><a href="#cb398-2" aria-hidden="true" tabindex="-1"></a><span class="co"># P(Status = 1 | Color = 3) = 0.73</span></span>
<span id="cb398-3"><a href="#cb398-3" aria-hidden="true" tabindex="-1"></a><span class="co"># P(Status = 1 | Color = 4) = 0.59</span></span>
<span id="cb398-4"><a href="#cb398-4" aria-hidden="true" tabindex="-1"></a><span class="co"># P(Status = 1 | Color = 5) = 0.32</span></span>
<span id="cb398-5"><a href="#cb398-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb398-6"><a href="#cb398-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Ans: There is a negative association between color and the probability that it has satellites.</span></span>
<span id="cb398-7"><a href="#cb398-7" aria-hidden="true" tabindex="-1"></a><span class="co">#      From the table, as color increases, meaning the darker the crab, </span></span>
<span id="cb398-8"><a href="#cb398-8" aria-hidden="true" tabindex="-1"></a><span class="co">#      the conditional probability that the crab has at least one satellite decreases. </span></span>
<span id="cb398-9"><a href="#cb398-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb398-10"><a href="#cb398-10" aria-hidden="true" tabindex="-1"></a>M2 <span class="ot">&lt;-</span> <span class="fu">glm</span>(status <span class="sc">~</span> width <span class="sc">+</span> weight <span class="sc">+</span> color, <span class="at">data =</span> df1,<span class="at">family =</span> binomial)</span>
<span id="cb398-11"><a href="#cb398-11" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = status ~ width + weight + color, family = binomial, 
    data = df1)

Coefficients:
            Estimate Std. Error z value Pr(&gt;|z|)  
(Intercept)  -8.6445     3.7703  -2.293   0.0219 *
width         0.2906     0.1901   1.528   0.1264  
weight        0.7727     0.6978   1.107   0.2681  
color3        0.1310     0.7419   0.177   0.8598  
color4       -0.1610     0.7801  -0.206   0.8364  
color5       -1.2453     0.8554  -1.456   0.1455  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 225.76  on 172  degrees of freedom
Residual deviance: 186.21  on 167  degrees of freedom
AIC: 198.21

Number of Fisher Scoring iterations: 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb400"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb400-1"><a href="#cb400-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Equation: log(p/(1-p)) = -8.6445 + 0.2906 * width </span></span>
<span id="cb400-2"><a href="#cb400-2" aria-hidden="true" tabindex="-1"></a><span class="co">#                                            + 0.7727 * weight</span></span>
<span id="cb400-3"><a href="#cb400-3" aria-hidden="true" tabindex="-1"></a><span class="co">#                                            + 0.1310 * I(color = 3)</span></span>
<span id="cb400-4"><a href="#cb400-4" aria-hidden="true" tabindex="-1"></a><span class="co">#                                            - 0.1610 * I(color = 4)</span></span>
<span id="cb400-5"><a href="#cb400-5" aria-hidden="true" tabindex="-1"></a><span class="co">#                                            - 1.2453 * I(color = 5)</span></span>
<span id="cb400-6"><a href="#cb400-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb400-7"><a href="#cb400-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Ans: I represents the indicator variable,</span></span>
<span id="cb400-8"><a href="#cb400-8" aria-hidden="true" tabindex="-1"></a><span class="co">#      and p represents the probability that a crab has at least one satellite</span></span>
<span id="cb400-9"><a href="#cb400-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb400-10"><a href="#cb400-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Ans: Coefficient of weight is 0.7727.</span></span>
<span id="cb400-11"><a href="#cb400-11" aria-hidden="true" tabindex="-1"></a><span class="co">#      This means with all other variables kept the same,</span></span>
<span id="cb400-12"><a href="#cb400-12" aria-hidden="true" tabindex="-1"></a><span class="co">#      for every 1kg increase in the weight of a crab, the log odds of that crab having at least 1 satellite increases by </span></span>
<span id="cb400-13"><a href="#cb400-13" aria-hidden="true" tabindex="-1"></a><span class="co">#      0.7727. Equivalently, for each 1kg increase in weight, </span></span>
<span id="cb400-14"><a href="#cb400-14" aria-hidden="true" tabindex="-1"></a><span class="co">#      the odds of a crab having at least 1 satellite will be e^0.7727 times higher. </span></span>
<span id="cb400-15"><a href="#cb400-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb400-16"><a href="#cb400-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Ans: Coefficient of medium color is 0.1310 and coefficient of darker color is -1.2453.</span></span>
<span id="cb400-17"><a href="#cb400-17" aria-hidden="true" tabindex="-1"></a><span class="co">#      This means with all other variables kept the same,</span></span>
<span id="cb400-18"><a href="#cb400-18" aria-hidden="true" tabindex="-1"></a><span class="co">#      the log odds of a crab with medium color having at least 1 satellite will be 0.1310 MORE than a crab with light color, and </span></span>
<span id="cb400-19"><a href="#cb400-19" aria-hidden="true" tabindex="-1"></a><span class="co">#      the log odds of a crab with dark color having at least 1 satellite be 1.2453 LESS than a crab with light color.</span></span>
<span id="cb400-20"><a href="#cb400-20" aria-hidden="true" tabindex="-1"></a><span class="co">#      This means that the log odds of a crab with medium color having at least 1 satellite will be 0.1310-(-1.2453) = 1.3763 MORE </span></span>
<span id="cb400-21"><a href="#cb400-21" aria-hidden="true" tabindex="-1"></a><span class="co">#      than a crab with darker color.</span></span>
<span id="cb400-22"><a href="#cb400-22" aria-hidden="true" tabindex="-1"></a><span class="co">#      Equivalently, This means the odds of having at least 1 satellite for a crab with a medium colour is </span></span>
<span id="cb400-23"><a href="#cb400-23" aria-hidden="true" tabindex="-1"></a><span class="co">#      e^1.3763 = 3.96 times more than that of a crab with darker color.</span></span>
<span id="cb400-24"><a href="#cb400-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb400-25"><a href="#cb400-25" aria-hidden="true" tabindex="-1"></a>width <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">26</span>,<span class="dv">30</span>)</span>
<span id="cb400-26"><a href="#cb400-26" aria-hidden="true" tabindex="-1"></a>weight <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">2.6</span>,<span class="fl">4.0</span>)</span>
<span id="cb400-27"><a href="#cb400-27" aria-hidden="true" tabindex="-1"></a>color <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"4"</span>,<span class="st">"2"</span>)</span>
<span id="cb400-28"><a href="#cb400-28" aria-hidden="true" tabindex="-1"></a>spine <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"1"</span>,<span class="st">"3"</span>)</span>
<span id="cb400-29"><a href="#cb400-29" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">=</span> <span class="fu">data.frame</span>(width,weight,color,spine);newdata</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  width weight color spine
1    26    2.6     4     1
2    30    4.0     2     3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb402"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb402-1"><a href="#cb402-1" aria-hidden="true" tabindex="-1"></a>log_reg_new_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(M2,<span class="at">newdata=</span> newdata,<span class="at">type =</span> <span class="st">'response'</span>)</span>
<span id="cb402-2"><a href="#cb402-2" aria-hidden="true" tabindex="-1"></a>log_reg_new_pred</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        1         2 
0.6811390 0.9594669 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb404"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb404-1"><a href="#cb404-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Probability of having satellites for crab A: 68.1%</span></span>
<span id="cb404-2"><a href="#cb404-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Probability of having satellites for crab B: 95.9%</span></span>
<span id="cb404-3"><a href="#cb404-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb404-4"><a href="#cb404-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  color spine width satell weight status
1     3     3  28.3      8   3.05      1
2     4     3  22.5      0   1.55      0
3     2     1  26.0      9   2.30      1
4     4     3  24.8      0   2.10      0
5     4     3  26.0      4   2.60      1
6     3     3  23.8      0   2.10      0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb406"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb406-1"><a href="#cb406-1" aria-hidden="true" tabindex="-1"></a>log_reg_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(M2,<span class="at">newdata =</span> df1,<span class="at">type =</span> <span class="st">'response'</span>)</span>
<span id="cb406-2"><a href="#cb406-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ROCR)</span>
<span id="cb406-3"><a href="#cb406-3" aria-hidden="true" tabindex="-1"></a>log_reg_prediction <span class="ot">&lt;-</span> <span class="fu">prediction</span>(log_reg_pred,df1[,<span class="dv">6</span>])</span>
<span id="cb406-4"><a href="#cb406-4" aria-hidden="true" tabindex="-1"></a>log_reg_perf <span class="ot">&lt;-</span> <span class="fu">performance</span>(log_reg_prediction, <span class="st">"tpr"</span>,<span class="st">"fpr"</span>)</span>
<span id="cb406-5"><a href="#cb406-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(log_reg_perf,<span class="at">col =</span> <span class="st">'red'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-127-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb407"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb407-1"><a href="#cb407-1" aria-hidden="true" tabindex="-1"></a>log_reg_auc <span class="ot">&lt;-</span> <span class="fu">performance</span>(log_reg_prediction,<span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb407-2"><a href="#cb407-2" aria-hidden="true" tabindex="-1"></a>log_reg_auc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7775356</code></pre>
</div>
<div class="sourceCode cell-code" id="cb409"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb409-1"><a href="#cb409-1" aria-hidden="true" tabindex="-1"></a><span class="co"># auc = 0.777</span></span>
<span id="cb409-2"><a href="#cb409-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb409-3"><a href="#cb409-3" aria-hidden="true" tabindex="-1"></a>delta_values <span class="ot">&lt;-</span> log_reg_perf<span class="sc">@</span>alpha.values[[<span class="dv">1</span>]]</span>
<span id="cb409-4"><a href="#cb409-4" aria-hidden="true" tabindex="-1"></a>fpr_values <span class="ot">&lt;-</span> log_reg_perf<span class="sc">@</span>x.values[[<span class="dv">1</span>]]</span>
<span id="cb409-5"><a href="#cb409-5" aria-hidden="true" tabindex="-1"></a>tpr_values <span class="ot">&lt;-</span>log_reg_perf<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb409-6"><a href="#cb409-6" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar =</span> <span class="fu">c</span>(<span class="dv">5</span> ,<span class="dv">5</span> ,<span class="dv">2</span> ,<span class="dv">5</span>))</span>
<span id="cb409-7"><a href="#cb409-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(delta_values ,tpr_values , <span class="at">xlab =</span><span class="st">"Threshold"</span>, <span class="at">xlim =</span><span class="fu">c</span>(<span class="dv">0</span> ,<span class="dv">1</span>) ,</span>
<span id="cb409-8"><a href="#cb409-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"True positive rate "</span>, <span class="at">type =</span><span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span>
<span id="cb409-9"><a href="#cb409-9" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>( <span class="at">new =</span><span class="st">"True"</span>)</span>
<span id="cb409-10"><a href="#cb409-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(delta_values ,fpr_values , <span class="at">xlab =</span><span class="st">""</span>, <span class="at">ylab =</span><span class="st">""</span>, <span class="at">axes =</span>F, <span class="at">xlim =</span><span class="fu">c</span>(<span class="dv">0</span> ,<span class="dv">1</span>) , <span class="at">type =</span><span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"red"</span> )</span>
<span id="cb409-11"><a href="#cb409-11" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>( <span class="at">side =</span><span class="dv">4</span>) <span class="co"># to create an axis at the 4th side</span></span>
<span id="cb409-12"><a href="#cb409-12" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="at">side =</span><span class="dv">4</span>, <span class="at">line =</span><span class="dv">3</span>, <span class="st">"False positive rate"</span>)</span>
<span id="cb409-13"><a href="#cb409-13" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">0.5</span> ,<span class="fl">0.4</span>, <span class="st">"FPR"</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb409-14"><a href="#cb409-14" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">0.58</span> ,<span class="fl">0.9</span> , <span class="st">"TPR"</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-127-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb410"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb410-1"><a href="#cb410-1" aria-hidden="true" tabindex="-1"></a>delta_indices <span class="ot">&lt;-</span> <span class="fu">which</span>(delta_values <span class="sc">&gt;=</span><span class="fl">0.59</span> <span class="sc">&amp;</span> delta_values <span class="sc">&lt;=</span><span class="fl">0.6</span>)</span>
<span id="cb410-2"><a href="#cb410-2" aria-hidden="true" tabindex="-1"></a>tpr_values[delta_indices]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7747748 0.7837838 0.8018018</code></pre>
</div>
<div class="sourceCode cell-code" id="cb412"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb412-1"><a href="#cb412-1" aria-hidden="true" tabindex="-1"></a>fpr_values[delta_indices]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3225806 0.3225806 0.3225806</code></pre>
</div>
<div class="sourceCode cell-code" id="cb414"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb414-1"><a href="#cb414-1" aria-hidden="true" tabindex="-1"></a>log_reg_pred_binary <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(log_reg_pred <span class="sc">&gt;=</span><span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dv">0</span>)</span>
<span id="cb414-2"><a href="#cb414-2" aria-hidden="true" tabindex="-1"></a>log_reg_cm <span class="ot">&lt;-</span> <span class="fu">table</span>(log_reg_pred_binary,df1[,<span class="st">"status"</span>])</span>
<span id="cb414-3"><a href="#cb414-3" aria-hidden="true" tabindex="-1"></a>log_reg_acc <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">diag</span>(log_reg_cm))<span class="sc">/</span><span class="fu">sum</span>(log_reg_cm)</span>
<span id="cb414-4"><a href="#cb414-4" aria-hidden="true" tabindex="-1"></a>log_reg_acc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7109827</code></pre>
</div>
<div class="sourceCode cell-code" id="cb416"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb416-1"><a href="#cb416-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Accuracy 0.711</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/clipboard-1859428080.png" class="img-fluid"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb417"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb417-1"><a href="#cb417-1" aria-hidden="true" tabindex="-1"></a><span class="do">## ---- PART III: NAIVE BAYES CLASSIFIER ----</span></span>
<span id="cb417-2"><a href="#cb417-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(e1071)</span>
<span id="cb417-3"><a href="#cb417-3" aria-hidden="true" tabindex="-1"></a>M3 <span class="ot">&lt;-</span> <span class="fu">naiveBayes</span>(status <span class="sc">~</span> color <span class="sc">+</span> spine <span class="sc">+</span> width <span class="sc">+</span> weight, <span class="at">data =</span> df1)</span>
<span id="cb417-4"><a href="#cb417-4" aria-hidden="true" tabindex="-1"></a>nb_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(M3,<span class="at">newdata=</span> df1[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>)])</span>
<span id="cb417-5"><a href="#cb417-5" aria-hidden="true" tabindex="-1"></a>nb_cm <span class="ot">&lt;-</span> <span class="fu">table</span>(nb_pred,df1[,<span class="st">"status"</span>])</span>
<span id="cb417-6"><a href="#cb417-6" aria-hidden="true" tabindex="-1"></a>nb_acc <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">diag</span>(nb_cm))<span class="sc">/</span><span class="fu">sum</span>(nb_cm)</span>
<span id="cb417-7"><a href="#cb417-7" aria-hidden="true" tabindex="-1"></a>nb_acc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7052023</code></pre>
</div>
<div class="sourceCode cell-code" id="cb419"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb419-1"><a href="#cb419-1" aria-hidden="true" tabindex="-1"></a><span class="co"># nb_acc: 0.705</span></span>
<span id="cb419-2"><a href="#cb419-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-3"><a href="#cb419-3" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(M3,<span class="at">newdata =</span>newdata,<span class="at">type =</span> <span class="st">'raw'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                0         1
[1,] 3.241578e-01 0.6758422
[2,] 8.438966e-05 0.9999156</code></pre>
</div>
<div class="sourceCode cell-code" id="cb421"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb421-1"><a href="#cb421-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Probability of having satellites for crab A: 67.6%</span></span>
<span id="cb421-2"><a href="#cb421-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Probability of having satellites for crab B: 99.9%</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/clipboard-2332687476.png" class="img-fluid"><br>
</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb422"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb422-1"><a href="#cb422-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ===== Question 4 =====</span></span>
<span id="cb422-2"><a href="#cb422-2" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'penguins-dsa1101.csv'</span>)</span>
<span id="cb422-3"><a href="#cb422-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data)</span>
<span id="cb422-4"><a href="#cb422-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(data<span class="sc">$</span>bill_depth,data<span class="sc">$</span>mass)</span>
<span id="cb422-5"><a href="#cb422-5" aria-hidden="true" tabindex="-1"></a><span class="co"># I would choose 2 clusters, just looking at the scatterplots</span></span>
<span id="cb422-6"><a href="#cb422-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb422-7"><a href="#cb422-7" aria-hidden="true" tabindex="-1"></a>data.X <span class="ot">=</span> <span class="fu">scale</span>(data[,<span class="fu">c</span>(<span class="st">"bill_depth"</span>,<span class="st">"mass"</span>)])</span>
<span id="cb422-8"><a href="#cb422-8" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">8</span> </span>
<span id="cb422-9"><a href="#cb422-9" aria-hidden="true" tabindex="-1"></a>wss <span class="ot">&lt;-</span> <span class="fu">numeric</span>(k)</span>
<span id="cb422-10"><a href="#cb422-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb422-11"><a href="#cb422-11" aria-hidden="true" tabindex="-1"></a>  kout <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(data.X,<span class="at">centers =</span> i)</span>
<span id="cb422-12"><a href="#cb422-12" aria-hidden="true" tabindex="-1"></a>  wss[i] <span class="ot">&lt;-</span> kout<span class="sc">$</span>tot.withinss</span>
<span id="cb422-13"><a href="#cb422-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb422-14"><a href="#cb422-14" aria-hidden="true" tabindex="-1"></a>wss</span>
<span id="cb422-15"><a href="#cb422-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb422-16"><a href="#cb422-16" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span>k,wss,<span class="at">type =</span> <span class="st">'b'</span>)</span>
<span id="cb422-17"><a href="#cb422-17" aria-hidden="true" tabindex="-1"></a><span class="co"># I would choose 5 clusters. </span></span>
<span id="cb422-18"><a href="#cb422-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb422-19"><a href="#cb422-19" aria-hidden="true" tabindex="-1"></a>kout <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(data.X,<span class="at">centers =</span> <span class="dv">5</span>)</span>
<span id="cb422-20"><a href="#cb422-20" aria-hidden="true" tabindex="-1"></a>kout<span class="sc">$</span>centers</span>
<span id="cb422-21"><a href="#cb422-21" aria-hidden="true" tabindex="-1"></a><span class="co"># bill_depth       mass</span></span>
<span id="cb422-22"><a href="#cb422-22" aria-hidden="true" tabindex="-1"></a><span class="co">#1  0.1678949 -0.9957828</span></span>
<span id="cb422-23"><a href="#cb422-23" aria-hidden="true" tabindex="-1"></a><span class="co">#2 -0.4620534  1.8340519</span></span>
<span id="cb422-24"><a href="#cb422-24" aria-hidden="true" tabindex="-1"></a><span class="co">#3  1.0700111 -0.2252665</span></span>
<span id="cb422-25"><a href="#cb422-25" aria-hidden="true" tabindex="-1"></a><span class="co">#4 -1.5269045  0.5077693</span></span>
<span id="cb422-26"><a href="#cb422-26" aria-hidden="true" tabindex="-1"></a><span class="co">#5 -1.0217963  1.2903276</span></span>
<span id="cb422-27"><a href="#cb422-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb422-28"><a href="#cb422-28" aria-hidden="true" tabindex="-1"></a>kout<span class="sc">$</span>size</span>
<span id="cb422-29"><a href="#cb422-29" aria-hidden="true" tabindex="-1"></a><span class="co"># [1] 110  31 109  53  39</span></span>
<span id="cb422-30"><a href="#cb422-30" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(data<span class="sc">$</span>bill_depth,data<span class="sc">$</span>mass,<span class="at">col =</span> kout<span class="sc">$</span>cluster)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="semester-1" class="level3">
<h3 class="anchored" data-anchor-id="semester-1">23/24 Semester 1</h3>
<p><img src="images/clipboard-2508438044.png" class="img-fluid"></p>
<p><img src="images/clipboard-3398826487.png" class="img-fluid"></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/clipboard-2782196490.png" class="img-fluid figure-img"></p>
<figcaption><img src="images/clipboard-4102285046.png" class="img-fluid figure-img"></figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/clipboard-2272837594.png" class="img-fluid figure-img"></p>
<figcaption><img src="images/clipboard-2742103053.png" class="img-fluid figure-img"></figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/clipboard-787868926.png" class="img-fluid figure-img"></p>
<figcaption><img src="images/clipboard-815472199.png" class="img-fluid figure-img"></figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/clipboard-2544933882.png" class="img-fluid figure-img"></p>
<figcaption><img src="images/clipboard-2730625458.png" class="img-fluid figure-img"></figcaption>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/clipboard-3145109450.png" class="img-fluid figure-img"></p>
<figcaption><img src="images/clipboard-3300006473.png" class="img-fluid figure-img"></figcaption>
</figure>
</div>
<p><img src="images/clipboard-3194953828.png" class="img-fluid"></p>
<p><img src="images/clipboard-1072861743.png" class="img-fluid"></p>
<p><img src="images/clipboard-4049283898.png" class="img-fluid"></p>
<p><img src="images/clipboard-3337044383.png" class="img-fluid"></p>
<p><img src="images/clipboard-1677050925.png" class="img-fluid"></p>
</section>
<section id="canvas-practice-final" class="level3">
<h3 class="anchored" data-anchor-id="canvas-practice-final">Canvas Practice Final</h3>
<p><img src="images/clipboard-3085252033.png" class="img-fluid"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb423"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb423-1"><a href="#cb423-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ===== PART 0: DATA PREPARATION =====</span></span>
<span id="cb423-2"><a href="#cb423-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1101</span>)</span>
<span id="cb423-3"><a href="#cb423-3" aria-hidden="true" tabindex="-1"></a><span class="do">## ---- Q1) Import dataset and remove the first 3 columns ----</span></span>
<span id="cb423-4"><a href="#cb423-4" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">"data_finals.csv"</span>)</span>
<span id="cb423-5"><a href="#cb423-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> data[, <span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)]</span>
<span id="cb423-6"><a href="#cb423-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb423-7"><a href="#cb423-7" aria-hidden="true" tabindex="-1"></a><span class="do">## ---- Q2) Report the number of developed countries in the dataset ----</span></span>
<span id="cb423-8"><a href="#cb423-8" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(data<span class="sc">$</span>Status)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 Developed Developing 
        14         75 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb425"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb425-1"><a href="#cb425-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ans: There are 14 developed countries in the dataset.</span></span>
<span id="cb425-2"><a href="#cb425-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb425-3"><a href="#cb425-3" aria-hidden="true" tabindex="-1"></a><span class="do">## ---- Q3) Transform the variable "Status" into numeric binary ----</span></span>
<span id="cb425-4"><a href="#cb425-4" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>Status <span class="ot">=</span> <span class="fu">ifelse</span>(data<span class="sc">$</span>Status <span class="sc">==</span> <span class="st">"Developing"</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/clipboard-176048828.png" class="img-fluid"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb426"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb426-1"><a href="#cb426-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ===== PART 1: LINEAR REGRESSION MODEL =====</span></span>
<span id="cb426-2"><a href="#cb426-2" aria-hidden="true" tabindex="-1"></a><span class="do">## ---- Q4) Form a linear model for "Status" and report its R^2 ----</span></span>
<span id="cb426-3"><a href="#cb426-3" aria-hidden="true" tabindex="-1"></a>M1 <span class="ot">=</span> <span class="fu">lm</span>(Status <span class="sc">~</span>., data)</span>
<span id="cb426-4"><a href="#cb426-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(M1)<span class="sc">$</span>r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.299669</code></pre>
</div>
<div class="sourceCode cell-code" id="cb428"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb428-1"><a href="#cb428-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ans: The R^2 value of M1 is 0.300.</span></span>
<span id="cb428-2"><a href="#cb428-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb428-3"><a href="#cb428-3" aria-hidden="true" tabindex="-1"></a><span class="do">## ---- Q5) Number of fitted values of M1 are less than 0 ----</span></span>
<span id="cb428-4"><a href="#cb428-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(M1<span class="sc">$</span>fitted.values <span class="sc">&lt;</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 24</code></pre>
</div>
<div class="sourceCode cell-code" id="cb430"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb430-1"><a href="#cb430-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ans: There are 24 fitted values that are less than 0.</span></span>
<span id="cb430-2"><a href="#cb430-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb430-3"><a href="#cb430-3" aria-hidden="true" tabindex="-1"></a><span class="do">## ---- Q6) Limitations of fitting a linear model to "Status" ----</span></span>
<span id="cb430-4"><a href="#cb430-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Ans: 1) Status is a categorical variable, which is inappropriate for linear models that assume a quantitative response.</span></span>
<span id="cb430-5"><a href="#cb430-5" aria-hidden="true" tabindex="-1"></a><span class="co">#      2) Linear model predictions can extend beyond the range [0, 1], limiting their interpretation as probabilities.</span></span>
<span id="cb430-6"><a href="#cb430-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb430-7"><a href="#cb430-7" aria-hidden="true" tabindex="-1"></a><span class="do">## ---- Q7) Derive the area under the ROC Curve for M1 ----</span></span>
<span id="cb430-8"><a href="#cb430-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ROCR)</span>
<span id="cb430-9"><a href="#cb430-9" aria-hidden="true" tabindex="-1"></a>M1.prob <span class="ot">=</span> M1<span class="sc">$</span>fitted.values</span>
<span id="cb430-10"><a href="#cb430-10" aria-hidden="true" tabindex="-1"></a>M1.rocr <span class="ot">=</span> <span class="fu">prediction</span>(M1.prob, data<span class="sc">$</span>Status)</span>
<span id="cb430-11"><a href="#cb430-11" aria-hidden="true" tabindex="-1"></a>M1.auc <span class="ot">=</span> <span class="fu">performance</span>(M1.rocr, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]; M1.auc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8895238</code></pre>
</div>
<div class="sourceCode cell-code" id="cb432"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb432-1"><a href="#cb432-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ans: The ROC-AUC value for M1 is 0.890.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/clipboard-4238747404.png" class="img-fluid"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb433"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb433-1"><a href="#cb433-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ===== PART 2: LOGISTIC REGRESSION MODEL ====</span></span>
<span id="cb433-2"><a href="#cb433-2" aria-hidden="true" tabindex="-1"></a><span class="do">## ---- Q8) Form a logistic regression model for "Status" with its equation ----</span></span>
<span id="cb433-3"><a href="#cb433-3" aria-hidden="true" tabindex="-1"></a>M2 <span class="ot">=</span> <span class="fu">glm</span>(Status <span class="sc">~</span>., data, <span class="at">family =</span> <span class="fu">binomial</span>(<span class="at">link =</span><span class="st">"logit"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</code></pre>
</div>
<div class="sourceCode cell-code" id="cb435"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb435-1"><a href="#cb435-1" aria-hidden="true" tabindex="-1"></a>M2<span class="sc">$</span>coefficients</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    (Intercept) Life_expectancy Adult_mortality   infant_deaths         Alcohol 
  -1.952567e+01    2.275908e-01    8.548758e-04   -4.717146e-01    1.487468e-01 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb437"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb437-1"><a href="#cb437-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ans: log[p/(1-p)] = -19.526 + 0.228 * (Life_expectancy)</span></span>
<span id="cb437-2"><a href="#cb437-2" aria-hidden="true" tabindex="-1"></a><span class="co">#                             + 0.000855 * (Adult_mortality)</span></span>
<span id="cb437-3"><a href="#cb437-3" aria-hidden="true" tabindex="-1"></a><span class="co">#                             - 0.472 * (infant_deaths)</span></span>
<span id="cb437-4"><a href="#cb437-4" aria-hidden="true" tabindex="-1"></a><span class="co">#                             + 0.149 * (Alcohol)</span></span>
<span id="cb437-5"><a href="#cb437-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Notation: p is the predicted probability that a country is developed.</span></span>
<span id="cb437-6"><a href="#cb437-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb437-7"><a href="#cb437-7" aria-hidden="true" tabindex="-1"></a><span class="do">## ---- Q9) Report and interpret the coefficient of "Alcohol" in M2 ----</span></span>
<span id="cb437-8"><a href="#cb437-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Ans: The coefficient for Alcohol is 0.149.</span></span>
<span id="cb437-9"><a href="#cb437-9" aria-hidden="true" tabindex="-1"></a><span class="co">#      Each 1L increase in alcohol consumption multiplies the odds of being a developed country by 1.160, </span></span>
<span id="cb437-10"><a href="#cb437-10" aria-hidden="true" tabindex="-1"></a><span class="co">#      assuming other factors are held constant.</span></span>
<span id="cb437-11"><a href="#cb437-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb437-12"><a href="#cb437-12" aria-hidden="true" tabindex="-1"></a><span class="do">## ---- Q10) Predict the probability that a country is developed ----</span></span>
<span id="cb437-13"><a href="#cb437-13" aria-hidden="true" tabindex="-1"></a>new_country <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Life_expectancy =</span> <span class="dv">83</span>,</span>
<span id="cb437-14"><a href="#cb437-14" aria-hidden="true" tabindex="-1"></a>                         <span class="at">Adult_mortality =</span> <span class="dv">57</span>,</span>
<span id="cb437-15"><a href="#cb437-15" aria-hidden="true" tabindex="-1"></a>                         <span class="at">infant_deaths =</span> <span class="dv">2</span>,</span>
<span id="cb437-16"><a href="#cb437-16" aria-hidden="true" tabindex="-1"></a>                         <span class="at">Alcohol =</span> <span class="dv">3</span>)</span>
<span id="cb437-17"><a href="#cb437-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb437-18"><a href="#cb437-18" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(M2, new_country, <span class="at">type =</span> <span class="st">"response"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        1 
0.2527327 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb439"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb439-1"><a href="#cb439-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ans: The probability that this country is developed is 0.253.</span></span>
<span id="cb439-2"><a href="#cb439-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb439-3"><a href="#cb439-3" aria-hidden="true" tabindex="-1"></a><span class="do">## ---- Q11) Derive the area under the ROC Curve for M2 ----</span></span>
<span id="cb439-4"><a href="#cb439-4" aria-hidden="true" tabindex="-1"></a>M2.prob <span class="ot">=</span> <span class="fu">predict</span>(M2, data, <span class="at">type =</span> <span class="st">"response"</span>)</span>
<span id="cb439-5"><a href="#cb439-5" aria-hidden="true" tabindex="-1"></a>M2.rocr <span class="ot">=</span> <span class="fu">prediction</span>(M2.prob, data<span class="sc">$</span>Status)</span>
<span id="cb439-6"><a href="#cb439-6" aria-hidden="true" tabindex="-1"></a>M2.auc <span class="ot">=</span> <span class="fu">performance</span>(M2.rocr, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]; M2.auc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9342857</code></pre>
</div>
<div class="sourceCode cell-code" id="cb441"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb441-1"><a href="#cb441-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ans: The ROC-AUC value for M2 is 0.934.</span></span>
<span id="cb441-2"><a href="#cb441-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb441-3"><a href="#cb441-3" aria-hidden="true" tabindex="-1"></a><span class="do">## ---- Q12) Plot TPR and FPR against Threshold for M2 ----</span></span>
<span id="cb441-4"><a href="#cb441-4" aria-hidden="true" tabindex="-1"></a>M2.perf <span class="ot">=</span> <span class="fu">performance</span>(M2.rocr, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb441-5"><a href="#cb441-5" aria-hidden="true" tabindex="-1"></a>M2.tpr <span class="ot">=</span> M2.perf<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb441-6"><a href="#cb441-6" aria-hidden="true" tabindex="-1"></a>M2.fpr <span class="ot">=</span> M2.perf<span class="sc">@</span>x.values[[<span class="dv">1</span>]]</span>
<span id="cb441-7"><a href="#cb441-7" aria-hidden="true" tabindex="-1"></a>M2.threshold <span class="ot">=</span> M2.perf<span class="sc">@</span>alpha.values[[<span class="dv">1</span>]]</span>
<span id="cb441-8"><a href="#cb441-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(M2.threshold, M2.tpr, </span>
<span id="cb441-9"><a href="#cb441-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), </span>
<span id="cb441-10"><a href="#cb441-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"blue"</span>, </span>
<span id="cb441-11"><a href="#cb441-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"TPR &amp; FPR vs Threshold for M2"</span>, </span>
<span id="cb441-12"><a href="#cb441-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"Threshold"</span>, <span class="at">ylab =</span> <span class="st">"Rate"</span>)</span>
<span id="cb441-13"><a href="#cb441-13" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(M2.threshold, M2.fpr, <span class="at">type =</span> <span class="st">"l"</span>, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb441-14"><a href="#cb441-14" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"TPR"</span>, <span class="st">"FPR"</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>), <span class="at">lty =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-132-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb442"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb442-1"><a href="#cb442-1" aria-hidden="true" tabindex="-1"></a><span class="do">## ---- Q13) Evaluate the choice of δ = 0.5 ----</span></span>
<span id="cb442-2"><a href="#cb442-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Ans: A 0.5 threshold yields a very low FPR (&lt;5%) but a sub-optimal TPR (≈65%).</span></span>
<span id="cb442-3"><a href="#cb442-3" aria-hidden="true" tabindex="-1"></a><span class="co">#      There exist lower thresholds that improve TPR significantly with minimal increase in FPR.</span></span>
<span id="cb442-4"><a href="#cb442-4" aria-hidden="true" tabindex="-1"></a><span class="co">#      Therefore, a 0.5 threshold is not ideal for balancing TPR and FPR.</span></span>
<span id="cb442-5"><a href="#cb442-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb442-6"><a href="#cb442-6" aria-hidden="true" tabindex="-1"></a><span class="do">## ---- Q14) Report the values of TPR &amp; FPR when δ ∈ (0.19, 0.2) and comment ----</span></span>
<span id="cb442-7"><a href="#cb442-7" aria-hidden="true" tabindex="-1"></a>M2.metrics <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Threshold =</span> M2.threshold, <span class="at">TPR =</span> M2.tpr, <span class="at">FPR =</span> M2.fpr)</span>
<span id="cb442-8"><a href="#cb442-8" aria-hidden="true" tabindex="-1"></a>M2.metrics[M2.metrics<span class="sc">$</span>Threshold <span class="sc">&gt;</span> <span class="fl">0.19</span> <span class="sc">&amp;</span> M2.metrics<span class="sc">$</span>Threshold <span class="sc">&lt;</span> <span class="fl">0.20</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Threshold       TPR       FPR
28 0.1954391 0.9285714 0.1866667
29 0.1941844 0.9285714 0.2000000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb444"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb444-1"><a href="#cb444-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ans: When δ ∈ (0.19, 0.2), the TPR is 92.9% and the FPR ranges from 18.7% to 20.0%.</span></span>
<span id="cb444-2"><a href="#cb444-2" aria-hidden="true" tabindex="-1"></a><span class="co">#      The classifier can correctly identify significantly more developed countries.</span></span>
<span id="cb444-3"><a href="#cb444-3" aria-hidden="true" tabindex="-1"></a><span class="co">#      However, this comes with a slight increase in mislabeled developing countries.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/clipboard-1827076362.png" class="img-fluid"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb445"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb445-1"><a href="#cb445-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ===== PART 3: NAIVE BAYES CLASSIFIER =====</span></span>
<span id="cb445-2"><a href="#cb445-2" aria-hidden="true" tabindex="-1"></a><span class="do">## ---- Q15) Form a Naive Bayes Classifier for "Status" ----</span></span>
<span id="cb445-3"><a href="#cb445-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(e1071)</span>
<span id="cb445-4"><a href="#cb445-4" aria-hidden="true" tabindex="-1"></a>M3 <span class="ot">=</span> <span class="fu">naiveBayes</span>(Status <span class="sc">~</span>., data)</span>
<span id="cb445-5"><a href="#cb445-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb445-6"><a href="#cb445-6" aria-hidden="true" tabindex="-1"></a><span class="do">## ---- Q16) Calculate the accuracy of M3 ----</span></span>
<span id="cb445-7"><a href="#cb445-7" aria-hidden="true" tabindex="-1"></a>M3.pred <span class="ot">=</span> <span class="fu">predict</span>(M3, data, <span class="at">type =</span> <span class="st">"class"</span>)</span>
<span id="cb445-8"><a href="#cb445-8" aria-hidden="true" tabindex="-1"></a>M3.matrix <span class="ot">=</span> <span class="fu">table</span>(data<span class="sc">$</span>Status, M3.pred)</span>
<span id="cb445-9"><a href="#cb445-9" aria-hidden="true" tabindex="-1"></a>M3.acc <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">diag</span>(M3.matrix))<span class="sc">/</span><span class="fu">sum</span>(M3.matrix); M3.acc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.741573</code></pre>
</div>
<div class="sourceCode cell-code" id="cb447"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb447-1"><a href="#cb447-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ans: The accuracy of M3 is 0.742.</span></span>
<span id="cb447-2"><a href="#cb447-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb447-3"><a href="#cb447-3" aria-hidden="true" tabindex="-1"></a><span class="do">## ---- Q17) Predict the probability that a country is developed ----</span></span>
<span id="cb447-4"><a href="#cb447-4" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(M3, new_country, <span class="at">type =</span> <span class="st">"raw"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              0         1
[1,] 0.01540518 0.9845948</code></pre>
</div>
<div class="sourceCode cell-code" id="cb449"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb449-1"><a href="#cb449-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ans: The probability that this country is developed is 0.985.</span></span>
<span id="cb449-2"><a href="#cb449-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb449-3"><a href="#cb449-3" aria-hidden="true" tabindex="-1"></a><span class="do">## ---- Q18) Derive the area under the ROC Curve for M3 ----</span></span>
<span id="cb449-4"><a href="#cb449-4" aria-hidden="true" tabindex="-1"></a>M3.prob <span class="ot">=</span> <span class="fu">predict</span>(M3, data, <span class="at">type =</span> <span class="st">"raw"</span>)[, <span class="dv">2</span>]</span>
<span id="cb449-5"><a href="#cb449-5" aria-hidden="true" tabindex="-1"></a>M3.rocr <span class="ot">=</span> <span class="fu">prediction</span>(M3.prob, data<span class="sc">$</span>Status)</span>
<span id="cb449-6"><a href="#cb449-6" aria-hidden="true" tabindex="-1"></a>M3.auc <span class="ot">=</span> <span class="fu">performance</span>(M3.rocr, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]; M3.auc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9361905</code></pre>
</div>
<div class="sourceCode cell-code" id="cb451"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb451-1"><a href="#cb451-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ans: The ROC-AUC value for M3 is 0.936.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/clipboard-3229832677.png" class="img-fluid"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb452"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb452-1"><a href="#cb452-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ===== PART 4: K-NEAREST NEIGHBOURS ====</span></span>
<span id="cb452-2"><a href="#cb452-2" aria-hidden="true" tabindex="-1"></a><span class="do">## ---- Q19) Form the best KNN classifier based on accuracy ----</span></span>
<span id="cb452-3"><a href="#cb452-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(class)</span>
<span id="cb452-4"><a href="#cb452-4" aria-hidden="true" tabindex="-1"></a>data.scale <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">Status =</span> data<span class="sc">$</span>Status, <span class="fu">scale</span>(data[, <span class="sc">-</span><span class="dv">1</span>]))</span>
<span id="cb452-5"><a href="#cb452-5" aria-hidden="true" tabindex="-1"></a>k_values <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb452-6"><a href="#cb452-6" aria-hidden="true" tabindex="-1"></a>acc_values <span class="ot">=</span> <span class="fu">numeric</span>(<span class="fu">length</span>(k_values))</span>
<span id="cb452-7"><a href="#cb452-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb452-8"><a href="#cb452-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(k_values)){</span>
<span id="cb452-9"><a href="#cb452-9" aria-hidden="true" tabindex="-1"></a>  pred <span class="ot">=</span> <span class="fu">knn</span>(data.scale[, <span class="sc">-</span><span class="dv">1</span>], data.scale[, <span class="sc">-</span><span class="dv">1</span>], data.scale<span class="sc">$</span>Status, <span class="at">k =</span> k_values[i])</span>
<span id="cb452-10"><a href="#cb452-10" aria-hidden="true" tabindex="-1"></a>  matrix <span class="ot">=</span> <span class="fu">table</span>(data.scale<span class="sc">$</span>Status, pred)</span>
<span id="cb452-11"><a href="#cb452-11" aria-hidden="true" tabindex="-1"></a>  acc <span class="ot">=</span> <span class="fu">sum</span>(<span class="fu">diag</span>(matrix))<span class="sc">/</span><span class="fu">sum</span>(matrix)</span>
<span id="cb452-12"><a href="#cb452-12" aria-hidden="true" tabindex="-1"></a>  acc_values[i] <span class="ot">=</span> acc</span>
<span id="cb452-13"><a href="#cb452-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb452-14"><a href="#cb452-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb452-15"><a href="#cb452-15" aria-hidden="true" tabindex="-1"></a>knn.metrics <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">K =</span> k_values, <span class="at">Accuracy =</span> acc_values)</span>
<span id="cb452-16"><a href="#cb452-16" aria-hidden="true" tabindex="-1"></a>knn.metrics[<span class="fu">order</span>(knn.metrics<span class="sc">$</span>Accuracy, <span class="at">decreasing =</span> <span class="cn">TRUE</span>), ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   K  Accuracy
2  3 0.9550562
1  2 0.9325843
4  5 0.9325843
6  7 0.9325843
3  4 0.9101124
8  9 0.8988764
9 10 0.8988764
5  6 0.8876404
7  8 0.8876404</code></pre>
</div>
<div class="sourceCode cell-code" id="cb454"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb454-1"><a href="#cb454-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ans: K = 3 gives the best accuracy of 0.955.</span></span>
<span id="cb454-2"><a href="#cb454-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb454-3"><a href="#cb454-3" aria-hidden="true" tabindex="-1"></a><span class="do">## ---- Q20) Derive the area under the ROC Curve for M4 ----</span></span>
<span id="cb454-4"><a href="#cb454-4" aria-hidden="true" tabindex="-1"></a>M4.pred <span class="ot">=</span> <span class="fu">knn</span>(data.scale[, <span class="sc">-</span><span class="dv">1</span>], data.scale[, <span class="sc">-</span><span class="dv">1</span>], data.scale<span class="sc">$</span>Status, <span class="at">k =</span> <span class="dv">3</span>, <span class="at">prob =</span> <span class="cn">TRUE</span>)</span>
<span id="cb454-5"><a href="#cb454-5" aria-hidden="true" tabindex="-1"></a>M4.prob_major <span class="ot">=</span> <span class="fu">attr</span>(M4.pred, <span class="st">"prob"</span>) </span>
<span id="cb454-6"><a href="#cb454-6" aria-hidden="true" tabindex="-1"></a>M4.prob <span class="ot">=</span> <span class="fu">ifelse</span>(M4.pred <span class="sc">==</span> <span class="st">"1"</span>, M4.prob_major, <span class="dv">1</span> <span class="sc">-</span> M4.prob_major)</span>
<span id="cb454-7"><a href="#cb454-7" aria-hidden="true" tabindex="-1"></a>M4.rocr <span class="ot">=</span> <span class="fu">prediction</span>(M4.prob, data.scale<span class="sc">$</span>Status)</span>
<span id="cb454-8"><a href="#cb454-8" aria-hidden="true" tabindex="-1"></a>M4.auc <span class="ot">=</span> <span class="fu">performance</span>(M4.rocr, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]; M4.auc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9814286</code></pre>
</div>
<div class="sourceCode cell-code" id="cb456"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb456-1"><a href="#cb456-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ans: The ROC-AUC value for M4 is 0.981.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><img src="images/clipboard-1946524145.png" class="img-fluid"></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb457"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb457-1"><a href="#cb457-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ===== PART 5: DECISION TREES ====</span></span>
<span id="cb457-2"><a href="#cb457-2" aria-hidden="true" tabindex="-1"></a><span class="do">## ---- Q21) Form a Decision Tree for "Status" ----</span></span>
<span id="cb457-3"><a href="#cb457-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart)</span>
<span id="cb457-4"><a href="#cb457-4" aria-hidden="true" tabindex="-1"></a>M5 <span class="ot">=</span> <span class="fu">rpart</span>(Status <span class="sc">~</span> ., data, <span class="at">method =</span> <span class="st">"class"</span>,</span>
<span id="cb457-5"><a href="#cb457-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">control =</span> <span class="fu">rpart.control</span>(<span class="at">cp =</span> <span class="fl">0.01</span>), </span>
<span id="cb457-6"><a href="#cb457-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">parms =</span> <span class="fu">list</span>(<span class="at">split =</span> <span class="st">'gini'</span>))</span>
<span id="cb457-7"><a href="#cb457-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb457-8"><a href="#cb457-8" aria-hidden="true" tabindex="-1"></a><span class="do">## ---- Q22) Most important features for predicting "Status" ----</span></span>
<span id="cb457-9"><a href="#cb457-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart.plot)</span>
<span id="cb457-10"><a href="#cb457-10" aria-hidden="true" tabindex="-1"></a><span class="fu">rpart.plot</span>(M5, <span class="at">type =</span> <span class="dv">4</span>, <span class="at">extra =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-135-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb458"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb458-1"><a href="#cb458-1" aria-hidden="true" tabindex="-1"></a>M5<span class="sc">$</span>variable.importance</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Alcohol Life_expectancy 
      10.963804        4.955281 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb460"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb460-1"><a href="#cb460-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ans: Alcohol consumption is the most important feature, followed by life expectancy.</span></span>
<span id="cb460-2"><a href="#cb460-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb460-3"><a href="#cb460-3" aria-hidden="true" tabindex="-1"></a><span class="do">## ---- Q23) Plot the ROC of M3 and M5 in one figure with a legend ----</span></span>
<span id="cb460-4"><a href="#cb460-4" aria-hidden="true" tabindex="-1"></a>M3.perf <span class="ot">=</span> <span class="fu">performance</span>(M3.rocr, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb460-5"><a href="#cb460-5" aria-hidden="true" tabindex="-1"></a>M5.prob <span class="ot">=</span> <span class="fu">predict</span>(M5, data, <span class="at">type =</span> <span class="st">"prob"</span>)[, <span class="dv">2</span>]</span>
<span id="cb460-6"><a href="#cb460-6" aria-hidden="true" tabindex="-1"></a>M5.rocr <span class="ot">=</span> <span class="fu">prediction</span>(M5.prob, data<span class="sc">$</span>Status)</span>
<span id="cb460-7"><a href="#cb460-7" aria-hidden="true" tabindex="-1"></a>M5.perf <span class="ot">=</span> <span class="fu">performance</span>(M5.rocr, <span class="st">"tpr"</span>, <span class="st">"fpr"</span>)</span>
<span id="cb460-8"><a href="#cb460-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb460-9"><a href="#cb460-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(M3.perf, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">"ROC Curves"</span>),</span>
<span id="cb460-10"><a href="#cb460-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"False Positive Rate"</span>, <span class="at">ylab =</span> <span class="st">"True Positive Rate"</span>)</span>
<span id="cb460-11"><a href="#cb460-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(M5.perf, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb460-12"><a href="#cb460-12" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb460-13"><a href="#cb460-13" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottomright"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Naive Bayes (M3)"</span>, <span class="st">"Decision Tree (M5)"</span>),</span>
<span id="cb460-14"><a href="#cb460-14" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-135-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb461"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb461-1"><a href="#cb461-1" aria-hidden="true" tabindex="-1"></a><span class="do">## ---- Q24) Determining model with the highest AUC value ----</span></span>
<span id="cb461-2"><a href="#cb461-2" aria-hidden="true" tabindex="-1"></a>M5.auc <span class="ot">=</span> <span class="fu">performance</span>(M5.rocr, <span class="st">"auc"</span>)<span class="sc">@</span>y.values[[<span class="dv">1</span>]]</span>
<span id="cb461-3"><a href="#cb461-3" aria-hidden="true" tabindex="-1"></a><span class="fu">which.max</span>(<span class="fu">c</span>(M1.auc, M2.auc, M3.auc, M4.auc, M5.auc))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
<div class="sourceCode cell-code" id="cb463"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb463-1"><a href="#cb463-1" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(<span class="fu">c</span>(M1.auc, M2.auc, M3.auc, M4.auc, M5.auc))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9814286</code></pre>
</div>
<div class="sourceCode cell-code" id="cb465"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb465-1"><a href="#cb465-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ans: M4 (KNN) has the highest ROC-AUC of 0.981.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>